<!DOCTYPE html><html lang="fr"><head><title data-react-helmet="true">Dépendances et premier projet en Ruby | Putain de code</title><meta data-react-helmet="true" charset="UTF-8"/><meta data-react-helmet="true" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover" name="viewport"/><meta data-react-helmet="true" content="summary_large_image" name="twitter:card"/><meta data-react-helmet="true" content="Putain de code !" property="og:site_name"/><meta data-react-helmet="true" content="@putaindecode" name="twitter:site"/><meta data-react-helmet="true" content="https://putaindecode.io/public/images/website/share.jpg" property="og:image"/><meta data-react-helmet="true" content="https://putaindecode.io/public/images/website/share.jpg" name="twitter:image"/><meta data-react-helmet="true" content="1500" property="og:image:width"/><meta data-react-helmet="true" content="777" property="og:image:height"/><meta data-react-helmet="true" content="Dépendances et premier projet en Ruby | Putain de code" property="og:title"/><meta data-react-helmet="true" content="Dépendances et premier projet en Ruby | Putain de code" name="twitter:title"/><meta data-react-helmet="true" content="Un article proposé par rhannequin" name="description"/><link data-react-helmet="true" title="RSS Feed" href="/api/articles/feeds/desc/feed.xml" rel="alternate" type="application/rss+xml"/><link data-react-helmet="true" href="/favicon.ico" rel="shortcut icon"/><link data-react-helmet="true" href="https://putaindecode.io/articles/dependances-et-premier-projet-en-ruby" rel="canonical"/><script>window.PAGES_BOOT_MODE="hydrate";</script></head><div id="root"><style data-emotion="rpcss zx73cm 1lc6tyj 28v1b4">@-webkit-keyframes animation-zx73cm{from{opacity:0;-webkit-transform:translateY(20px);-moz-transform:translateY(20px);-ms-transform:translateY(20px);transform:translateY(20px);}}@keyframes animation-zx73cm{from{opacity:0;-webkit-transform:translateY(20px);-moz-transform:translateY(20px);-ms-transform:translateY(20px);transform:translateY(20px);}}:root{--page-background-color:#fff;--page-slightly-accented-background-color:#F9F6F6;--page-accented-background-color:#E4EBEE;--page-text-color:#46515B;--link-text-color:#E51D58;--gradient-red-top:#E51D58;--gradient-red-bottom:#CC0613;--code-background-color:#FAF3E1;--one-percent-contrast-color:rgba(0, 0, 0, 0.1);--half-percent-contrast-color:rgba(0, 0, 0, 0.05);}@media (prefers-color-scheme: dark){:root{--page-background-color:#222;--page-slightly-accented-background-color:#171717;--page-accented-background-color:#111;--page-text-color:#ddd;--link-text-color:#F87098;--gradient-red-top:#E51D58;--gradient-red-bottom:#CC0613;--code-background-color:#4F3804;--one-percent-contrast-color:rgba(255, 255, 255, 0.1);--half-percent-contrast-color:rgba(255, 255, 255, 0.05);}}body{padding:0;margin:0;background-color:var(--page-background-color);color:var(--page-text-color);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;overflow-x:hidden;}html{font-size:1em;line-height:1.4;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%;}a{color:var(--link-text-color);-webkit-text-decoration:underline;text-decoration:underline;}a:hover{-webkit-text-decoration:none;text-decoration:none;}#root{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}*,*:before,*:after{box-sizing:border-box;}pre,.hljs{color:#adbac7;background:#22272e;}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#f47067;}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#dcbdfb;}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-variable,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id{color:#6cb6ff;}.hljs-regexp,.hljs-string,.hljs-meta .hljs-string{color:#96d0ff;}.hljs-built_in,.hljs-symbol{color:#f69d50;}.hljs-comment,.hljs-code,.hljs-formula{color:#768390;}.hljs-name,.hljs-quote,.hljs-selector-tag,.hljs-selector-pseudo{color:#8ddb8c;}.hljs-subst{color:#adbac7;}.hljs-section{color:#316dca;font-weight:bold;}.hljs-bullet{color:#eac55f;}.hljs-emphasis{color:#adbac7;font-style:italic;}.hljs-strong{color:#adbac7;font-weight:bold;}.hljs-addition{color:#b4f1b4;background-color:#1b4721;}.hljs-deletion{color:#ffd8d3;background-color:#78191b;}</style><style data-emotion="rpcss 9vhaby">.rpcss-9vhaby{background-color:var(--gradient-red-bottom);background-image:linear-gradient(to bottom right, var(--gradient-red-top), var(--gradient-red-bottom));}</style><header class="rpcss-9vhaby" style="background-image:linear-gradient(to bottom right, hsl(65, 100%, 35%), hsl(54, 100%, 30%))"><style data-emotion="rpcss 1qqk0tr">.rpcss-1qqk0tr{padding-left:env(safe-area-inset-left);padding-right:env(safe-area-inset-right);}</style><div class="rpcss-1qqk0tr"><style data-emotion="rpcss qx7dny">.rpcss-qx7dny{width:100%;max-width:1024px;margin:0 auto;padding:0 10px;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;}</style><div class="rpcss-qx7dny"><style data-emotion="rpcss 7s9om2">.rpcss-7s9om2{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding:20px 0 50px;}</style><div class="rpcss-7s9om2"><style data-emotion="rpcss gdpa5c">.rpcss-gdpa5c{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-text-decoration:none;text-decoration:none;}</style><a class="rpcss-gdpa5c" href="/"><style data-emotion="rpcss 1lm4738">.rpcss-1lm4738{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-text-decoration:none;text-decoration:none;padding-bottom:10px;}</style><div class="rpcss-1lm4738"><style data-emotion="rpcss 13o7eu2">.rpcss-13o7eu2{display:block;}</style><svg class="rpcss-13o7eu2" height="36px" width="36px" viewBox="0 0 36 36"><defs><linearGradient id="PutainDeCodeLogoGradient" x1="50%" x2="50%" y1="0%" y2="127.223881%"><stop offset="0%" stop-color="#E41D57"></stop><stop offset="100%" stop-color="#C60000"></stop></linearGradient></defs><circle cx="18" cy="18" fill="url(#PutainDeCodeLogoGradient)" r="17" stroke="#FFFFFF" stroke-width="2"></circle><polygon fill="#FFFFFF" points="15.9033203 18.2246094 15.9033203 18.3710938 11.2304688 20.5317383 11.2304688 22.8095703 18.0566406 19.184082 18.0566406 17.4116211 11.2304688 13.7788086 11.2304688 16.0639648"></polygon><rect height="14" width="2" fill="#FFFFFF" x="22" y="11"><animate attributeName="opacity" begin="100ms" calcMode="discrete" dur="2s" repeatCount="indefinite" values="1;0"></animate></rect></svg><style data-emotion="rpcss 4cf197">.rpcss-4cf197{width:10px;height:10px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}</style><div class="rpcss-4cf197"></div><style data-emotion="rpcss u5k24">.rpcss-u5k24{font-size:22px;color:#fff;font-weight:800;}</style><div aria-level="2" class="rpcss-u5k24" role="heading">Putain de code !</div></div><style data-emotion="rpcss 1nyebg4">.rpcss-1nyebg4{font-size:14px;color:rgba(255, 255, 255, 0.8);text-align:center;}</style><div class="rpcss-1nyebg4">Blog participatif de la communauté dev</div></a></div></div></div></header><style data-emotion="rpcss a4ric9">.rpcss-a4ric9{background-color:var(--page-slightly-accented-background-color);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}</style><div class="rpcss-a4ric9"><style data-emotion="rpcss oeugsb">.rpcss-oeugsb{-webkit-animation:500ms ease-out animation-zx73cm;animation:500ms ease-out animation-zx73cm;}</style><div class="rpcss-oeugsb"><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 1qc2bam">.rpcss-1qc2bam{font-size:42px;font-weight:800;text-align:center;padding-top:40px;line-height:1.2;margin:0;}</style><h1 class="rpcss-1qc2bam">Dépendances et premier projet en Ruby</h1><style data-emotion="rpcss obg2kr">.rpcss-obg2kr{font-size:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding-top:10px;padding-bottom:40px;color:var(--page-text-color);-webkit-text-decoration:none;text-decoration:none;}</style><a class="rpcss-obg2kr" href="https://github.com/rhannequin"><style data-emotion="rpcss uco8i7">.rpcss-uco8i7{width:32px;height:32px;border-radius:100%;margin-right:10px;}</style><img class="rpcss-uco8i7" alt="rhannequin" src="https://avatars.githubusercontent.com/rhannequin?size=64"/><div>rhannequin<!-- --> <!-- -->•<!-- --> <!-- -->2014/10/14</div></a><style data-emotion="rpcss 15kxmi0">.rpcss-15kxmi0{max-width:640px;width:100%;font-size:18px;margin:0 auto;line-height:1.7;}.rpcss-15kxmi0 h2,.rpcss-15kxmi0 h3,.rpcss-15kxmi0 h4,.rpcss-15kxmi0 h5,.rpcss-15kxmi0 h6{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;font-weight:800;line-height:1.2;}.rpcss-15kxmi0 img{max-width:100%;background-color:rgba(255, 255, 255, 0.75);}.rpcss-15kxmi0 code{font-size:0.9em;font-family:PragmataPro,SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;line-height:1;background-color:var(--code-background-color);margin:0 0.2em;}.rpcss-15kxmi0 pre{padding:10px;overflow-x:auto;font-size:14px;border-radius:10px;border:2px solid var(--one-percent-contrast-color);-webkit-overflow-scrolling:touch;}.rpcss-15kxmi0 pre code{font-size:14px;background-color:transparent;margin:0;}.rpcss-15kxmi0 blockquote{padding-left:20px;margin:0;font-size:16px;border-left:3px solid var(--one-percent-contrast-color);font-style:italic;}.rpcss-15kxmi0 table{width:100%;text-align:center;}.rpcss-15kxmi0 figure{padding:20px 0;}.rpcss-15kxmi0 figcaption{text-align:center;}.rpcss-15kxmi0 a{word-wrap:break-word;}.rpcss-15kxmi0 table thead th{background-color:var(--page-accented-background-color);padding:10px 0;}</style><div class="rpcss-15kxmi0"><p><a href="#tl-dr">tl;dr</a></p>
<p>Dans l'<a href="/fr/articles/ruby/premiers-pas/">article précédent</a> nous avons installé
Ruby. Désormais nous allons aborder les gems, les dépendances et commencer notre
web service.</p>
<p>Un gem en Ruby c'est une lib, comme un paquet NPM pour NodeJS. C'est d'ailleurs
le système de rubygems qui a inspiré le système de NPM. Pour installer un gem,
rien de plus simple que <code>gem install sass</code>, qui ici va installer la bibliothèque
<code>sass</code>.</p>
<p>Un projet Ruby nécessite la plupart du temps des bibliothèques afin de ne pas
tout faire soi-même, il est donc nécessaire d'avoir une gestion des dépendances
pour le projet.</p>
<h2>Bundler, le gem qui gère les gems</h2>
<p><a href="http://bundler.io">Bundler</a> est un gem qui va vous permettre de créer un
fichier Gemfile contenant vos dépendances, et qui vous installera les gems
nécessaires avec la gestion des versions et de leurs propres dépendances. Un
fichier Gemfile se présente comme ceci :</p>
<pre><code class="hljs language-ruby">source <span class="hljs-string">&#x27;https://rubygems.org&#x27;</span>
ruby <span class="hljs-string">&#x27;2.1.2&#x27;</span>
gem <span class="hljs-string">&#x27;sinatra&#x27;</span>
</code></pre>
<p>L'instruction <code>source</code> permet de préciser l'url des dépôts de gems. La version
de ruby n'est pas obligatoire mais j'aime la préciser pour ne pas me mélanger
dans mes projets avec différentes versions de Ruby (voir le
<a href="/fr/articles/ruby/premiers-pas/">précédent article pour les versions du Ruby</a>
et <a href="https://github.com/sstephenson/rbenv">rbenv</a>). Et enfin, la déclaration de
notre première bibliothèque de dépendance : <a href="http://www.sinatrarb.com">Sinatra</a>.</p>
<p>Il est possible d'être bien plus précis dans le Gemfile, comme...</p>
<p>Préciser dans quel environnement charger les gems :</p>
<pre><code class="hljs language-ruby">gem <span class="hljs-string">&#x27;sqlite3&#x27;</span>, <span class="hljs-symbol">group:</span> [<span class="hljs-symbol">:development</span>, <span class="hljs-symbol">:test</span>]
</code></pre>
<p>Une numéro de version :</p>
<pre><code class="hljs language-ruby">gem <span class="hljs-string">&#x27;rails&#x27;</span>, <span class="hljs-string">&#x27;4.1.6&#x27;</span>         <span class="hljs-comment"># version 4.1.6</span>
gem <span class="hljs-string">&#x27;sass-rails&#x27;</span>, <span class="hljs-string">&#x27;~&gt; 4.0.3&#x27;</span> <span class="hljs-comment"># &gt;= 4.0.3 mais &lt; 4.1.0</span>
</code></pre>
<p>Préciser la classe à charger :</p>
<pre><code class="hljs language-ruby">gem <span class="hljs-string">&#x27;valid_email&#x27;</span>, <span class="hljs-symbol">require:</span> <span class="hljs-string">&#x27;valid_email/email_validator&#x27;</span>
</code></pre>
<p>Aller chercher directement sur Github :</p>
<pre><code class="hljs language-ruby">gem <span class="hljs-string">&#x27;nokogiri&#x27;</span>, <span class="hljs-symbol">github:</span> <span class="hljs-string">&#x27;sparklemotion/nokogiri&#x27;</span>
<span class="hljs-comment"># https://github.com/sparklemotion/nokogiri.git</span>

gem <span class="hljs-string">&#x27;rails&#x27;</span>, <span class="hljs-symbol">github:</span> <span class="hljs-string">&#x27;rails&#x27;</span>
<span class="hljs-comment"># https://github.com/rails/rails.git</span>

gem <span class="hljs-string">&#x27;rails&#x27;</span>, <span class="hljs-symbol">github:</span> <span class="hljs-string">&#x27;rails&#x27;</span>, <span class="hljs-symbol">branch:</span> <span class="hljs-string">&#x27;4-1-stable&#x27;</span>
<span class="hljs-comment"># https://github.com/rails/rails.git sur la branche 4-1-stable</span>
</code></pre>
<p>Il existe encore d'autres instructions, de quoi rendre sa gestion des
dépendances vraiment fine et précise.</p>
<p>Une fois le Gemfile prêt, bundler a plusieurs commandes de disponibles pour
pouvoir les télécharger et utiliser.</p>
<ul>
<li><code>$ bundle install</code> installera les gems requis</li>
<li><code>$ bundle update</code> mettra à jour vers les versions les plus récentes si
possible les gems requis</li>
<li><code>$ bundle exec</code> permettra de précéder une commande ruby afin de l'exécuter
dans le contexte du Gemfile, très utile lorsque l'on a différentes versions de
Ruby qui se baladent dans le terminal</li>
</ul>
<p>Bundler va générer un fichier <code>Gemfile.lock</code> qui est la description exhaustive
des dépendances de votre application, chaque gem avec le numéro de sa version
installée, chaque dépendance pour chaque gem, une jolie arborescence plus que
précise.</p>
<h2>Commençons notre web service</h2>
<p>Assez parlé des outils qui existent, utilisons-les. Tout d'abord installons
Bundler, sans oublier le <code>$ rbenv rehash</code> nécessaire si vous utilisez rbenv pour
vos versions de Ruby afin de mettre à jour les commandes disponibles dans le
terminal :</p>
<pre><code>$ gem install bundler
$ rbenv rehash
</code></pre>
<p>Pour notre première application, nous allons faire un web service avec Sinatra
qui est un micro-framework web, ayant d'ailleurs clairement inspiré Express
(&quot;Sinatra inspired web development framework for node.js&quot;). Notre Gemfile va
donc être exactement comme notre premier exemple :</p>
<pre><code class="hljs language-ruby">source <span class="hljs-string">&#x27;https://rubygems.org&#x27;</span>
ruby <span class="hljs-string">&#x27;2.1.2&#x27;</span>
gem <span class="hljs-string">&#x27;sinatra&#x27;</span>
</code></pre>
<p>Un petit <code>bundle install</code> et nous sommes prêts à démarrer !</p>
<p>Pour ne pas brusquer les choses, nous allons faire la version la plus simple
d'un web service avec Sinatra, ce qui nous permettra de constater la simplicité
extrême de Ruby et du framework :</p>
<pre><code class="hljs language-ruby"><span class="hljs-comment">########</span>
<span class="hljs-comment"># app.rb</span>
<span class="hljs-comment">#</span>

<span class="hljs-keyword">require</span> <span class="hljs-string">&#x27;sinatra&#x27;</span>

get <span class="hljs-string">&#x27;/&#x27;</span> <span class="hljs-keyword">do</span>
  <span class="hljs-string">&#x27;Hello World!&#x27;</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>Qu'avons-nous fait là ? Pas grand chose, et en même temps tout juste ce qu'il
faut. Nous avons inclus le gem à notre script et utilisé la méthode Sinatra
<code>get</code> nous permettant de déclarer un point d'entrée en <code>GET</code> sur la route '/'.
Cette méthode prend également comme argument un <code>block</code> caractérisé par le <code>do</code>
et le <code>end</code>. La dernière valeur du block étant la valeur de retour, nous
renvoyons la seule chaîne de caractères &quot;Hello World!&quot;.</p>
<p>Et maintenant : lancement ! <code>$ bundle exec ruby app.rb</code> va lancer l'application
(mais <code>ruby app.rb</code> suffit), par défaut sur le port <code>4567</code>. Regardez vite
<a href="http://localhost:4567">http://localhost:4567</a> et là magie, &quot;Hello World!&quot; sur
une magnifique page blanche, notre tout premier web service est fonctionnel.</p>
<p>Alors oui, ce n'est pas une révolution. Mais tout de même, en réduisant la
syntaxe du block on se retrouve avec un script de deux lignes qui crée un vrai
web service web. Et vous allez vite voir qu'en quelques lignes de plus on peut
vite complexifier le bousin.</p>
<h2>Au prochain épisode</h2>
<p>Dans l'article suivant nous allons ajouter des fonctionnalités à notre toute
nouvelle application, de nouvelles routes, de la persistence et aussi des vues
dans un format un peu plus utile.</p>
<p>Stay tuned!</p>
<h2>tl;dr</h2>
<p>Voici la version abrégée de cet article :</p>
<pre><code class="hljs language-ruby"><span class="hljs-comment"># Gemfile</span>
source <span class="hljs-string">&#x27;https://rubygems.org&#x27;</span>
ruby <span class="hljs-string">&#x27;2.1.2&#x27;</span>
gem <span class="hljs-string">&#x27;sinatra&#x27;</span>
</code></pre>
<pre><code class="hljs language-ruby"><span class="hljs-comment"># app.rb</span>
<span class="hljs-keyword">require</span> <span class="hljs-string">&#x27;sinatra&#x27;</span>
get <span class="hljs-string">&#x27;/&#x27;</span> <span class="hljs-keyword">do</span>
  <span class="hljs-string">&#x27;Hello World!&#x27;</span>
<span class="hljs-keyword">end</span>
</code></pre>
<pre><code class="hljs language-console"><span class="hljs-meta">$</span><span class="bash"> gem install bundler</span>
<span class="hljs-meta">$</span><span class="bash"> rbenv <span class="hljs-built_in">rehash</span></span>
<span class="hljs-meta">$</span><span class="bash"> bundle install</span>
<span class="hljs-meta">$</span><span class="bash"> ruby app.rb</span>
</code></pre>
<h2>Sources</h2>
<ul>
<li><a href="https://rubygems.org">RubyGems</a></li>
<li><a href="http://bundler.io">Bundler</a></li>
<li><a href="https://github.com/sstephenson/rbenv">rbenv</a></li>
<li><a href="http://www.sinatrarb.com">Sinatra</a> et surtout son
<a href="http://www.sinatrarb.com/intro.html">README</a></li>
</ul>
</div><style data-emotion="rpcss unyj6i">.rpcss-unyj6i{max-width:640px;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin:20px auto;padding:20px;background-color:var(--page-background-color);border-radius:10px;box-shadow:0 15px 15px -5px rgba(0, 0, 0, 0.2);}@media (max-width: 540px){.rpcss-unyj6i{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><div class="rpcss-unyj6i"><style data-emotion="rpcss ty7r4z">.rpcss-ty7r4z{font-weight:800;}</style><div class="rpcss-ty7r4z">Vous avez aimé cet article?</div><style data-emotion="rpcss klacsp">.rpcss-klacsp{width:0;height:10px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}</style><div class="rpcss-klacsp"></div><style data-emotion="rpcss 1pkr03v">.rpcss-1pkr03v{background-color:#00aced;color:#fff;padding:10px 20px;-webkit-text-decoration:none;text-decoration:none;border-radius:5px;font-weight:800;}.rpcss-1pkr03v:active{opacity:0.5;}</style><a class="rpcss-1pkr03v" href="https://www.twitter.com/intent/tweet?text=D%C3%A9pendances%20et%20premier%20projet%20en%20Ruby%20sur%20%40PutainDeCode%20https%3A%2F%2Fputaindecode.io%2Farticles%2Fdependances-et-premier-projet-en-ruby" target="_blank">Le partager sur Twitter</a></div><style data-emotion="rpcss x4iqxe">.rpcss-x4iqxe{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;text-align:center;padding:20px;}</style><div class="rpcss-x4iqxe"><style data-emotion="rpcss gein6x">.rpcss-gein6x{font-size:20px;-webkit-text-decoration:none;text-decoration:none;color:#1E49B5;}</style><a class="rpcss-gein6x" href="/articles">← Articles</a></div><style data-emotion="rpcss 8bodgl">.rpcss-8bodgl{max-width:640px;width:100%;margin:0 auto;padding:20px 0;}</style><div class="rpcss-8bodgl" id="disqus_thread"></div></div></div></div></div><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 1vau6rl">.rpcss-1vau6rl{margin:20px 0;background-color:var(--page-accented-background-color);border-radius:10px;padding:20px;}</style><div class="rpcss-1vau6rl"><style data-emotion="rpcss 1gz1i1h">.rpcss-1gz1i1h{font-size:32px;font-weight:800;margin-bottom:20px;text-align:center;}</style><div aria-level="2" class="rpcss-1gz1i1h" role="heading">Ne rien rater</div><style data-emotion="rpcss 1wbispj">.rpcss-1wbispj{font-size:18px;margin-bottom:10px;text-align:center;}</style><div aria-level="3" class="rpcss-1wbispj" role="heading">Sur les réseaux</div><style data-emotion="rpcss 1hyoz7m">.rpcss-1hyoz7m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;}</style><div class="rpcss-1hyoz7m"><a href="https://twitter.com/PutainDeCode"><img alt="Twitter" height="48" src="/public/images/website/twitter.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://facebook.com/putaindecode"><img alt="Facebook" height="48" src="/public/images/website/facebook.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://github.com/putaindecode"><img alt="Facebook" height="48" src="/public/images/website/github.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://itunes.apple.com/fr/podcast/putain-de-code-!/id1185311825"><img alt="Apple Podcast" height="48" src="/public/images/website/apple-podcast.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://soundcloud.com/putaindecode"><img alt="Soundcloud" height="48" src="/public/images/website/soundcloud.svg" width="48"/></a></div><div aria-level="3" class="rpcss-1wbispj" role="heading">Sur le chat</div><div class="rpcss-1hyoz7m"><a href="https://discord.gg/jtbGNNc"><img alt="Discord" height="48" src="/public/images/website/discord.svg" width="48"/></a></div></div></div></div><style data-emotion="rpcss zs8kw7">.rpcss-zs8kw7{background-color:#222;padding:20px 0;}</style><footer class="rpcss-zs8kw7"><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 79elbk">.rpcss-79elbk{position:relative;}</style><div class="rpcss-79elbk"><style data-emotion="rpcss 1hle0ni">.rpcss-1hle0ni{position:absolute;left:0;top:50%;color:#fff;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="rpcss-1hle0ni" href="/api/articles/feeds/desc/feed.xml"><style data-emotion="rpcss lvyu5j">.rpcss-lvyu5j{margin-right:10px;}</style><img class="rpcss-lvyu5j" alt="Flux RSS" height="16" src="/public/images/website/rss-feed.svg" width="16"/><style data-emotion="rpcss um3i31">@media (max-width: 400px){.rpcss-um3i31{display:none;}}</style><div class="rpcss-um3i31">Flux RSS</div></a><style data-emotion="rpcss 12cp4l7">.rpcss-12cp4l7{color:rgba(255, 255, 255, 0.5);text-align:center;font-size:14px;}</style><div class="rpcss-12cp4l7">© 2021 Putain de code !</div><style data-emotion="rpcss 1w98uy3">.rpcss-1w98uy3{position:absolute;right:0;top:50%;color:#fff;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="rpcss-1w98uy3" href="https://github.com/putaindecode/putaindecode.io">GitHub</a></div></div></div></footer></div><script id="initialData" type="text/data">{"lists":{"RE_PRIVATE_NONE":true},"items":{"k":"articles","v":{"k":"dependances-et-premier-projet-en-ruby","v":{"_0":{"TAG":0,"_0":{"slug":"dependances-et-premier-projet-en-ruby","filename":"2014-10-14-dependances-et-premier-projet-en-ruby","title":"Dépendances et premier projet en Ruby","date":"Tue, 14 Oct 2014 00:00:00 GMT","draft":false,"meta":{"date":"2014-10-14T00:00:00.000Z","title":"Dépendances et premier projet en Ruby","author":"rhannequin","oldSlug":"ruby/bundler","slug":"dependances-et-premier-projet-en-ruby"},"body":"<p><a href=\"#tl-dr\">tl;dr</a></p>\n<p>Dans l'<a href=\"/fr/articles/ruby/premiers-pas/\">article précédent</a> nous avons installé\nRuby. Désormais nous allons aborder les gems, les dépendances et commencer notre\nweb service.</p>\n<p>Un gem en Ruby c'est une lib, comme un paquet NPM pour NodeJS. C'est d'ailleurs\nle système de rubygems qui a inspiré le système de NPM. Pour installer un gem,\nrien de plus simple que <code>gem install sass</code>, qui ici va installer la bibliothèque\n<code>sass</code>.</p>\n<p>Un projet Ruby nécessite la plupart du temps des bibliothèques afin de ne pas\ntout faire soi-même, il est donc nécessaire d'avoir une gestion des dépendances\npour le projet.</p>\n<h2>Bundler, le gem qui gère les gems</h2>\n<p><a href=\"http://bundler.io\">Bundler</a> est un gem qui va vous permettre de créer un\nfichier Gemfile contenant vos dépendances, et qui vous installera les gems\nnécessaires avec la gestion des versions et de leurs propres dépendances. Un\nfichier Gemfile se présente comme ceci :</p>\n<pre><code class=\"hljs language-ruby\">source <span class=\"hljs-string\">&#x27;https://rubygems.org&#x27;</span>\nruby <span class=\"hljs-string\">&#x27;2.1.2&#x27;</span>\ngem <span class=\"hljs-string\">&#x27;sinatra&#x27;</span>\n</code></pre>\n<p>L'instruction <code>source</code> permet de préciser l'url des dépôts de gems. La version\nde ruby n'est pas obligatoire mais j'aime la préciser pour ne pas me mélanger\ndans mes projets avec différentes versions de Ruby (voir le\n<a href=\"/fr/articles/ruby/premiers-pas/\">précédent article pour les versions du Ruby</a>\net <a href=\"https://github.com/sstephenson/rbenv\">rbenv</a>). Et enfin, la déclaration de\nnotre première bibliothèque de dépendance : <a href=\"http://www.sinatrarb.com\">Sinatra</a>.</p>\n<p>Il est possible d'être bien plus précis dans le Gemfile, comme...</p>\n<p>Préciser dans quel environnement charger les gems :</p>\n<pre><code class=\"hljs language-ruby\">gem <span class=\"hljs-string\">&#x27;sqlite3&#x27;</span>, <span class=\"hljs-symbol\">group:</span> [<span class=\"hljs-symbol\">:development</span>, <span class=\"hljs-symbol\">:test</span>]\n</code></pre>\n<p>Une numéro de version :</p>\n<pre><code class=\"hljs language-ruby\">gem <span class=\"hljs-string\">&#x27;rails&#x27;</span>, <span class=\"hljs-string\">&#x27;4.1.6&#x27;</span>         <span class=\"hljs-comment\"># version 4.1.6</span>\ngem <span class=\"hljs-string\">&#x27;sass-rails&#x27;</span>, <span class=\"hljs-string\">&#x27;~&gt; 4.0.3&#x27;</span> <span class=\"hljs-comment\"># &gt;= 4.0.3 mais &lt; 4.1.0</span>\n</code></pre>\n<p>Préciser la classe à charger :</p>\n<pre><code class=\"hljs language-ruby\">gem <span class=\"hljs-string\">&#x27;valid_email&#x27;</span>, <span class=\"hljs-symbol\">require:</span> <span class=\"hljs-string\">&#x27;valid_email/email_validator&#x27;</span>\n</code></pre>\n<p>Aller chercher directement sur Github :</p>\n<pre><code class=\"hljs language-ruby\">gem <span class=\"hljs-string\">&#x27;nokogiri&#x27;</span>, <span class=\"hljs-symbol\">github:</span> <span class=\"hljs-string\">&#x27;sparklemotion/nokogiri&#x27;</span>\n<span class=\"hljs-comment\"># https://github.com/sparklemotion/nokogiri.git</span>\n\ngem <span class=\"hljs-string\">&#x27;rails&#x27;</span>, <span class=\"hljs-symbol\">github:</span> <span class=\"hljs-string\">&#x27;rails&#x27;</span>\n<span class=\"hljs-comment\"># https://github.com/rails/rails.git</span>\n\ngem <span class=\"hljs-string\">&#x27;rails&#x27;</span>, <span class=\"hljs-symbol\">github:</span> <span class=\"hljs-string\">&#x27;rails&#x27;</span>, <span class=\"hljs-symbol\">branch:</span> <span class=\"hljs-string\">&#x27;4-1-stable&#x27;</span>\n<span class=\"hljs-comment\"># https://github.com/rails/rails.git sur la branche 4-1-stable</span>\n</code></pre>\n<p>Il existe encore d'autres instructions, de quoi rendre sa gestion des\ndépendances vraiment fine et précise.</p>\n<p>Une fois le Gemfile prêt, bundler a plusieurs commandes de disponibles pour\npouvoir les télécharger et utiliser.</p>\n<ul>\n<li><code>$ bundle install</code> installera les gems requis</li>\n<li><code>$ bundle update</code> mettra à jour vers les versions les plus récentes si\npossible les gems requis</li>\n<li><code>$ bundle exec</code> permettra de précéder une commande ruby afin de l'exécuter\ndans le contexte du Gemfile, très utile lorsque l'on a différentes versions de\nRuby qui se baladent dans le terminal</li>\n</ul>\n<p>Bundler va générer un fichier <code>Gemfile.lock</code> qui est la description exhaustive\ndes dépendances de votre application, chaque gem avec le numéro de sa version\ninstallée, chaque dépendance pour chaque gem, une jolie arborescence plus que\nprécise.</p>\n<h2>Commençons notre web service</h2>\n<p>Assez parlé des outils qui existent, utilisons-les. Tout d'abord installons\nBundler, sans oublier le <code>$ rbenv rehash</code> nécessaire si vous utilisez rbenv pour\nvos versions de Ruby afin de mettre à jour les commandes disponibles dans le\nterminal :</p>\n<pre><code>$ gem install bundler\n$ rbenv rehash\n</code></pre>\n<p>Pour notre première application, nous allons faire un web service avec Sinatra\nqui est un micro-framework web, ayant d'ailleurs clairement inspiré Express\n(&quot;Sinatra inspired web development framework for node.js&quot;). Notre Gemfile va\ndonc être exactement comme notre premier exemple :</p>\n<pre><code class=\"hljs language-ruby\">source <span class=\"hljs-string\">&#x27;https://rubygems.org&#x27;</span>\nruby <span class=\"hljs-string\">&#x27;2.1.2&#x27;</span>\ngem <span class=\"hljs-string\">&#x27;sinatra&#x27;</span>\n</code></pre>\n<p>Un petit <code>bundle install</code> et nous sommes prêts à démarrer !</p>\n<p>Pour ne pas brusquer les choses, nous allons faire la version la plus simple\nd'un web service avec Sinatra, ce qui nous permettra de constater la simplicité\nextrême de Ruby et du framework :</p>\n<pre><code class=\"hljs language-ruby\"><span class=\"hljs-comment\">########</span>\n<span class=\"hljs-comment\"># app.rb</span>\n<span class=\"hljs-comment\">#</span>\n\n<span class=\"hljs-keyword\">require</span> <span class=\"hljs-string\">&#x27;sinatra&#x27;</span>\n\nget <span class=\"hljs-string\">&#x27;/&#x27;</span> <span class=\"hljs-keyword\">do</span>\n  <span class=\"hljs-string\">&#x27;Hello World!&#x27;</span>\n<span class=\"hljs-keyword\">end</span>\n</code></pre>\n<p>Qu'avons-nous fait là ? Pas grand chose, et en même temps tout juste ce qu'il\nfaut. Nous avons inclus le gem à notre script et utilisé la méthode Sinatra\n<code>get</code> nous permettant de déclarer un point d'entrée en <code>GET</code> sur la route '/'.\nCette méthode prend également comme argument un <code>block</code> caractérisé par le <code>do</code>\net le <code>end</code>. La dernière valeur du block étant la valeur de retour, nous\nrenvoyons la seule chaîne de caractères &quot;Hello World!&quot;.</p>\n<p>Et maintenant : lancement ! <code>$ bundle exec ruby app.rb</code> va lancer l'application\n(mais <code>ruby app.rb</code> suffit), par défaut sur le port <code>4567</code>. Regardez vite\n<a href=\"http://localhost:4567\">http://localhost:4567</a> et là magie, &quot;Hello World!&quot; sur\nune magnifique page blanche, notre tout premier web service est fonctionnel.</p>\n<p>Alors oui, ce n'est pas une révolution. Mais tout de même, en réduisant la\nsyntaxe du block on se retrouve avec un script de deux lignes qui crée un vrai\nweb service web. Et vous allez vite voir qu'en quelques lignes de plus on peut\nvite complexifier le bousin.</p>\n<h2>Au prochain épisode</h2>\n<p>Dans l'article suivant nous allons ajouter des fonctionnalités à notre toute\nnouvelle application, de nouvelles routes, de la persistence et aussi des vues\ndans un format un peu plus utile.</p>\n<p>Stay tuned!</p>\n<h2>tl;dr</h2>\n<p>Voici la version abrégée de cet article :</p>\n<pre><code class=\"hljs language-ruby\"><span class=\"hljs-comment\"># Gemfile</span>\nsource <span class=\"hljs-string\">&#x27;https://rubygems.org&#x27;</span>\nruby <span class=\"hljs-string\">&#x27;2.1.2&#x27;</span>\ngem <span class=\"hljs-string\">&#x27;sinatra&#x27;</span>\n</code></pre>\n<pre><code class=\"hljs language-ruby\"><span class=\"hljs-comment\"># app.rb</span>\n<span class=\"hljs-keyword\">require</span> <span class=\"hljs-string\">&#x27;sinatra&#x27;</span>\nget <span class=\"hljs-string\">&#x27;/&#x27;</span> <span class=\"hljs-keyword\">do</span>\n  <span class=\"hljs-string\">&#x27;Hello World!&#x27;</span>\n<span class=\"hljs-keyword\">end</span>\n</code></pre>\n<pre><code class=\"hljs language-console\"><span class=\"hljs-meta\">$</span><span class=\"bash\"> gem install bundler</span>\n<span class=\"hljs-meta\">$</span><span class=\"bash\"> rbenv <span class=\"hljs-built_in\">rehash</span></span>\n<span class=\"hljs-meta\">$</span><span class=\"bash\"> bundle install</span>\n<span class=\"hljs-meta\">$</span><span class=\"bash\"> ruby app.rb</span>\n</code></pre>\n<h2>Sources</h2>\n<ul>\n<li><a href=\"https://rubygems.org\">RubyGems</a></li>\n<li><a href=\"http://bundler.io\">Bundler</a></li>\n<li><a href=\"https://github.com/sstephenson/rbenv\">rbenv</a></li>\n<li><a href=\"http://www.sinatrarb.com\">Sinatra</a> et surtout son\n<a href=\"http://www.sinatrarb.com/intro.html\">README</a></li>\n</ul>\n"}}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"listsRequests":{"data":{"RE_PRIVATE_NONE":true}},"itemsRequests":{"data":{"RE_PRIVATE_NONE":true}}}</script><head><script defer="defer" src="/public/main.56c69761a03eb0112696.js"></script></head></html>