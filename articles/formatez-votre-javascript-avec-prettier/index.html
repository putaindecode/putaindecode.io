<!DOCTYPE html><html lang="fr"><head><title data-react-helmet="true">Formatez votre JavaScript avec prettier | Putain de code</title><meta data-react-helmet="true" charset="UTF-8"/><meta data-react-helmet="true" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover" name="viewport"/><meta data-react-helmet="true" content="summary_large_image" name="twitter:card"/><meta data-react-helmet="true" content="Putain de code !" property="og:site_name"/><meta data-react-helmet="true" content="@putaindecode" name="twitter:site"/><meta data-react-helmet="true" content="https://putaindecode.io/public/images/website/share.jpg" property="og:image"/><meta data-react-helmet="true" content="https://putaindecode.io/public/images/website/share.jpg" name="twitter:image"/><meta data-react-helmet="true" content="1500" property="og:image:width"/><meta data-react-helmet="true" content="777" property="og:image:height"/><meta data-react-helmet="true" content="Formatez votre JavaScript avec prettier | Putain de code" property="og:title"/><meta data-react-helmet="true" content="Formatez votre JavaScript avec prettier | Putain de code" name="twitter:title"/><meta data-react-helmet="true" content="Un article proposé par zoontek" name="description"/><link data-react-helmet="true" title="RSS Feed" href="/api/articles/feeds/desc/feed.xml" rel="alternate" type="application/rss+xml"/><link data-react-helmet="true" href="/favicon.ico" rel="shortcut icon"/><link data-react-helmet="true" href="https://putaindecode.io/articles/formatez-votre-javascript-avec-prettier" rel="canonical"/><script>window.PAGES_BOOT_MODE="hydrate";</script></head><div id="root"><style data-emotion="rpcss zx73cm 1lc6tyj 28v1b4">@-webkit-keyframes animation-zx73cm{from{opacity:0;-webkit-transform:translateY(20px);-moz-transform:translateY(20px);-ms-transform:translateY(20px);transform:translateY(20px);}}@keyframes animation-zx73cm{from{opacity:0;-webkit-transform:translateY(20px);-moz-transform:translateY(20px);-ms-transform:translateY(20px);transform:translateY(20px);}}:root{--page-background-color:#fff;--page-slightly-accented-background-color:#F9F6F6;--page-accented-background-color:#E4EBEE;--page-text-color:#46515B;--link-text-color:#E51D58;--gradient-red-top:#E51D58;--gradient-red-bottom:#CC0613;--code-background-color:#FAF3E1;--one-percent-contrast-color:rgba(0, 0, 0, 0.1);--half-percent-contrast-color:rgba(0, 0, 0, 0.05);}@media (prefers-color-scheme: dark){:root{--page-background-color:#222;--page-slightly-accented-background-color:#171717;--page-accented-background-color:#111;--page-text-color:#ddd;--link-text-color:#F87098;--gradient-red-top:#E51D58;--gradient-red-bottom:#CC0613;--code-background-color:#4F3804;--one-percent-contrast-color:rgba(255, 255, 255, 0.1);--half-percent-contrast-color:rgba(255, 255, 255, 0.05);}}body{padding:0;margin:0;background-color:var(--page-background-color);color:var(--page-text-color);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;overflow-x:hidden;}html{font-size:1em;line-height:1.4;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%;}a{color:var(--link-text-color);-webkit-text-decoration:underline;text-decoration:underline;}a:hover{-webkit-text-decoration:none;text-decoration:none;}#root{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}*,*:before,*:after{box-sizing:border-box;}pre,.hljs{color:#adbac7;background:#22272e;}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#f47067;}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#dcbdfb;}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-variable,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id{color:#6cb6ff;}.hljs-regexp,.hljs-string,.hljs-meta .hljs-string{color:#96d0ff;}.hljs-built_in,.hljs-symbol{color:#f69d50;}.hljs-comment,.hljs-code,.hljs-formula{color:#768390;}.hljs-name,.hljs-quote,.hljs-selector-tag,.hljs-selector-pseudo{color:#8ddb8c;}.hljs-subst{color:#adbac7;}.hljs-section{color:#316dca;font-weight:bold;}.hljs-bullet{color:#eac55f;}.hljs-emphasis{color:#adbac7;font-style:italic;}.hljs-strong{color:#adbac7;font-weight:bold;}.hljs-addition{color:#b4f1b4;background-color:#1b4721;}.hljs-deletion{color:#ffd8d3;background-color:#78191b;}</style><style data-emotion="rpcss 9vhaby">.rpcss-9vhaby{background-color:var(--gradient-red-bottom);background-image:linear-gradient(to bottom right, var(--gradient-red-top), var(--gradient-red-bottom));}</style><header class="rpcss-9vhaby" style="background-image:linear-gradient(to bottom right, hsl(108, 100%, 35%), hsl(90, 100%, 30%))"><style data-emotion="rpcss 1qqk0tr">.rpcss-1qqk0tr{padding-left:env(safe-area-inset-left);padding-right:env(safe-area-inset-right);}</style><div class="rpcss-1qqk0tr"><style data-emotion="rpcss qx7dny">.rpcss-qx7dny{width:100%;max-width:1024px;margin:0 auto;padding:0 10px;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;}</style><div class="rpcss-qx7dny"><style data-emotion="rpcss 7s9om2">.rpcss-7s9om2{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding:20px 0 50px;}</style><div class="rpcss-7s9om2"><style data-emotion="rpcss gdpa5c">.rpcss-gdpa5c{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-text-decoration:none;text-decoration:none;}</style><a class="rpcss-gdpa5c" href="/"><style data-emotion="rpcss 1lm4738">.rpcss-1lm4738{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-text-decoration:none;text-decoration:none;padding-bottom:10px;}</style><div class="rpcss-1lm4738"><style data-emotion="rpcss 13o7eu2">.rpcss-13o7eu2{display:block;}</style><svg class="rpcss-13o7eu2" height="36px" width="36px" viewBox="0 0 36 36"><defs><linearGradient id="PutainDeCodeLogoGradient" x1="50%" x2="50%" y1="0%" y2="127.223881%"><stop offset="0%" stop-color="#E41D57"></stop><stop offset="100%" stop-color="#C60000"></stop></linearGradient></defs><circle cx="18" cy="18" fill="url(#PutainDeCodeLogoGradient)" r="17" stroke="#FFFFFF" stroke-width="2"></circle><polygon fill="#FFFFFF" points="15.9033203 18.2246094 15.9033203 18.3710938 11.2304688 20.5317383 11.2304688 22.8095703 18.0566406 19.184082 18.0566406 17.4116211 11.2304688 13.7788086 11.2304688 16.0639648"></polygon><rect height="14" width="2" fill="#FFFFFF" x="22" y="11"><animate attributeName="opacity" begin="100ms" calcMode="discrete" dur="2s" repeatCount="indefinite" values="1;0"></animate></rect></svg><style data-emotion="rpcss 4cf197">.rpcss-4cf197{width:10px;height:10px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}</style><div class="rpcss-4cf197"></div><style data-emotion="rpcss u5k24">.rpcss-u5k24{font-size:22px;color:#fff;font-weight:800;}</style><div aria-level="2" class="rpcss-u5k24" role="heading">Putain de code !</div></div><style data-emotion="rpcss 1nyebg4">.rpcss-1nyebg4{font-size:14px;color:rgba(255, 255, 255, 0.8);text-align:center;}</style><div class="rpcss-1nyebg4">Blog participatif de la communauté dev</div></a></div></div></div></header><style data-emotion="rpcss a4ric9">.rpcss-a4ric9{background-color:var(--page-slightly-accented-background-color);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}</style><div class="rpcss-a4ric9"><style data-emotion="rpcss oeugsb">.rpcss-oeugsb{-webkit-animation:500ms ease-out animation-zx73cm;animation:500ms ease-out animation-zx73cm;}</style><div class="rpcss-oeugsb"><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 1qc2bam">.rpcss-1qc2bam{font-size:42px;font-weight:800;text-align:center;padding-top:40px;line-height:1.2;margin:0;}</style><h1 class="rpcss-1qc2bam">Formatez votre JavaScript avec prettier</h1><style data-emotion="rpcss obg2kr">.rpcss-obg2kr{font-size:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding-top:10px;padding-bottom:40px;color:var(--page-text-color);-webkit-text-decoration:none;text-decoration:none;}</style><a class="rpcss-obg2kr" href="https://github.com/zoontek"><style data-emotion="rpcss uco8i7">.rpcss-uco8i7{width:32px;height:32px;border-radius:100%;margin-right:10px;}</style><img class="rpcss-uco8i7" alt="zoontek" src="https://avatars.githubusercontent.com/zoontek?size=64"/><div>zoontek<!-- --> <!-- -->•<!-- --> <!-- -->2017/03/08</div></a><style data-emotion="rpcss 15kxmi0">.rpcss-15kxmi0{max-width:640px;width:100%;font-size:18px;margin:0 auto;line-height:1.7;}.rpcss-15kxmi0 h2,.rpcss-15kxmi0 h3,.rpcss-15kxmi0 h4,.rpcss-15kxmi0 h5,.rpcss-15kxmi0 h6{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;font-weight:800;line-height:1.2;}.rpcss-15kxmi0 img{max-width:100%;background-color:rgba(255, 255, 255, 0.75);}.rpcss-15kxmi0 code{font-size:0.9em;font-family:PragmataPro,SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;line-height:1;background-color:var(--code-background-color);margin:0 0.2em;}.rpcss-15kxmi0 pre{padding:10px;overflow-x:auto;font-size:14px;border-radius:10px;border:2px solid var(--one-percent-contrast-color);-webkit-overflow-scrolling:touch;}.rpcss-15kxmi0 pre code{font-size:14px;background-color:transparent;margin:0;}.rpcss-15kxmi0 blockquote{padding-left:20px;margin:0;font-size:16px;border-left:3px solid var(--one-percent-contrast-color);font-style:italic;}.rpcss-15kxmi0 table{width:100%;text-align:center;}.rpcss-15kxmi0 figure{padding:20px 0;}.rpcss-15kxmi0 figcaption{text-align:center;}.rpcss-15kxmi0 a{word-wrap:break-word;}.rpcss-15kxmi0 table thead th{background-color:var(--page-accented-background-color);padding:10px 0;}</style><div class="rpcss-15kxmi0"><p>Rob Pike et Ken Thompson ont conçu le langage de programmation Go de façon à ce
que celui-ci soit à portée des jeunes développeurs : si vous découvrez et
commencez à apprendre le Go le lundi, vous devriez être en mesure d'être
productif le mercredi. Le langage est extrêmement minimaliste, il y a rarement
plus d'une façon de faire quelque chose.</p>
<p>Seulement voilà, le développeur torturé se posera toujours un tas de questions
essentielles : tabs ou spaces ? 2, 4 ou 8 spaces ? Single quotes ou double
quotes ? Après quelles structures de contrôle passer une ligne ? Mais aussi les
éternels : vim ou emacs ? Flow ou TypeScript ? Maintenir ce projet Angular 1 ou
démissionner comme un prince ?</p>
<p><em>N.B. : Pour information, les bonnes réponses sont bien évidemment spaces, 2,
single quotes, vim, flow, la démission</em></p>
<p>C'est pour répondre à ce problème (enfin, ceux liés au formatage de votre code)
que Go intègre un formatting tool (<code>fmt</code>, comme la commande Unix), intitulé
<a href="https://golang.org/cmd/gofmt/">gofmt</a>.</p>
<ol>
<li>Vous codez comme vous le sentez</li>
<li>Vous sauvegardez votre fichier</li>
<li>Votre code est automatiquement formaté</li>
<li>Vous vous sentez frustré</li>
<li>Très vite, vous vous rendez compte que c'est pour votre bien, et que perdre
du temps ou débattre sur ce genre de détails, c'est tout sauf utile</li>
</ol>
<p>Autre avantage non négligeable : le code Go que vous trouverez dans d'autres
packages, des exemples, etc. sera toujours formaté de la même façon.</p>
<p><em>À noter : Reason offre quelque chose de similaire avec
<a href="https://facebook.github.io/reason/tools.html">refmt</a>.</em></p>
<p>Cette solution officielle n'existe pas en JS. Mais c'est ici qu'intervient
<a href="https://github.com/prettier/prettier">prettier</a> (et non
<a href="https://www.npmjs.com/package/jsfmt">jsfmt</a>, qui existe mais ne semble plus
maintenu), un projet relativement récent, en version <code>0.21</code> à l'heure où j'écris
ces lignes. Compatible <em>out of the box</em> avec le JS ES2017, JSX, flow, il offre
également le moins de configuration possible (ce qui est une bonne chose). Le
projet est activement suivi par Facebook, qui discute même la possibilité de
s'en servir sur la codebase de
<a href="https://github.com/facebook/react/pull/9101">React</a>.</p>
<h2>Comment ça fonctionne ?</h2>
<p>Croyez-le ou non, ce n'est pas &quot;tellement&quot; complexe. À la manière de babel ou
flow, prettier utilise un AST parser (Abstract Syntax Tree parser) afin
d'analyser le contenu de votre fichier JS, suite à quoi il va simplement
formater votre code sans tenir compte de la forme précédente, en ne gardant que
ce qui est important: le fond, pas la forme.</p>
<p>Je vous invite à jouer avec <a href="https://astexplorer.net/">AST explorer</a> pour
comprendre beaucoup plus simplement comment tout cela fonctionne.</p>
<h2>Installation</h2>
<pre><code class="hljs language-console">npm install --save-dev prettier
</code></pre>
<p>Ou, pour les meilleurs d'entre vous :</p>
<pre><code class="hljs language-console">yarn add --dev prettier
</code></pre>
<p>¯\<em>( ツ )</em>/¯</p>
<h2>Configuration</h2>
<p>Car oui, il y en a tout de même un peu. Il est possible de régler:</p>
<ul>
<li>La longueur maximale des lignes (<code>printWidth</code>, <code>80</code> caractères par défaut)</li>
<li>Le nombre d'espaces pour l'indentation (<code>tabWidth</code>, <code>2</code> par défaut, pas de
tabs)</li>
<li>Single quotes / double quotes (<code>singleQuote</code>, <code>false</code> par défaut)</li>
<li>S'il faut ajouter des virgules en fin de certaines structures (comme les
objets, mais aussi dans les paramètres de fonction, ce qui est possible depuis
peu) (<code>trailingComma</code>, <code>none</code> par défaut, <code>es5</code> et <code>all</code> sont également
possibles)</li>
<li>S'il faut ajouter des espaces dans un objet écrit sur une seule ligne
(<code>bracketSpacing</code>, <code>true</code> par défaut)</li>
<li>Comment fermer les balises JSX (<code>jsxBracketSameLine</code>, <code>false</code> par défaut)</li>
<li>Quel parser utiliser (<code>parser</code>, <code>babylon</code> par défaut, <code>flow</code> est disponible)</li>
</ul>
<blockquote>
<p>Mais attends… Si l'on peut malgré tout configurer tout ça, ce n'est plus
vraiment un style standard ?</p>
</blockquote>
<p>Oui et non, car il y aura toujours beaucoup de détails sur lesquels il nous sera
impossible de choisir, les options resteront minimalistes. Par exemple, vous ne
pourrez jamais retirer les points-virgules.</p>
<p><code>EDIT: Il semblerait que malgré ce qui a pu être annoncé par l'auteur de prettier, une option --no-semicolons soit dans les tuyaux.</code></p>
<p>Dans tous les cas, prettier reste un outil extrêmement pratique pour forcer le
formatage du code au sein de votre équipe.</p>
<p>Ouvrez votre <code>package.json</code>, c'est parti.</p>
<pre><code class="hljs language-json">{
  <span class="hljs-attr">&quot;scripts&quot;</span>: {
    <span class="hljs-attr">&quot;prettify&quot;</span>: <span class="hljs-string">&quot;prettier src/**/*.js&quot;</span>
  },
  <span class="hljs-attr">&quot;devDependencies&quot;</span>: {
    <span class="hljs-attr">&quot;prettier&quot;</span>: <span class="hljs-string">&quot;^0.21.0&quot;</span>
  }
}
</code></pre>
<p><code>npm run prettify</code> ou <code>yarn run prettify</code> formateront automatiquement tous les
fichiers <code>.js</code> contenus dans votre dossier <code>/src</code>. Bon j'avoue, c'est assez
basique comme usage. Ajoutons-y notre config préférée.</p>
<pre><code class="hljs language-json">{
  <span class="hljs-attr">&quot;scripts&quot;</span>: {
    <span class="hljs-attr">&quot;prettify&quot;</span>:
      <span class="hljs-string">&quot;prettier --single-quote --trailing-comma all --write &#x27;{src,__{tests,mocks}__}/**/*.js&#x27;&quot;</span>
  },
  <span class="hljs-attr">&quot;devDependencies&quot;</span>: {
    <span class="hljs-attr">&quot;prettier&quot;</span>: <span class="hljs-string">&quot;^0.21.0&quot;</span>
  }
}
</code></pre>
<p><code>npm run prettify</code> ou <code>yarn run prettify</code> formateront maintenant automatiquement
tous les fichiers <code>.js</code> contenus dans vos dossiers <code>/src</code>, <code>__tests__</code> et
<code>__mocks__</code>, en utilisant le parser de flow, préférant les single quotes et en
ajoutant une virgule en fin de chaque structure possible.</p>
<p>OK. Mais si un membre de l'équipe oublie d'exécuter le script avant de commiter
son code ? <strong>We got this !</strong> (avec 2 dépendances de plus).</p>
<pre><code class="hljs language-json">{
  <span class="hljs-attr">&quot;scripts&quot;</span>: {
    <span class="hljs-attr">&quot;precommit&quot;</span>: <span class="hljs-string">&quot;lint-staged&quot;</span>,
    <span class="hljs-attr">&quot;prettify&quot;</span>:
      <span class="hljs-string">&quot;prettier --single-quote --trailing-comma all --write &#x27;{src,__{tests,mocks}__}/**/*.js&#x27;&quot;</span>
  },
  <span class="hljs-attr">&quot;lint-staged&quot;</span>: {
    <span class="hljs-attr">&quot;{src,__{tests,mocks}__}/**/*.js&quot;</span>: [
      <span class="hljs-string">&quot;prettier --single-quote --trailing-comma all --write&quot;</span>,
      <span class="hljs-string">&quot;git add&quot;</span>
    ]
  },
  <span class="hljs-attr">&quot;devDependencies&quot;</span>: {
    <span class="hljs-attr">&quot;husky&quot;</span>: <span class="hljs-string">&quot;^0.13.2&quot;</span>,
    <span class="hljs-attr">&quot;lint-staged&quot;</span>: <span class="hljs-string">&quot;^3.3.1&quot;</span>,
    <span class="hljs-attr">&quot;prettier&quot;</span>: <span class="hljs-string">&quot;^0.21.0&quot;</span>
  }
}
</code></pre>
<h2>Les plugins</h2>
<p>Si vous ne pouvez pas attendre le moment du commit pour admirer votre code
fraichement formaté, il existe déjà pas mal de plugins, pour pas mal d'éditeurs
: <code>prettier-atom</code>, <code>prettier-vscode</code>, <code>Jsprettier</code> (pour Sublime Text), mais
aussi pour emacs, vim, les IDE Jetbrain, etc. Tout est dans le
<a href="https://github.com/prettier/prettier/blob/master/README.md">README</a>.</p>
<p><em>Protip: Inutile de vous conforter au style de formatage de votre équipe au sein
de votre éditeur si le code est à nouveau formaté en pre-commit.</em></p>
<h2>Quelques exemples, c'est possible ?</h2>
<p>J'ai mieux. Il est possible
d'<a href="https://prettier.github.io/prettier">essayer en ligne</a> ! ✨</p>
<h2>Donc c'est bon, tu conseilles ?</h2>
<p>C'est tout de même à réfléchir. Le projet est encore jeune et en beta, même s'il
évolue extrêmement vite. Tout n'est pas encore parfaitement supporté, mais je
vous rassure, si vous n'utilisez pas le flow-parser vous ne risquez pas de
rencontrer beaucoup de problèmes avec la dernière version.</p>
<p>Des projets tels que
<a href="https://github.com/facebook/immutable-js/commit/9bcc8b54a17c3bbc94d70864121784bc91011e8f">immutable-js</a>,
<a href="https://github.com/necolas/react-native-web/commit/a2f25a46c495ca53a75e728cfb14dbdf67cdb342">react-native-web</a>
et
<a href="https://github.com/babel/babel/commit/bdbe2cfbc5ab5ba6f528b7ee3e4bf5ed940a47af">babel</a>
y sont déjà passés. Pourquoi pas vous ? 😉</p>
</div><style data-emotion="rpcss unyj6i">.rpcss-unyj6i{max-width:640px;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin:20px auto;padding:20px;background-color:var(--page-background-color);border-radius:10px;box-shadow:0 15px 15px -5px rgba(0, 0, 0, 0.2);}@media (max-width: 540px){.rpcss-unyj6i{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><div class="rpcss-unyj6i"><style data-emotion="rpcss ty7r4z">.rpcss-ty7r4z{font-weight:800;}</style><div class="rpcss-ty7r4z">Vous avez aimé cet article?</div><style data-emotion="rpcss klacsp">.rpcss-klacsp{width:0;height:10px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}</style><div class="rpcss-klacsp"></div><style data-emotion="rpcss 1pkr03v">.rpcss-1pkr03v{background-color:#00aced;color:#fff;padding:10px 20px;-webkit-text-decoration:none;text-decoration:none;border-radius:5px;font-weight:800;}.rpcss-1pkr03v:active{opacity:0.5;}</style><a class="rpcss-1pkr03v" href="https://www.twitter.com/intent/tweet?text=Formatez%20votre%20JavaScript%20avec%20prettier%20sur%20%40PutainDeCode%20https%3A%2F%2Fputaindecode.io%2Farticles%2Fformatez-votre-javascript-avec-prettier" target="_blank">Le partager sur Twitter</a></div><style data-emotion="rpcss x4iqxe">.rpcss-x4iqxe{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;text-align:center;padding:20px;}</style><div class="rpcss-x4iqxe"><style data-emotion="rpcss gein6x">.rpcss-gein6x{font-size:20px;-webkit-text-decoration:none;text-decoration:none;color:#1E49B5;}</style><a class="rpcss-gein6x" href="/articles">← Articles</a></div><style data-emotion="rpcss 8bodgl">.rpcss-8bodgl{max-width:640px;width:100%;margin:0 auto;padding:20px 0;}</style><div class="rpcss-8bodgl" id="disqus_thread"></div></div></div></div></div><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 1vau6rl">.rpcss-1vau6rl{margin:20px 0;background-color:var(--page-accented-background-color);border-radius:10px;padding:20px;}</style><div class="rpcss-1vau6rl"><style data-emotion="rpcss 1gz1i1h">.rpcss-1gz1i1h{font-size:32px;font-weight:800;margin-bottom:20px;text-align:center;}</style><div aria-level="2" class="rpcss-1gz1i1h" role="heading">Ne rien rater</div><style data-emotion="rpcss 1wbispj">.rpcss-1wbispj{font-size:18px;margin-bottom:10px;text-align:center;}</style><div aria-level="3" class="rpcss-1wbispj" role="heading">Sur les réseaux</div><style data-emotion="rpcss 1hyoz7m">.rpcss-1hyoz7m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;}</style><div class="rpcss-1hyoz7m"><a href="https://twitter.com/PutainDeCode"><img alt="Twitter" height="48" src="/public/images/website/twitter.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://facebook.com/putaindecode"><img alt="Facebook" height="48" src="/public/images/website/facebook.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://github.com/putaindecode"><img alt="Facebook" height="48" src="/public/images/website/github.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://itunes.apple.com/fr/podcast/putain-de-code-!/id1185311825"><img alt="Apple Podcast" height="48" src="/public/images/website/apple-podcast.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://soundcloud.com/putaindecode"><img alt="Soundcloud" height="48" src="/public/images/website/soundcloud.svg" width="48"/></a></div><div aria-level="3" class="rpcss-1wbispj" role="heading">Sur le chat</div><div class="rpcss-1hyoz7m"><a href="https://discord.gg/jtbGNNc"><img alt="Discord" height="48" src="/public/images/website/discord.svg" width="48"/></a></div></div></div></div><style data-emotion="rpcss zs8kw7">.rpcss-zs8kw7{background-color:#222;padding:20px 0;}</style><footer class="rpcss-zs8kw7"><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 79elbk">.rpcss-79elbk{position:relative;}</style><div class="rpcss-79elbk"><style data-emotion="rpcss 1hle0ni">.rpcss-1hle0ni{position:absolute;left:0;top:50%;color:#fff;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="rpcss-1hle0ni" href="/api/articles/feeds/desc/feed.xml"><style data-emotion="rpcss lvyu5j">.rpcss-lvyu5j{margin-right:10px;}</style><img class="rpcss-lvyu5j" alt="Flux RSS" height="16" src="/public/images/website/rss-feed.svg" width="16"/><style data-emotion="rpcss um3i31">@media (max-width: 400px){.rpcss-um3i31{display:none;}}</style><div class="rpcss-um3i31">Flux RSS</div></a><style data-emotion="rpcss 12cp4l7">.rpcss-12cp4l7{color:rgba(255, 255, 255, 0.5);text-align:center;font-size:14px;}</style><div class="rpcss-12cp4l7">© 2021 Putain de code !</div><style data-emotion="rpcss 1w98uy3">.rpcss-1w98uy3{position:absolute;right:0;top:50%;color:#fff;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="rpcss-1w98uy3" href="https://github.com/putaindecode/putaindecode.io">GitHub</a></div></div></div></footer></div><script id="initialData" type="text/data">{"lists":{"RE_PRIVATE_NONE":true},"items":{"k":"articles","v":{"k":"formatez-votre-javascript-avec-prettier","v":{"_0":{"TAG":0,"_0":{"slug":"formatez-votre-javascript-avec-prettier","filename":"2017-03-08-formatez-votre-javascript-avec-prettier","title":"Formatez votre JavaScript avec prettier","date":"Wed, 08 Mar 2017 00:00:00 GMT","draft":false,"meta":{"date":"2017-03-08T00:00:00.000Z","title":"Formatez votre JavaScript avec prettier","author":"zoontek","oldSlug":"js/prettier","slug":"formatez-votre-javascript-avec-prettier"},"body":"<p>Rob Pike et Ken Thompson ont conçu le langage de programmation Go de façon à ce\nque celui-ci soit à portée des jeunes développeurs : si vous découvrez et\ncommencez à apprendre le Go le lundi, vous devriez être en mesure d'être\nproductif le mercredi. Le langage est extrêmement minimaliste, il y a rarement\nplus d'une façon de faire quelque chose.</p>\n<p>Seulement voilà, le développeur torturé se posera toujours un tas de questions\nessentielles : tabs ou spaces ? 2, 4 ou 8 spaces ? Single quotes ou double\nquotes ? Après quelles structures de contrôle passer une ligne ? Mais aussi les\néternels : vim ou emacs ? Flow ou TypeScript ? Maintenir ce projet Angular 1 ou\ndémissionner comme un prince ?</p>\n<p><em>N.B. : Pour information, les bonnes réponses sont bien évidemment spaces, 2,\nsingle quotes, vim, flow, la démission</em></p>\n<p>C'est pour répondre à ce problème (enfin, ceux liés au formatage de votre code)\nque Go intègre un formatting tool (<code>fmt</code>, comme la commande Unix), intitulé\n<a href=\"https://golang.org/cmd/gofmt/\">gofmt</a>.</p>\n<ol>\n<li>Vous codez comme vous le sentez</li>\n<li>Vous sauvegardez votre fichier</li>\n<li>Votre code est automatiquement formaté</li>\n<li>Vous vous sentez frustré</li>\n<li>Très vite, vous vous rendez compte que c'est pour votre bien, et que perdre\ndu temps ou débattre sur ce genre de détails, c'est tout sauf utile</li>\n</ol>\n<p>Autre avantage non négligeable : le code Go que vous trouverez dans d'autres\npackages, des exemples, etc. sera toujours formaté de la même façon.</p>\n<p><em>À noter : Reason offre quelque chose de similaire avec\n<a href=\"https://facebook.github.io/reason/tools.html\">refmt</a>.</em></p>\n<p>Cette solution officielle n'existe pas en JS. Mais c'est ici qu'intervient\n<a href=\"https://github.com/prettier/prettier\">prettier</a> (et non\n<a href=\"https://www.npmjs.com/package/jsfmt\">jsfmt</a>, qui existe mais ne semble plus\nmaintenu), un projet relativement récent, en version <code>0.21</code> à l'heure où j'écris\nces lignes. Compatible <em>out of the box</em> avec le JS ES2017, JSX, flow, il offre\négalement le moins de configuration possible (ce qui est une bonne chose). Le\nprojet est activement suivi par Facebook, qui discute même la possibilité de\ns'en servir sur la codebase de\n<a href=\"https://github.com/facebook/react/pull/9101\">React</a>.</p>\n<h2>Comment ça fonctionne ?</h2>\n<p>Croyez-le ou non, ce n'est pas &quot;tellement&quot; complexe. À la manière de babel ou\nflow, prettier utilise un AST parser (Abstract Syntax Tree parser) afin\nd'analyser le contenu de votre fichier JS, suite à quoi il va simplement\nformater votre code sans tenir compte de la forme précédente, en ne gardant que\nce qui est important: le fond, pas la forme.</p>\n<p>Je vous invite à jouer avec <a href=\"https://astexplorer.net/\">AST explorer</a> pour\ncomprendre beaucoup plus simplement comment tout cela fonctionne.</p>\n<h2>Installation</h2>\n<pre><code class=\"hljs language-console\">npm install --save-dev prettier\n</code></pre>\n<p>Ou, pour les meilleurs d'entre vous :</p>\n<pre><code class=\"hljs language-console\">yarn add --dev prettier\n</code></pre>\n<p>¯\\<em>( ツ )</em>/¯</p>\n<h2>Configuration</h2>\n<p>Car oui, il y en a tout de même un peu. Il est possible de régler:</p>\n<ul>\n<li>La longueur maximale des lignes (<code>printWidth</code>, <code>80</code> caractères par défaut)</li>\n<li>Le nombre d'espaces pour l'indentation (<code>tabWidth</code>, <code>2</code> par défaut, pas de\ntabs)</li>\n<li>Single quotes / double quotes (<code>singleQuote</code>, <code>false</code> par défaut)</li>\n<li>S'il faut ajouter des virgules en fin de certaines structures (comme les\nobjets, mais aussi dans les paramètres de fonction, ce qui est possible depuis\npeu) (<code>trailingComma</code>, <code>none</code> par défaut, <code>es5</code> et <code>all</code> sont également\npossibles)</li>\n<li>S'il faut ajouter des espaces dans un objet écrit sur une seule ligne\n(<code>bracketSpacing</code>, <code>true</code> par défaut)</li>\n<li>Comment fermer les balises JSX (<code>jsxBracketSameLine</code>, <code>false</code> par défaut)</li>\n<li>Quel parser utiliser (<code>parser</code>, <code>babylon</code> par défaut, <code>flow</code> est disponible)</li>\n</ul>\n<blockquote>\n<p>Mais attends… Si l'on peut malgré tout configurer tout ça, ce n'est plus\nvraiment un style standard ?</p>\n</blockquote>\n<p>Oui et non, car il y aura toujours beaucoup de détails sur lesquels il nous sera\nimpossible de choisir, les options resteront minimalistes. Par exemple, vous ne\npourrez jamais retirer les points-virgules.</p>\n<p><code>EDIT: Il semblerait que malgré ce qui a pu être annoncé par l'auteur de prettier, une option --no-semicolons soit dans les tuyaux.</code></p>\n<p>Dans tous les cas, prettier reste un outil extrêmement pratique pour forcer le\nformatage du code au sein de votre équipe.</p>\n<p>Ouvrez votre <code>package.json</code>, c'est parti.</p>\n<pre><code class=\"hljs language-json\">{\n  <span class=\"hljs-attr\">&quot;scripts&quot;</span>: {\n    <span class=\"hljs-attr\">&quot;prettify&quot;</span>: <span class=\"hljs-string\">&quot;prettier src/**/*.js&quot;</span>\n  },\n  <span class=\"hljs-attr\">&quot;devDependencies&quot;</span>: {\n    <span class=\"hljs-attr\">&quot;prettier&quot;</span>: <span class=\"hljs-string\">&quot;^0.21.0&quot;</span>\n  }\n}\n</code></pre>\n<p><code>npm run prettify</code> ou <code>yarn run prettify</code> formateront automatiquement tous les\nfichiers <code>.js</code> contenus dans votre dossier <code>/src</code>. Bon j'avoue, c'est assez\nbasique comme usage. Ajoutons-y notre config préférée.</p>\n<pre><code class=\"hljs language-json\">{\n  <span class=\"hljs-attr\">&quot;scripts&quot;</span>: {\n    <span class=\"hljs-attr\">&quot;prettify&quot;</span>:\n      <span class=\"hljs-string\">&quot;prettier --single-quote --trailing-comma all --write &#x27;{src,__{tests,mocks}__}/**/*.js&#x27;&quot;</span>\n  },\n  <span class=\"hljs-attr\">&quot;devDependencies&quot;</span>: {\n    <span class=\"hljs-attr\">&quot;prettier&quot;</span>: <span class=\"hljs-string\">&quot;^0.21.0&quot;</span>\n  }\n}\n</code></pre>\n<p><code>npm run prettify</code> ou <code>yarn run prettify</code> formateront maintenant automatiquement\ntous les fichiers <code>.js</code> contenus dans vos dossiers <code>/src</code>, <code>__tests__</code> et\n<code>__mocks__</code>, en utilisant le parser de flow, préférant les single quotes et en\najoutant une virgule en fin de chaque structure possible.</p>\n<p>OK. Mais si un membre de l'équipe oublie d'exécuter le script avant de commiter\nson code ? <strong>We got this !</strong> (avec 2 dépendances de plus).</p>\n<pre><code class=\"hljs language-json\">{\n  <span class=\"hljs-attr\">&quot;scripts&quot;</span>: {\n    <span class=\"hljs-attr\">&quot;precommit&quot;</span>: <span class=\"hljs-string\">&quot;lint-staged&quot;</span>,\n    <span class=\"hljs-attr\">&quot;prettify&quot;</span>:\n      <span class=\"hljs-string\">&quot;prettier --single-quote --trailing-comma all --write &#x27;{src,__{tests,mocks}__}/**/*.js&#x27;&quot;</span>\n  },\n  <span class=\"hljs-attr\">&quot;lint-staged&quot;</span>: {\n    <span class=\"hljs-attr\">&quot;{src,__{tests,mocks}__}/**/*.js&quot;</span>: [\n      <span class=\"hljs-string\">&quot;prettier --single-quote --trailing-comma all --write&quot;</span>,\n      <span class=\"hljs-string\">&quot;git add&quot;</span>\n    ]\n  },\n  <span class=\"hljs-attr\">&quot;devDependencies&quot;</span>: {\n    <span class=\"hljs-attr\">&quot;husky&quot;</span>: <span class=\"hljs-string\">&quot;^0.13.2&quot;</span>,\n    <span class=\"hljs-attr\">&quot;lint-staged&quot;</span>: <span class=\"hljs-string\">&quot;^3.3.1&quot;</span>,\n    <span class=\"hljs-attr\">&quot;prettier&quot;</span>: <span class=\"hljs-string\">&quot;^0.21.0&quot;</span>\n  }\n}\n</code></pre>\n<h2>Les plugins</h2>\n<p>Si vous ne pouvez pas attendre le moment du commit pour admirer votre code\nfraichement formaté, il existe déjà pas mal de plugins, pour pas mal d'éditeurs\n: <code>prettier-atom</code>, <code>prettier-vscode</code>, <code>Jsprettier</code> (pour Sublime Text), mais\naussi pour emacs, vim, les IDE Jetbrain, etc. Tout est dans le\n<a href=\"https://github.com/prettier/prettier/blob/master/README.md\">README</a>.</p>\n<p><em>Protip: Inutile de vous conforter au style de formatage de votre équipe au sein\nde votre éditeur si le code est à nouveau formaté en pre-commit.</em></p>\n<h2>Quelques exemples, c'est possible ?</h2>\n<p>J'ai mieux. Il est possible\nd'<a href=\"https://prettier.github.io/prettier\">essayer en ligne</a> ! ✨</p>\n<h2>Donc c'est bon, tu conseilles ?</h2>\n<p>C'est tout de même à réfléchir. Le projet est encore jeune et en beta, même s'il\névolue extrêmement vite. Tout n'est pas encore parfaitement supporté, mais je\nvous rassure, si vous n'utilisez pas le flow-parser vous ne risquez pas de\nrencontrer beaucoup de problèmes avec la dernière version.</p>\n<p>Des projets tels que\n<a href=\"https://github.com/facebook/immutable-js/commit/9bcc8b54a17c3bbc94d70864121784bc91011e8f\">immutable-js</a>,\n<a href=\"https://github.com/necolas/react-native-web/commit/a2f25a46c495ca53a75e728cfb14dbdf67cdb342\">react-native-web</a>\net\n<a href=\"https://github.com/babel/babel/commit/bdbe2cfbc5ab5ba6f528b7ee3e4bf5ed940a47af\">babel</a>\ny sont déjà passés. Pourquoi pas vous ? 😉</p>\n"}}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"listsRequests":{"data":{"RE_PRIVATE_NONE":true}},"itemsRequests":{"data":{"RE_PRIVATE_NONE":true}}}</script><head><script defer="defer" src="/public/main.56c69761a03eb0112696.js"></script></head></html>