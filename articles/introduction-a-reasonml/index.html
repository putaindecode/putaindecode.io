<!DOCTYPE html><html lang="fr"><head><title data-react-helmet="true">Introduction √† ReasonML (ou pourquoi j&#x27;ai arr√™t√© d&#x27;utiliser JavaScript) | Putain de code</title><meta data-react-helmet="true" charset="UTF-8"/><meta data-react-helmet="true" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover" name="viewport"/><meta data-react-helmet="true" content="summary_large_image" name="twitter:card"/><meta data-react-helmet="true" content="Putain de code !" property="og:site_name"/><meta data-react-helmet="true" content="@putaindecode" name="twitter:site"/><meta data-react-helmet="true" content="https://putaindecode.io/public/images/website/share.jpg" property="og:image"/><meta data-react-helmet="true" content="https://putaindecode.io/public/images/website/share.jpg" name="twitter:image"/><meta data-react-helmet="true" content="1500" property="og:image:width"/><meta data-react-helmet="true" content="777" property="og:image:height"/><meta data-react-helmet="true" content="Introduction √† ReasonML (ou pourquoi j&#x27;ai arr√™t√© d&#x27;utiliser JavaScript) | Putain de code" property="og:title"/><meta data-react-helmet="true" content="Introduction √† ReasonML (ou pourquoi j&#x27;ai arr√™t√© d&#x27;utiliser JavaScript) | Putain de code" name="twitter:title"/><meta data-react-helmet="true" content="Un article propos√© par bloodyowl" name="description"/><link data-react-helmet="true" title="RSS Feed" href="/api/articles/feeds/desc/feed.xml" rel="alternate" type="application/rss+xml"/><link data-react-helmet="true" href="/favicon.ico" rel="shortcut icon"/><link data-react-helmet="true" href="https://putaindecode.io/articles/introduction-a-reasonml" rel="canonical"/><script>window.PAGES_BOOT_MODE="hydrate";</script></head><div id="root"><style data-emotion="rpcss zx73cm 1lc6tyj 28v1b4">@-webkit-keyframes animation-zx73cm{from{opacity:0;-webkit-transform:translateY(20px);-moz-transform:translateY(20px);-ms-transform:translateY(20px);transform:translateY(20px);}}@keyframes animation-zx73cm{from{opacity:0;-webkit-transform:translateY(20px);-moz-transform:translateY(20px);-ms-transform:translateY(20px);transform:translateY(20px);}}:root{--page-background-color:#fff;--page-slightly-accented-background-color:#F9F6F6;--page-accented-background-color:#E4EBEE;--page-text-color:#46515B;--link-text-color:#E51D58;--gradient-red-top:#E51D58;--gradient-red-bottom:#CC0613;--code-background-color:#FAF3E1;--one-percent-contrast-color:rgba(0, 0, 0, 0.1);--half-percent-contrast-color:rgba(0, 0, 0, 0.05);}@media (prefers-color-scheme: dark){:root{--page-background-color:#222;--page-slightly-accented-background-color:#171717;--page-accented-background-color:#111;--page-text-color:#ddd;--link-text-color:#F87098;--gradient-red-top:#E51D58;--gradient-red-bottom:#CC0613;--code-background-color:#4F3804;--one-percent-contrast-color:rgba(255, 255, 255, 0.1);--half-percent-contrast-color:rgba(255, 255, 255, 0.05);}}body{padding:0;margin:0;background-color:var(--page-background-color);color:var(--page-text-color);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;overflow-x:hidden;}html{font-size:1em;line-height:1.4;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%;}a{color:var(--link-text-color);-webkit-text-decoration:underline;text-decoration:underline;}a:hover{-webkit-text-decoration:none;text-decoration:none;}#root{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}*,*:before,*:after{box-sizing:border-box;}pre,.hljs{color:#adbac7;background:#22272e;}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#f47067;}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#dcbdfb;}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-variable,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id{color:#6cb6ff;}.hljs-regexp,.hljs-string,.hljs-meta .hljs-string{color:#96d0ff;}.hljs-built_in,.hljs-symbol{color:#f69d50;}.hljs-comment,.hljs-code,.hljs-formula{color:#768390;}.hljs-name,.hljs-quote,.hljs-selector-tag,.hljs-selector-pseudo{color:#8ddb8c;}.hljs-subst{color:#adbac7;}.hljs-section{color:#316dca;font-weight:bold;}.hljs-bullet{color:#eac55f;}.hljs-emphasis{color:#adbac7;font-style:italic;}.hljs-strong{color:#adbac7;font-weight:bold;}.hljs-addition{color:#b4f1b4;background-color:#1b4721;}.hljs-deletion{color:#ffd8d3;background-color:#78191b;}</style><style data-emotion="rpcss 9vhaby">.rpcss-9vhaby{background-color:var(--gradient-red-bottom);background-image:linear-gradient(to bottom right, var(--gradient-red-top), var(--gradient-red-bottom));}</style><header class="rpcss-9vhaby" style="background-image:linear-gradient(to bottom right, hsl(235, 100%, 35%), hsl(195, 100%, 30%))"><style data-emotion="rpcss 1qqk0tr">.rpcss-1qqk0tr{padding-left:env(safe-area-inset-left);padding-right:env(safe-area-inset-right);}</style><div class="rpcss-1qqk0tr"><style data-emotion="rpcss qx7dny">.rpcss-qx7dny{width:100%;max-width:1024px;margin:0 auto;padding:0 10px;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;}</style><div class="rpcss-qx7dny"><style data-emotion="rpcss 7s9om2">.rpcss-7s9om2{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding:20px 0 50px;}</style><div class="rpcss-7s9om2"><style data-emotion="rpcss gdpa5c">.rpcss-gdpa5c{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-text-decoration:none;text-decoration:none;}</style><a class="rpcss-gdpa5c" href="/"><style data-emotion="rpcss 1lm4738">.rpcss-1lm4738{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-text-decoration:none;text-decoration:none;padding-bottom:10px;}</style><div class="rpcss-1lm4738"><style data-emotion="rpcss 13o7eu2">.rpcss-13o7eu2{display:block;}</style><svg class="rpcss-13o7eu2" height="36px" width="36px" viewBox="0 0 36 36"><defs><linearGradient id="PutainDeCodeLogoGradient" x1="50%" x2="50%" y1="0%" y2="127.223881%"><stop offset="0%" stop-color="#E41D57"></stop><stop offset="100%" stop-color="#C60000"></stop></linearGradient></defs><circle cx="18" cy="18" fill="url(#PutainDeCodeLogoGradient)" r="17" stroke="#FFFFFF" stroke-width="2"></circle><polygon fill="#FFFFFF" points="15.9033203 18.2246094 15.9033203 18.3710938 11.2304688 20.5317383 11.2304688 22.8095703 18.0566406 19.184082 18.0566406 17.4116211 11.2304688 13.7788086 11.2304688 16.0639648"></polygon><rect height="14" width="2" fill="#FFFFFF" x="22" y="11"><animate attributeName="opacity" begin="100ms" calcMode="discrete" dur="2s" repeatCount="indefinite" values="1;0"></animate></rect></svg><style data-emotion="rpcss 4cf197">.rpcss-4cf197{width:10px;height:10px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}</style><div class="rpcss-4cf197"></div><style data-emotion="rpcss u5k24">.rpcss-u5k24{font-size:22px;color:#fff;font-weight:800;}</style><div aria-level="2" class="rpcss-u5k24" role="heading">Putain de code !</div></div><style data-emotion="rpcss 1nyebg4">.rpcss-1nyebg4{font-size:14px;color:rgba(255, 255, 255, 0.8);text-align:center;}</style><div class="rpcss-1nyebg4">Blog participatif de la communaut√© dev</div></a></div></div></div></header><style data-emotion="rpcss a4ric9">.rpcss-a4ric9{background-color:var(--page-slightly-accented-background-color);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}</style><div class="rpcss-a4ric9"><style data-emotion="rpcss oeugsb">.rpcss-oeugsb{-webkit-animation:500ms ease-out animation-zx73cm;animation:500ms ease-out animation-zx73cm;}</style><div class="rpcss-oeugsb"><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 1qc2bam">.rpcss-1qc2bam{font-size:42px;font-weight:800;text-align:center;padding-top:40px;line-height:1.2;margin:0;}</style><h1 class="rpcss-1qc2bam">Introduction √† ReasonML (ou pourquoi j&#x27;ai arr√™t√© d&#x27;utiliser JavaScript)</h1><style data-emotion="rpcss obg2kr">.rpcss-obg2kr{font-size:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding-top:10px;padding-bottom:40px;color:var(--page-text-color);-webkit-text-decoration:none;text-decoration:none;}</style><a class="rpcss-obg2kr" href="https://github.com/bloodyowl"><style data-emotion="rpcss uco8i7">.rpcss-uco8i7{width:32px;height:32px;border-radius:100%;margin-right:10px;}</style><img class="rpcss-uco8i7" alt="bloodyowl" src="https://avatars.githubusercontent.com/bloodyowl?size=64"/><div>bloodyowl<!-- --> <!-- -->‚Ä¢<!-- --> <!-- -->2017/10/02</div></a><style data-emotion="rpcss 15kxmi0">.rpcss-15kxmi0{max-width:640px;width:100%;font-size:18px;margin:0 auto;line-height:1.7;}.rpcss-15kxmi0 h2,.rpcss-15kxmi0 h3,.rpcss-15kxmi0 h4,.rpcss-15kxmi0 h5,.rpcss-15kxmi0 h6{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;font-weight:800;line-height:1.2;}.rpcss-15kxmi0 img{max-width:100%;background-color:rgba(255, 255, 255, 0.75);}.rpcss-15kxmi0 code{font-size:0.9em;font-family:PragmataPro,SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;line-height:1;background-color:var(--code-background-color);margin:0 0.2em;}.rpcss-15kxmi0 pre{padding:10px;overflow-x:auto;font-size:14px;border-radius:10px;border:2px solid var(--one-percent-contrast-color);-webkit-overflow-scrolling:touch;}.rpcss-15kxmi0 pre code{font-size:14px;background-color:transparent;margin:0;}.rpcss-15kxmi0 blockquote{padding-left:20px;margin:0;font-size:16px;border-left:3px solid var(--one-percent-contrast-color);font-style:italic;}.rpcss-15kxmi0 table{width:100%;text-align:center;}.rpcss-15kxmi0 figure{padding:20px 0;}.rpcss-15kxmi0 figcaption{text-align:center;}.rpcss-15kxmi0 a{word-wrap:break-word;}.rpcss-15kxmi0 table thead th{background-color:var(--page-accented-background-color);padding:10px 0;}</style><div class="rpcss-15kxmi0"><p>Les bugs c'est chiant, surtout quand on sait qu'on aurait pu les √©viter. Avec
JavaScript, c'est plus facile d'en avoir que de les √©viter.</p>
<p>JavaScript, on ne peut pas y √©chapper parce que c'est partout, parce que c'est
le langage de programmation le plus utilis√© sur Terre, et parce que c'est le
seul truc qui (pour l'instant) tourne nativement dans le navigateur. Et puis
c'est pas si mal, c'est facile de l'apprendre en bidouillant un peu, c'est tr√®s
permissif et pas trop frustrant pour d√©buter.</p>
<p>Le probl√®me c'est que c'est facile d'en faire, mais c'est tr√®s dur d'en faire
<strong>bien</strong> (moins que CSS, mais quand m√™me). On s'est tous d√©j√† retrouv√© avec
<code>undefined is not a function</code>, <code>null is not an object</code> ou un bon gros
<code>[object Object]</code> qui tra√Æne dans la console.</p>
<h2>Pourquoi est-ce que c'est comme √ßa ?</h2>
<p>JavaScript est un langage dynamiquement et faiblement typ√©, ce qui veut dire :</p>
<ul>
<li>qu'une fonction ne sait pas ce qu'elle prend ou retourne comme type
d'arguments, c'est √† vous de g√©rer</li>
<li>que le programme n'en a aucune id√©e non plus tant qu'il n'execute pas la
portion de code</li>
</ul>
<p>Tout √ßa fait qu'il est tr√®s difficile de faire confiance √† du code JavaScript.</p>
<figure>
<img src="/public/images/articles/2017-10-02-introduction-a-reasonml/js.png" alt="js" />
<figcaption>Source: MIT</figcaption>
</figure>
<p>Il existe Flow et TypeScript (dont on a parl√© dans un
<a href="/fr/articles/js/flow/">pr√©c√©dent article</a> et un
<a href="fr/articles/podcast/3/">podcast</a>), deux projets qui permettent d'apporter du
typage statique pour s√©curiser son code. Ils contraignent votre usage de
JavaScript, mais devront toujours se battre contre sa permissivit√©.</p>
<p>√áa revient au final √† coller des rustines sur vos pneus avant d'aller rouler sur
des clous, √ßa va vous prot√©ger un peu, mais √ßa reste de base pas bien malin
d'aller rouler sur des clous.</p>
<p>Il existe des langages qui ont la judicieuse id√©e de balayer la route pour virer
les clous avant d'y aller : les langages typ√©s fortement et statiquement (10
points pour Gryffondor pour cette m√©taphore fil√©e).</p>
<p>OCaml est un de ces langages. Il est de la famille ML et a √©t√© cr√©√© en France
dans les ann√©es 90. Il est √† peu pr√®s aussi √¢g√© que JavaScript mais est beaucoup
plus sage. Il est certes fortement et statiquement typ√©, mais il inf√®re la
plupart des types du programme (ce qui veut dire que vous n'avez pas √†
renseigner les types partout, il va l'extrapoler d√®s qu'il le peut). En bonus,
il poss√®de de
<a href="https://ocaml.org/learn/tutorials/comparison_of_standard_containers.html">bonnes data-structures</a>.</p>
<p>Seulement voil√†, OCaml, comme beaucoup de langages fonctionnels n'a pas vraiment
mis l'accent sur l'accessibilit√© pour les d√©butants, et a une syntaxe qu'on peut
pour le moins qualifier de pas tr√®s friendly: elle n'a rien de bien mal, mais
mettez quelqu'un qui vient de JS/PHP/Java devant, √ßa va pas lui causer des
masses:</p>
<pre><code class="hljs language-ocaml"><span class="hljs-keyword">let</span> <span class="hljs-keyword">rec</span> qsort = <span class="hljs-keyword">fun</span> <span class="hljs-keyword">value</span> -&gt;
  <span class="hljs-keyword">match</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">with</span>
   | <span class="hljs-literal">[]</span> -&gt; <span class="hljs-literal">[]</span>
   | pivot :: rest -&gt;
       <span class="hljs-keyword">let</span> is_less x = x &lt; pivot <span class="hljs-keyword">in</span>
       <span class="hljs-keyword">let</span> left, right = <span class="hljs-type">List</span>.partition is_less rest <span class="hljs-keyword">in</span>
       qsort left @ [pivot] @ qsort right;;
</code></pre>
<figure>
<img src="/public/images/articles/2017-10-02-introduction-a-reasonml/giphy.gif" alt="" />
<figcaption>fig. 1: dev JS devant du code OCaml</figcaption>
</figure>
<p>C'est l√† qu'intervient Reason, un projet initi√© par
<a href="https://twitter.com/jordwalke">le cr√©ateur de React</a>. Les premi√®res it√©rations
de React √©taient d'ailleurs cod√©es dans un langage cousin de OCaml, le SML.</p>
<p>C'est en gros:</p>
<ul>
<li>OCaml</li>
<li>avec une syntaxe <em>beginner-friendly</em></li>
<li>avec un tooling le rendant plus simple √† utiliser</li>
<li>qui peut compiler vers JavaScript et de multiples plateformes</li>
</ul>
<p>Avec son type system, OCaml propose un langage <em>safe-by-design</em>, chose que m√™me
avec une palanqu√©e d'outils, on ne peut pas atteindre avec JavaScript.</p>
<p>Le langage propose par d√©faut une approche fonctionnelle et immutable, mais
permet cependant de choisir d'utiliser des structures mutables et de l'orient√©
objet au besoin.</p>
<h2>Le langage</h2>
<p>Reason comporte plus de types de primitifs que JavaScript:</p>
<pre><code class="hljs language-reason"><span class="hljs-comment">/* pas un gros &quot;number&quot; fourre tout, magique */</span>
<span class="hljs-number">1</span>; <span class="hljs-comment">/* int */</span>
<span class="hljs-number">1.0</span>; <span class="hljs-comment">/* float */</span>
<span class="hljs-comment">/* un caract√®re est d&#x27;un type diff√©rent de string */</span>
<span class="hljs-string">&quot;foo&quot;</span>; <span class="hljs-comment">/* string */</span>
<span class="hljs-character">&#x27;a&#x27;</span>; <span class="hljs-comment">/* char */</span>
<span class="hljs-comment">/* on trouve list ET array, chacun peut √™tre utilis√© pour diff√©rents cas */</span>
<span class="hljs-literal">[</span><span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span><span class="hljs-literal">]</span>; <span class="hljs-comment">/* list */</span>
<span class="hljs-literal">[|</span> <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span> <span class="hljs-literal">|]</span>; <span class="hljs-comment">/* array */</span>
<span class="hljs-comment">/* pas de null, mais des valeurs de type `option` qui contiennent
  soit une valeur, soit rien */</span>
<span class="hljs-constructor">Some</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">/* option int */</span>
<span class="hljs-constructor">None</span>; <span class="hljs-comment">/* option int */</span>
</code></pre>
<p>Puisqu'il est fortement typ√©, il est impossible de mixer les types comme en
JavaScript, vous devrez obligatoirement les convertir:</p>
<pre><code class="hljs language-reason"><span class="hljs-number">1</span> <span class="hljs-operator">+</span> <span class="hljs-number">1.0</span>;
<span class="hljs-comment">/* Error:
  This expression has type int but an expression was expected of type float */</span>
<span class="hljs-number">1</span> <span class="hljs-operator">+</span> int_of_float(<span class="hljs-number">1.0</span>);
<span class="hljs-comment">/* - : int = 2 */</span>
</code></pre>
<p>La plupart des op√©rations de transformations de type primitifs vers un autre
sont accessibles dans le module <code>Pervasives</code> qui contient plein de petits
utilitaires bien pratiques. Toutes les fonctions de ce module sont accessibles
directement dans n'importe quel de vos fichiers.</p>
<p>Les fonctions de Reason sont beaucoup plus puissantes qu'en JavaScript:</p>
<pre><code class="hljs language-reason"><span class="hljs-keyword">let</span> add = (a, b) =&gt; a <span class="hljs-operator">+</span> b;
<span class="hljs-comment">/* int =&gt; int =&gt; int */</span>
add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
<span class="hljs-comment">/* 3 */</span>
add(<span class="hljs-number">1</span>, <span class="hljs-number">2.0</span>);
<span class="hljs-comment">/* This expression has type float but an expression was expected of type int */</span>

<span class="hljs-comment">/* Les fonctions sont &quot;auto-curried&quot;, ce qui signifie qu&#x27;une fonction
   qui n&#x27;a pas re√ßu tous ses param√®tres retourne une nouvelle fonction
  qui va recevoir les param√®tres manquants */</span>
<span class="hljs-keyword">let</span> addOne = add(<span class="hljs-number">1</span>);
<span class="hljs-comment">/* int =&gt; int */</span>

<span class="hljs-comment">/* Les fonctions peuvent avoir des param√®tres nomm√©s, optionnels et avec des valeurs par d√©faut */</span>
<span class="hljs-keyword">let</span> sayHi = (~name, ~punct=<span class="hljs-string">&quot;!&quot;</span>, ()) =&gt; <span class="hljs-string">&quot;Hello &quot;</span> <span class="hljs-operator">++</span> name <span class="hljs-operator">++</span> punct;
<span class="hljs-comment">/* name::string =&gt; string */</span>
sayHi(~name=<span class="hljs-string">&quot;you&quot;</span>, ());
<span class="hljs-comment">/* &quot;Hello you!&quot; */</span>
<span class="hljs-comment">/* L&#x27;ordre des arguments nomm√©s n&#x27;a pas d&#x27;importance*/</span>
sayHi(~punct=<span class="hljs-string">&quot;?&quot;</span>, ~name=<span class="hljs-string">&quot;you&quot;</span>, ());
<span class="hljs-comment">/* &quot;Hello you?&quot; */</span>
</code></pre>
<p>Pour d√©finir l'√©quivalent d'un <em>plain-object</em> JavaScript en Reason, on utilise
des records:</p>
<pre><code class="hljs language-reason"><span class="hljs-comment">/* On doit typer les records */</span>
<span class="hljs-keyword">type</span> user = {
  username: string,
  age: int
};

<span class="hljs-comment">/* Les records ont un nombre de cl√©s fini, vous ne pouvez pas en
  ommettre une ou en mettre une en trop */</span>
<span class="hljs-keyword">let</span> user = { username: <span class="hljs-string">&quot;Bob&quot;</span> };
<span class="hljs-comment">/* Error: Some record fields are undefined: age */</span>

<span class="hljs-keyword">let</span> user = { username: <span class="hljs-string">&quot;Bob&quot;</span>, age: <span class="hljs-number">20</span> };

<span class="hljs-comment">/* Les records sont immutables par d√©faut */</span>
<span class="hljs-keyword">let</span> olderUser = {<span class="hljs-operator">...</span>user, age: user.age <span class="hljs-operator">+</span> <span class="hljs-number">1</span> };
</code></pre>
<p>Reason poss√®de un syst√®me de module tr√®s puissant: par d√©faut, chaque fichier de
votre codebase est un module, mais vous pouvez √©galement d√©clarer des modules
<em>dans</em> un module.</p>
<pre><code class="hljs language-reason"><span class="hljs-keyword">module</span> <span class="hljs-module-identifier">User</span> = {
  <span class="hljs-keyword">type</span> t = {
    id: string,
    username: string,
    email: option(string)
  };
  <span class="hljs-keyword">let</span> make = (~id, ~username, ~email) =&gt; {id, username, email};
  <span class="hljs-keyword">let</span> sayHi = (user) =&gt; <span class="hljs-string">&quot;Hello &quot;</span> <span class="hljs-operator">++</span> user.username <span class="hljs-operator">++</span> <span class="hljs-string">&quot;!&quot;</span>;
};

<span class="hljs-comment">/* Pour utiliser un module, tapez son nom, tout simplement */</span>
<span class="hljs-module-identifier">User</span>.make(~id=<span class="hljs-string">&quot;0&quot;</span>, ~username=<span class="hljs-string">&quot;bloodyowl&quot;</span>, ~email=<span class="hljs-constructor">None</span>)
  <span class="hljs-comment">/* (ah oui, le pipe existe d√©j√† ici, pas besoin d&#x27;attendre ES2050)*/</span>
  <span class="hljs-operator">|&gt;</span> <span class="hljs-module-identifier">User</span>.sayHi
  <span class="hljs-operator">|&gt;</span> print_endline;
<span class="hljs-comment">/* &quot;Hello bloodyowl&quot; */</span>

<span class="hljs-comment">/* On peut √©galement rendre toutes les valeurs d&#x27;un module accessibles localement */</span>
<span class="hljs-module-identifier">User</span>.(
  make(~id=<span class="hljs-string">&quot;0&quot;</span>, ~username=<span class="hljs-string">&quot;bloodyowl&quot;</span>, ~email=<span class="hljs-constructor">None</span>)
    <span class="hljs-operator">|&gt;</span> sayHi
    <span class="hljs-operator">|&gt;</span> print_endline
);

<span class="hljs-comment">/* Carr√©ment les rendre accessibles globalement dans le module */</span>
<span class="hljs-keyword">open</span> <span class="hljs-module-identifier">User</span>;

make(~id=<span class="hljs-string">&quot;0&quot;</span>, ~username=<span class="hljs-string">&quot;bloodyowl&quot;</span>, ~email=<span class="hljs-constructor">None</span>)
  <span class="hljs-operator">|&gt;</span> sayHi
  <span class="hljs-operator">|&gt;</span> print_endline;

<span class="hljs-comment">/* Ou m√™me √©tendre un module statiquement et proprement,
  √ßa vous parle √ßa, Prototype et MooTools ?! */</span>
<span class="hljs-keyword">module</span> <span class="hljs-module-identifier">UserThatCanSayBye</span> = {
  <span class="hljs-keyword">include</span> <span class="hljs-module-identifier">User</span>;
  <span class="hljs-keyword">let</span> sayBye = (user) =&gt; <span class="hljs-string">&quot;Bye &quot;</span> <span class="hljs-operator">++</span> user.username <span class="hljs-operator">++</span> <span class="hljs-string">&quot;!&quot;</span>;
};
</code></pre>
<p>Il existe √©galement des functors, qui sont des sortes de fonctions retournant
des modules √† partir d'autres modules, mais on ne l'abordera pas dans cet
article.</p>
<p>Reason poss√®de √©galement des variants, il s'agit de types pouvant avoir
diff√©rents cas. Prenons l'exemple d'un message de chat:</p>
<pre><code class="hljs language-reason"><span class="hljs-keyword">type</span> image = {url: string, width: int, height: int};

<span class="hljs-comment">/* chaque cas du variant peut prendre des param√®tres */</span>
<span class="hljs-keyword">type</span> message =
  | <span class="hljs-constructor">String</span>(string) <span class="hljs-comment">/* soit une cha√Æne de caract√®res */</span>
  | <span class="hljs-constructor">Image</span>(image) <span class="hljs-comment">/* soit une image */</span>
  | <span class="hljs-constructor">Emoji</span>(string); <span class="hljs-comment">/* soit un gros emoji */</span>

<span class="hljs-keyword">let</span> stringMessage = <span class="hljs-constructor">String</span>(<span class="hljs-string">&quot;Hello&quot;</span>); <span class="hljs-comment">/* On cr√©e la valeur avec son constructeur */</span>
<span class="hljs-keyword">let</span> imageMessage = <span class="hljs-constructor">Image</span>({url: <span class="hljs-string">&quot;https://fakeimg.pl/300x300&quot;</span>, width: <span class="hljs-number">300</span>, height: <span class="hljs-number">300</span>});
<span class="hljs-keyword">let</span> emojiMessage = <span class="hljs-constructor">Emoji</span>(<span class="hljs-string">{js|üê´|js}</span>); <span class="hljs-comment">/* Quand la string contient de caract√®res unicode,
  on doit utiliser {js|votre string|js} */</span>
</code></pre>
<p>Ici, notre type <code>message</code> est bien d√©limit√©, et ses valeurs ne peuvent √™tre que
celles que l'on a d√©fini.</p>
<p>Pour utiliser les valeurs d'un variant, on peut les extraire √† l'aide de
<code>switch</code>, qui va <em>pattern-matcher</em> pour nous permettre d'identifier et
d'extraire les valeurs.</p>
<pre><code class="hljs language-reason"><span class="hljs-comment">/* Petit bonus, l&#x27;exemple utilise ReasonReact, mais on d√©taillera √ßa dans un prochain article */</span>
<span class="hljs-keyword">let</span> component = <span class="hljs-module-identifier">ReasonReact</span>.statelessComponent(<span class="hljs-string">&quot;ChatMessage&quot;</span>);

<span class="hljs-keyword">let</span> make = (~message, _children) =&gt; {
  <span class="hljs-operator">...</span>component,
  render: (_) =&gt;
    &lt;div&gt;
      (<span class="hljs-keyword">switch</span> message {
        | <span class="hljs-constructor">String</span>(value) =&gt; <span class="hljs-module-identifier">ReasonReact</span>.stringToElement(value)
        | <span class="hljs-constructor">Image</span>({url: src, width, height}) =&gt; &lt;img width height src /&gt;
        <span class="hljs-comment">/* Si par m√©garde j&#x27;oublie un cas possible dans un switch, je vais avoir un joli warning du
          compiler qui me dira:
            This pattern-matching is not exhaustive.
            Here is an example of a value that is not matched:
              Emoji
        */</span>
        | <span class="hljs-constructor">Emoji</span>(value) =&gt;
          &lt;div style=(<span class="hljs-module-identifier">ReactDOMRe</span>.<span class="hljs-module-identifier">Style</span>.make(~fontSize=<span class="hljs-string">&quot;40px&quot;</span>, ()))&gt;
            (<span class="hljs-module-identifier">ReasonReact</span>.stringToElement(value))
          &lt;/div&gt;
      })
    &lt;/div&gt;
};
</code></pre>
<p>En Reason, les <em>let bindings</em> ont automatiquement le block parent comme scope,
on peut du coup √©crire des choses comme ceci :</p>
<pre><code class="hljs language-reason"><span class="hljs-keyword">let</span> value = {
  <span class="hljs-keyword">let</span> a = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">let</span> b = <span class="hljs-number">2</span>;
  a <span class="hljs-operator">+</span> b; <span class="hljs-comment">/* la derni√®re expression est toujours retourn√©e par d√©faut */</span>
};
<span class="hljs-comment">/* let value : int = 3 */</span>
a
<span class="hljs-comment">/* Error: Unbound value a */</span>
</code></pre>
<p>Voil√† pour l'introduction √† ReasonML, pour en d√©couvrir un peu plus je vous
invite √† aller lire la <a href="https://reasonml.github.io/">documentation officielle</a>.
On verra dans les prochains articles comment fonctionne
<a href="https://reasonml.github.io/reason-react">ReasonReact</a> (les bindings Reason vers
React, avec quelques petites features sympathiques en plus), et comment
l'adopter incr√©mentalement dans sa codebase pour avoir du code plus s√ªr, et
<em>(spoilers)</em>, plus rapide que si vous l'√©criviez √† la main.</p>
<p>Bisous bisous.</p>
</div><style data-emotion="rpcss unyj6i">.rpcss-unyj6i{max-width:640px;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin:20px auto;padding:20px;background-color:var(--page-background-color);border-radius:10px;box-shadow:0 15px 15px -5px rgba(0, 0, 0, 0.2);}@media (max-width: 540px){.rpcss-unyj6i{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><div class="rpcss-unyj6i"><style data-emotion="rpcss ty7r4z">.rpcss-ty7r4z{font-weight:800;}</style><div class="rpcss-ty7r4z">Vous avez aim√© cet article?</div><style data-emotion="rpcss klacsp">.rpcss-klacsp{width:0;height:10px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}</style><div class="rpcss-klacsp"></div><style data-emotion="rpcss 1pkr03v">.rpcss-1pkr03v{background-color:#00aced;color:#fff;padding:10px 20px;-webkit-text-decoration:none;text-decoration:none;border-radius:5px;font-weight:800;}.rpcss-1pkr03v:active{opacity:0.5;}</style><a class="rpcss-1pkr03v" href="https://www.twitter.com/intent/tweet?text=Introduction%20%C3%A0%20ReasonML%20(ou%20pourquoi%20j&#x27;ai%20arr%C3%AAt%C3%A9%20d&#x27;utiliser%20JavaScript)%20sur%20%40PutainDeCode%20https%3A%2F%2Fputaindecode.io%2Farticles%2Fintroduction-a-reasonml" target="_blank">Le partager sur Twitter</a></div><style data-emotion="rpcss x4iqxe">.rpcss-x4iqxe{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;text-align:center;padding:20px;}</style><div class="rpcss-x4iqxe"><style data-emotion="rpcss gein6x">.rpcss-gein6x{font-size:20px;-webkit-text-decoration:none;text-decoration:none;color:#1E49B5;}</style><a class="rpcss-gein6x" href="/articles">‚Üê Articles</a></div><style data-emotion="rpcss 8bodgl">.rpcss-8bodgl{max-width:640px;width:100%;margin:0 auto;padding:20px 0;}</style><div class="rpcss-8bodgl" id="disqus_thread"></div></div></div></div></div><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 1vau6rl">.rpcss-1vau6rl{margin:20px 0;background-color:var(--page-accented-background-color);border-radius:10px;padding:20px;}</style><div class="rpcss-1vau6rl"><style data-emotion="rpcss 1gz1i1h">.rpcss-1gz1i1h{font-size:32px;font-weight:800;margin-bottom:20px;text-align:center;}</style><div aria-level="2" class="rpcss-1gz1i1h" role="heading">Ne rien rater</div><style data-emotion="rpcss 1wbispj">.rpcss-1wbispj{font-size:18px;margin-bottom:10px;text-align:center;}</style><div aria-level="3" class="rpcss-1wbispj" role="heading">Sur les r√©seaux</div><style data-emotion="rpcss 1hyoz7m">.rpcss-1hyoz7m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;}</style><div class="rpcss-1hyoz7m"><a href="https://twitter.com/PutainDeCode"><img alt="Twitter" height="48" src="/public/images/website/twitter.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://facebook.com/putaindecode"><img alt="Facebook" height="48" src="/public/images/website/facebook.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://github.com/putaindecode"><img alt="Facebook" height="48" src="/public/images/website/github.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://itunes.apple.com/fr/podcast/putain-de-code-!/id1185311825"><img alt="Apple Podcast" height="48" src="/public/images/website/apple-podcast.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://soundcloud.com/putaindecode"><img alt="Soundcloud" height="48" src="/public/images/website/soundcloud.svg" width="48"/></a></div><div aria-level="3" class="rpcss-1wbispj" role="heading">Sur le chat</div><div class="rpcss-1hyoz7m"><a href="https://discord.gg/jtbGNNc"><img alt="Discord" height="48" src="/public/images/website/discord.svg" width="48"/></a></div></div></div></div><style data-emotion="rpcss zs8kw7">.rpcss-zs8kw7{background-color:#222;padding:20px 0;}</style><footer class="rpcss-zs8kw7"><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 79elbk">.rpcss-79elbk{position:relative;}</style><div class="rpcss-79elbk"><style data-emotion="rpcss 1hle0ni">.rpcss-1hle0ni{position:absolute;left:0;top:50%;color:#fff;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="rpcss-1hle0ni" href="/api/articles/feeds/desc/feed.xml"><style data-emotion="rpcss lvyu5j">.rpcss-lvyu5j{margin-right:10px;}</style><img class="rpcss-lvyu5j" alt="Flux RSS" height="16" src="/public/images/website/rss-feed.svg" width="16"/><style data-emotion="rpcss um3i31">@media (max-width: 400px){.rpcss-um3i31{display:none;}}</style><div class="rpcss-um3i31">Flux RSS</div></a><style data-emotion="rpcss 12cp4l7">.rpcss-12cp4l7{color:rgba(255, 255, 255, 0.5);text-align:center;font-size:14px;}</style><div class="rpcss-12cp4l7">¬© 2021 Putain de code !</div><style data-emotion="rpcss 1w98uy3">.rpcss-1w98uy3{position:absolute;right:0;top:50%;color:#fff;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="rpcss-1w98uy3" href="https://github.com/putaindecode/putaindecode.io">GitHub</a></div></div></div></footer></div><script id="initialData" type="text/data">{"lists":{"RE_PRIVATE_NONE":true},"items":{"k":"articles","v":{"k":"introduction-a-reasonml","v":{"_0":{"TAG":0,"_0":{"slug":"introduction-a-reasonml","filename":"2017-10-02-introduction-a-reasonml","title":"Introduction √† ReasonML (ou pourquoi j'ai arr√™t√© d'utiliser JavaScript)","date":"Mon, 02 Oct 2017 00:00:00 GMT","draft":false,"meta":{"date":"2017-10-02T00:00:00.000Z","title":"Introduction √† ReasonML (ou pourquoi j'ai arr√™t√© d'utiliser JavaScript)","author":"bloodyowl","oldSlug":"reason/introduction-reason","slug":"introduction-a-reasonml"},"body":"<p>Les bugs c'est chiant, surtout quand on sait qu'on aurait pu les √©viter. Avec\nJavaScript, c'est plus facile d'en avoir que de les √©viter.</p>\n<p>JavaScript, on ne peut pas y √©chapper parce que c'est partout, parce que c'est\nle langage de programmation le plus utilis√© sur Terre, et parce que c'est le\nseul truc qui (pour l'instant) tourne nativement dans le navigateur. Et puis\nc'est pas si mal, c'est facile de l'apprendre en bidouillant un peu, c'est tr√®s\npermissif et pas trop frustrant pour d√©buter.</p>\n<p>Le probl√®me c'est que c'est facile d'en faire, mais c'est tr√®s dur d'en faire\n<strong>bien</strong> (moins que CSS, mais quand m√™me). On s'est tous d√©j√† retrouv√© avec\n<code>undefined is not a function</code>, <code>null is not an object</code> ou un bon gros\n<code>[object Object]</code> qui tra√Æne dans la console.</p>\n<h2>Pourquoi est-ce que c'est comme √ßa ?</h2>\n<p>JavaScript est un langage dynamiquement et faiblement typ√©, ce qui veut dire :</p>\n<ul>\n<li>qu'une fonction ne sait pas ce qu'elle prend ou retourne comme type\nd'arguments, c'est √† vous de g√©rer</li>\n<li>que le programme n'en a aucune id√©e non plus tant qu'il n'execute pas la\nportion de code</li>\n</ul>\n<p>Tout √ßa fait qu'il est tr√®s difficile de faire confiance √† du code JavaScript.</p>\n<figure>\n<img src=\"/public/images/articles/2017-10-02-introduction-a-reasonml/js.png\" alt=\"js\" />\n<figcaption>Source: MIT</figcaption>\n</figure>\n<p>Il existe Flow et TypeScript (dont on a parl√© dans un\n<a href=\"/fr/articles/js/flow/\">pr√©c√©dent article</a> et un\n<a href=\"fr/articles/podcast/3/\">podcast</a>), deux projets qui permettent d'apporter du\ntypage statique pour s√©curiser son code. Ils contraignent votre usage de\nJavaScript, mais devront toujours se battre contre sa permissivit√©.</p>\n<p>√áa revient au final √† coller des rustines sur vos pneus avant d'aller rouler sur\ndes clous, √ßa va vous prot√©ger un peu, mais √ßa reste de base pas bien malin\nd'aller rouler sur des clous.</p>\n<p>Il existe des langages qui ont la judicieuse id√©e de balayer la route pour virer\nles clous avant d'y aller : les langages typ√©s fortement et statiquement (10\npoints pour Gryffondor pour cette m√©taphore fil√©e).</p>\n<p>OCaml est un de ces langages. Il est de la famille ML et a √©t√© cr√©√© en France\ndans les ann√©es 90. Il est √† peu pr√®s aussi √¢g√© que JavaScript mais est beaucoup\nplus sage. Il est certes fortement et statiquement typ√©, mais il inf√®re la\nplupart des types du programme (ce qui veut dire que vous n'avez pas √†\nrenseigner les types partout, il va l'extrapoler d√®s qu'il le peut). En bonus,\nil poss√®de de\n<a href=\"https://ocaml.org/learn/tutorials/comparison_of_standard_containers.html\">bonnes data-structures</a>.</p>\n<p>Seulement voil√†, OCaml, comme beaucoup de langages fonctionnels n'a pas vraiment\nmis l'accent sur l'accessibilit√© pour les d√©butants, et a une syntaxe qu'on peut\npour le moins qualifier de pas tr√®s friendly: elle n'a rien de bien mal, mais\nmettez quelqu'un qui vient de JS/PHP/Java devant, √ßa va pas lui causer des\nmasses:</p>\n<pre><code class=\"hljs language-ocaml\"><span class=\"hljs-keyword\">let</span> <span class=\"hljs-keyword\">rec</span> qsort = <span class=\"hljs-keyword\">fun</span> <span class=\"hljs-keyword\">value</span> -&gt;\n  <span class=\"hljs-keyword\">match</span> <span class=\"hljs-keyword\">value</span> <span class=\"hljs-keyword\">with</span>\n   | <span class=\"hljs-literal\">[]</span> -&gt; <span class=\"hljs-literal\">[]</span>\n   | pivot :: rest -&gt;\n       <span class=\"hljs-keyword\">let</span> is_less x = x &lt; pivot <span class=\"hljs-keyword\">in</span>\n       <span class=\"hljs-keyword\">let</span> left, right = <span class=\"hljs-type\">List</span>.partition is_less rest <span class=\"hljs-keyword\">in</span>\n       qsort left @ [pivot] @ qsort right;;\n</code></pre>\n<figure>\n<img src=\"/public/images/articles/2017-10-02-introduction-a-reasonml/giphy.gif\" alt=\"\" />\n<figcaption>fig. 1: dev JS devant du code OCaml</figcaption>\n</figure>\n<p>C'est l√† qu'intervient Reason, un projet initi√© par\n<a href=\"https://twitter.com/jordwalke\">le cr√©ateur de React</a>. Les premi√®res it√©rations\nde React √©taient d'ailleurs cod√©es dans un langage cousin de OCaml, le SML.</p>\n<p>C'est en gros:</p>\n<ul>\n<li>OCaml</li>\n<li>avec une syntaxe <em>beginner-friendly</em></li>\n<li>avec un tooling le rendant plus simple √† utiliser</li>\n<li>qui peut compiler vers JavaScript et de multiples plateformes</li>\n</ul>\n<p>Avec son type system, OCaml propose un langage <em>safe-by-design</em>, chose que m√™me\navec une palanqu√©e d'outils, on ne peut pas atteindre avec JavaScript.</p>\n<p>Le langage propose par d√©faut une approche fonctionnelle et immutable, mais\npermet cependant de choisir d'utiliser des structures mutables et de l'orient√©\nobjet au besoin.</p>\n<h2>Le langage</h2>\n<p>Reason comporte plus de types de primitifs que JavaScript:</p>\n<pre><code class=\"hljs language-reason\"><span class=\"hljs-comment\">/* pas un gros &quot;number&quot; fourre tout, magique */</span>\n<span class=\"hljs-number\">1</span>; <span class=\"hljs-comment\">/* int */</span>\n<span class=\"hljs-number\">1.0</span>; <span class=\"hljs-comment\">/* float */</span>\n<span class=\"hljs-comment\">/* un caract√®re est d&#x27;un type diff√©rent de string */</span>\n<span class=\"hljs-string\">&quot;foo&quot;</span>; <span class=\"hljs-comment\">/* string */</span>\n<span class=\"hljs-character\">&#x27;a&#x27;</span>; <span class=\"hljs-comment\">/* char */</span>\n<span class=\"hljs-comment\">/* on trouve list ET array, chacun peut √™tre utilis√© pour diff√©rents cas */</span>\n<span class=\"hljs-literal\">[</span><span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span><span class=\"hljs-literal\">]</span>; <span class=\"hljs-comment\">/* list */</span>\n<span class=\"hljs-literal\">[|</span> <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span> <span class=\"hljs-literal\">|]</span>; <span class=\"hljs-comment\">/* array */</span>\n<span class=\"hljs-comment\">/* pas de null, mais des valeurs de type `option` qui contiennent\n  soit une valeur, soit rien */</span>\n<span class=\"hljs-constructor\">Some</span>(<span class=\"hljs-number\">1</span>); <span class=\"hljs-comment\">/* option int */</span>\n<span class=\"hljs-constructor\">None</span>; <span class=\"hljs-comment\">/* option int */</span>\n</code></pre>\n<p>Puisqu'il est fortement typ√©, il est impossible de mixer les types comme en\nJavaScript, vous devrez obligatoirement les convertir:</p>\n<pre><code class=\"hljs language-reason\"><span class=\"hljs-number\">1</span> <span class=\"hljs-operator\">+</span> <span class=\"hljs-number\">1.0</span>;\n<span class=\"hljs-comment\">/* Error:\n  This expression has type int but an expression was expected of type float */</span>\n<span class=\"hljs-number\">1</span> <span class=\"hljs-operator\">+</span> int_of_float(<span class=\"hljs-number\">1.0</span>);\n<span class=\"hljs-comment\">/* - : int = 2 */</span>\n</code></pre>\n<p>La plupart des op√©rations de transformations de type primitifs vers un autre\nsont accessibles dans le module <code>Pervasives</code> qui contient plein de petits\nutilitaires bien pratiques. Toutes les fonctions de ce module sont accessibles\ndirectement dans n'importe quel de vos fichiers.</p>\n<p>Les fonctions de Reason sont beaucoup plus puissantes qu'en JavaScript:</p>\n<pre><code class=\"hljs language-reason\"><span class=\"hljs-keyword\">let</span> add = (a, b) =&gt; a <span class=\"hljs-operator\">+</span> b;\n<span class=\"hljs-comment\">/* int =&gt; int =&gt; int */</span>\nadd(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>);\n<span class=\"hljs-comment\">/* 3 */</span>\nadd(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2.0</span>);\n<span class=\"hljs-comment\">/* This expression has type float but an expression was expected of type int */</span>\n\n<span class=\"hljs-comment\">/* Les fonctions sont &quot;auto-curried&quot;, ce qui signifie qu&#x27;une fonction\n   qui n&#x27;a pas re√ßu tous ses param√®tres retourne une nouvelle fonction\n  qui va recevoir les param√®tres manquants */</span>\n<span class=\"hljs-keyword\">let</span> addOne = add(<span class=\"hljs-number\">1</span>);\n<span class=\"hljs-comment\">/* int =&gt; int */</span>\n\n<span class=\"hljs-comment\">/* Les fonctions peuvent avoir des param√®tres nomm√©s, optionnels et avec des valeurs par d√©faut */</span>\n<span class=\"hljs-keyword\">let</span> sayHi = (~name, ~punct=<span class=\"hljs-string\">&quot;!&quot;</span>, ()) =&gt; <span class=\"hljs-string\">&quot;Hello &quot;</span> <span class=\"hljs-operator\">++</span> name <span class=\"hljs-operator\">++</span> punct;\n<span class=\"hljs-comment\">/* name::string =&gt; string */</span>\nsayHi(~name=<span class=\"hljs-string\">&quot;you&quot;</span>, ());\n<span class=\"hljs-comment\">/* &quot;Hello you!&quot; */</span>\n<span class=\"hljs-comment\">/* L&#x27;ordre des arguments nomm√©s n&#x27;a pas d&#x27;importance*/</span>\nsayHi(~punct=<span class=\"hljs-string\">&quot;?&quot;</span>, ~name=<span class=\"hljs-string\">&quot;you&quot;</span>, ());\n<span class=\"hljs-comment\">/* &quot;Hello you?&quot; */</span>\n</code></pre>\n<p>Pour d√©finir l'√©quivalent d'un <em>plain-object</em> JavaScript en Reason, on utilise\ndes records:</p>\n<pre><code class=\"hljs language-reason\"><span class=\"hljs-comment\">/* On doit typer les records */</span>\n<span class=\"hljs-keyword\">type</span> user = {\n  username: string,\n  age: int\n};\n\n<span class=\"hljs-comment\">/* Les records ont un nombre de cl√©s fini, vous ne pouvez pas en\n  ommettre une ou en mettre une en trop */</span>\n<span class=\"hljs-keyword\">let</span> user = { username: <span class=\"hljs-string\">&quot;Bob&quot;</span> };\n<span class=\"hljs-comment\">/* Error: Some record fields are undefined: age */</span>\n\n<span class=\"hljs-keyword\">let</span> user = { username: <span class=\"hljs-string\">&quot;Bob&quot;</span>, age: <span class=\"hljs-number\">20</span> };\n\n<span class=\"hljs-comment\">/* Les records sont immutables par d√©faut */</span>\n<span class=\"hljs-keyword\">let</span> olderUser = {<span class=\"hljs-operator\">...</span>user, age: user.age <span class=\"hljs-operator\">+</span> <span class=\"hljs-number\">1</span> };\n</code></pre>\n<p>Reason poss√®de un syst√®me de module tr√®s puissant: par d√©faut, chaque fichier de\nvotre codebase est un module, mais vous pouvez √©galement d√©clarer des modules\n<em>dans</em> un module.</p>\n<pre><code class=\"hljs language-reason\"><span class=\"hljs-keyword\">module</span> <span class=\"hljs-module-identifier\">User</span> = {\n  <span class=\"hljs-keyword\">type</span> t = {\n    id: string,\n    username: string,\n    email: option(string)\n  };\n  <span class=\"hljs-keyword\">let</span> make = (~id, ~username, ~email) =&gt; {id, username, email};\n  <span class=\"hljs-keyword\">let</span> sayHi = (user) =&gt; <span class=\"hljs-string\">&quot;Hello &quot;</span> <span class=\"hljs-operator\">++</span> user.username <span class=\"hljs-operator\">++</span> <span class=\"hljs-string\">&quot;!&quot;</span>;\n};\n\n<span class=\"hljs-comment\">/* Pour utiliser un module, tapez son nom, tout simplement */</span>\n<span class=\"hljs-module-identifier\">User</span>.make(~id=<span class=\"hljs-string\">&quot;0&quot;</span>, ~username=<span class=\"hljs-string\">&quot;bloodyowl&quot;</span>, ~email=<span class=\"hljs-constructor\">None</span>)\n  <span class=\"hljs-comment\">/* (ah oui, le pipe existe d√©j√† ici, pas besoin d&#x27;attendre ES2050)*/</span>\n  <span class=\"hljs-operator\">|&gt;</span> <span class=\"hljs-module-identifier\">User</span>.sayHi\n  <span class=\"hljs-operator\">|&gt;</span> print_endline;\n<span class=\"hljs-comment\">/* &quot;Hello bloodyowl&quot; */</span>\n\n<span class=\"hljs-comment\">/* On peut √©galement rendre toutes les valeurs d&#x27;un module accessibles localement */</span>\n<span class=\"hljs-module-identifier\">User</span>.(\n  make(~id=<span class=\"hljs-string\">&quot;0&quot;</span>, ~username=<span class=\"hljs-string\">&quot;bloodyowl&quot;</span>, ~email=<span class=\"hljs-constructor\">None</span>)\n    <span class=\"hljs-operator\">|&gt;</span> sayHi\n    <span class=\"hljs-operator\">|&gt;</span> print_endline\n);\n\n<span class=\"hljs-comment\">/* Carr√©ment les rendre accessibles globalement dans le module */</span>\n<span class=\"hljs-keyword\">open</span> <span class=\"hljs-module-identifier\">User</span>;\n\nmake(~id=<span class=\"hljs-string\">&quot;0&quot;</span>, ~username=<span class=\"hljs-string\">&quot;bloodyowl&quot;</span>, ~email=<span class=\"hljs-constructor\">None</span>)\n  <span class=\"hljs-operator\">|&gt;</span> sayHi\n  <span class=\"hljs-operator\">|&gt;</span> print_endline;\n\n<span class=\"hljs-comment\">/* Ou m√™me √©tendre un module statiquement et proprement,\n  √ßa vous parle √ßa, Prototype et MooTools ?! */</span>\n<span class=\"hljs-keyword\">module</span> <span class=\"hljs-module-identifier\">UserThatCanSayBye</span> = {\n  <span class=\"hljs-keyword\">include</span> <span class=\"hljs-module-identifier\">User</span>;\n  <span class=\"hljs-keyword\">let</span> sayBye = (user) =&gt; <span class=\"hljs-string\">&quot;Bye &quot;</span> <span class=\"hljs-operator\">++</span> user.username <span class=\"hljs-operator\">++</span> <span class=\"hljs-string\">&quot;!&quot;</span>;\n};\n</code></pre>\n<p>Il existe √©galement des functors, qui sont des sortes de fonctions retournant\ndes modules √† partir d'autres modules, mais on ne l'abordera pas dans cet\narticle.</p>\n<p>Reason poss√®de √©galement des variants, il s'agit de types pouvant avoir\ndiff√©rents cas. Prenons l'exemple d'un message de chat:</p>\n<pre><code class=\"hljs language-reason\"><span class=\"hljs-keyword\">type</span> image = {url: string, width: int, height: int};\n\n<span class=\"hljs-comment\">/* chaque cas du variant peut prendre des param√®tres */</span>\n<span class=\"hljs-keyword\">type</span> message =\n  | <span class=\"hljs-constructor\">String</span>(string) <span class=\"hljs-comment\">/* soit une cha√Æne de caract√®res */</span>\n  | <span class=\"hljs-constructor\">Image</span>(image) <span class=\"hljs-comment\">/* soit une image */</span>\n  | <span class=\"hljs-constructor\">Emoji</span>(string); <span class=\"hljs-comment\">/* soit un gros emoji */</span>\n\n<span class=\"hljs-keyword\">let</span> stringMessage = <span class=\"hljs-constructor\">String</span>(<span class=\"hljs-string\">&quot;Hello&quot;</span>); <span class=\"hljs-comment\">/* On cr√©e la valeur avec son constructeur */</span>\n<span class=\"hljs-keyword\">let</span> imageMessage = <span class=\"hljs-constructor\">Image</span>({url: <span class=\"hljs-string\">&quot;https://fakeimg.pl/300x300&quot;</span>, width: <span class=\"hljs-number\">300</span>, height: <span class=\"hljs-number\">300</span>});\n<span class=\"hljs-keyword\">let</span> emojiMessage = <span class=\"hljs-constructor\">Emoji</span>(<span class=\"hljs-string\">{js|üê´|js}</span>); <span class=\"hljs-comment\">/* Quand la string contient de caract√®res unicode,\n  on doit utiliser {js|votre string|js} */</span>\n</code></pre>\n<p>Ici, notre type <code>message</code> est bien d√©limit√©, et ses valeurs ne peuvent √™tre que\ncelles que l'on a d√©fini.</p>\n<p>Pour utiliser les valeurs d'un variant, on peut les extraire √† l'aide de\n<code>switch</code>, qui va <em>pattern-matcher</em> pour nous permettre d'identifier et\nd'extraire les valeurs.</p>\n<pre><code class=\"hljs language-reason\"><span class=\"hljs-comment\">/* Petit bonus, l&#x27;exemple utilise ReasonReact, mais on d√©taillera √ßa dans un prochain article */</span>\n<span class=\"hljs-keyword\">let</span> component = <span class=\"hljs-module-identifier\">ReasonReact</span>.statelessComponent(<span class=\"hljs-string\">&quot;ChatMessage&quot;</span>);\n\n<span class=\"hljs-keyword\">let</span> make = (~message, _children) =&gt; {\n  <span class=\"hljs-operator\">...</span>component,\n  render: (_) =&gt;\n    &lt;div&gt;\n      (<span class=\"hljs-keyword\">switch</span> message {\n        | <span class=\"hljs-constructor\">String</span>(value) =&gt; <span class=\"hljs-module-identifier\">ReasonReact</span>.stringToElement(value)\n        | <span class=\"hljs-constructor\">Image</span>({url: src, width, height}) =&gt; &lt;img width height src /&gt;\n        <span class=\"hljs-comment\">/* Si par m√©garde j&#x27;oublie un cas possible dans un switch, je vais avoir un joli warning du\n          compiler qui me dira:\n            This pattern-matching is not exhaustive.\n            Here is an example of a value that is not matched:\n              Emoji\n        */</span>\n        | <span class=\"hljs-constructor\">Emoji</span>(value) =&gt;\n          &lt;div style=(<span class=\"hljs-module-identifier\">ReactDOMRe</span>.<span class=\"hljs-module-identifier\">Style</span>.make(~fontSize=<span class=\"hljs-string\">&quot;40px&quot;</span>, ()))&gt;\n            (<span class=\"hljs-module-identifier\">ReasonReact</span>.stringToElement(value))\n          &lt;/div&gt;\n      })\n    &lt;/div&gt;\n};\n</code></pre>\n<p>En Reason, les <em>let bindings</em> ont automatiquement le block parent comme scope,\non peut du coup √©crire des choses comme ceci :</p>\n<pre><code class=\"hljs language-reason\"><span class=\"hljs-keyword\">let</span> value = {\n  <span class=\"hljs-keyword\">let</span> a = <span class=\"hljs-number\">1</span>;\n  <span class=\"hljs-keyword\">let</span> b = <span class=\"hljs-number\">2</span>;\n  a <span class=\"hljs-operator\">+</span> b; <span class=\"hljs-comment\">/* la derni√®re expression est toujours retourn√©e par d√©faut */</span>\n};\n<span class=\"hljs-comment\">/* let value : int = 3 */</span>\na\n<span class=\"hljs-comment\">/* Error: Unbound value a */</span>\n</code></pre>\n<p>Voil√† pour l'introduction √† ReasonML, pour en d√©couvrir un peu plus je vous\ninvite √† aller lire la <a href=\"https://reasonml.github.io/\">documentation officielle</a>.\nOn verra dans les prochains articles comment fonctionne\n<a href=\"https://reasonml.github.io/reason-react\">ReasonReact</a> (les bindings Reason vers\nReact, avec quelques petites features sympathiques en plus), et comment\nl'adopter incr√©mentalement dans sa codebase pour avoir du code plus s√ªr, et\n<em>(spoilers)</em>, plus rapide que si vous l'√©criviez √† la main.</p>\n<p>Bisous bisous.</p>\n"}}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"listsRequests":{"data":{"RE_PRIVATE_NONE":true}},"itemsRequests":{"data":{"RE_PRIVATE_NONE":true}}}</script><head><script defer="defer" src="/public/main.56c69761a03eb0112696.js"></script></head></html>