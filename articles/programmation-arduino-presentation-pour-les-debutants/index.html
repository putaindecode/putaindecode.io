<!DOCTYPE html><html lang="fr"><head><title data-react-helmet="true">Programmation Arduino: présentation pour les débutants | Putain de code</title><meta data-react-helmet="true" charset="UTF-8"/><meta data-react-helmet="true" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover" name="viewport"/><meta data-react-helmet="true" content="summary_large_image" name="twitter:card"/><meta data-react-helmet="true" content="Putain de code !" property="og:site_name"/><meta data-react-helmet="true" content="@putaindecode" name="twitter:site"/><meta data-react-helmet="true" content="https://putaindecode.io/public/images/website/share.jpg" property="og:image"/><meta data-react-helmet="true" content="https://putaindecode.io/public/images/website/share.jpg" name="twitter:image"/><meta data-react-helmet="true" content="1500" property="og:image:width"/><meta data-react-helmet="true" content="777" property="og:image:height"/><meta data-react-helmet="true" content="Programmation Arduino: présentation pour les débutants | Putain de code" property="og:title"/><meta data-react-helmet="true" content="Programmation Arduino: présentation pour les débutants | Putain de code" name="twitter:title"/><meta data-react-helmet="true" content="Un article proposé par toxnico" name="description"/><link data-react-helmet="true" title="RSS Feed" href="/api/articles/feeds/desc/feed.xml" rel="alternate" type="application/rss+xml"/><link data-react-helmet="true" href="/favicon.ico" rel="shortcut icon"/><link data-react-helmet="true" href="https://putaindecode.io/articles/programmation-arduino-presentation-pour-les-debutants" rel="canonical"/><script>window.PAGES_BOOT_MODE="hydrate";</script></head><div id="root"><style data-emotion="rpcss zx73cm 1lc6tyj 28v1b4">@-webkit-keyframes animation-zx73cm{from{opacity:0;-webkit-transform:translateY(20px);-moz-transform:translateY(20px);-ms-transform:translateY(20px);transform:translateY(20px);}}@keyframes animation-zx73cm{from{opacity:0;-webkit-transform:translateY(20px);-moz-transform:translateY(20px);-ms-transform:translateY(20px);transform:translateY(20px);}}:root{--page-background-color:#fff;--page-slightly-accented-background-color:#F9F6F6;--page-accented-background-color:#E4EBEE;--page-text-color:#46515B;--link-text-color:#E51D58;--gradient-red-top:#E51D58;--gradient-red-bottom:#CC0613;--code-background-color:#FAF3E1;--one-percent-contrast-color:rgba(0, 0, 0, 0.1);--half-percent-contrast-color:rgba(0, 0, 0, 0.05);}@media (prefers-color-scheme: dark){:root{--page-background-color:#222;--page-slightly-accented-background-color:#171717;--page-accented-background-color:#111;--page-text-color:#ddd;--link-text-color:#F87098;--gradient-red-top:#E51D58;--gradient-red-bottom:#CC0613;--code-background-color:#4F3804;--one-percent-contrast-color:rgba(255, 255, 255, 0.1);--half-percent-contrast-color:rgba(255, 255, 255, 0.05);}}body{padding:0;margin:0;background-color:var(--page-background-color);color:var(--page-text-color);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;overflow-x:hidden;}html{font-size:1em;line-height:1.4;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%;}a{color:var(--link-text-color);-webkit-text-decoration:underline;text-decoration:underline;}a:hover{-webkit-text-decoration:none;text-decoration:none;}#root{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}*,*:before,*:after{box-sizing:border-box;}pre,.hljs{color:#adbac7;background:#22272e;}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#f47067;}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#dcbdfb;}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-variable,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id{color:#6cb6ff;}.hljs-regexp,.hljs-string,.hljs-meta .hljs-string{color:#96d0ff;}.hljs-built_in,.hljs-symbol{color:#f69d50;}.hljs-comment,.hljs-code,.hljs-formula{color:#768390;}.hljs-name,.hljs-quote,.hljs-selector-tag,.hljs-selector-pseudo{color:#8ddb8c;}.hljs-subst{color:#adbac7;}.hljs-section{color:#316dca;font-weight:bold;}.hljs-bullet{color:#eac55f;}.hljs-emphasis{color:#adbac7;font-style:italic;}.hljs-strong{color:#adbac7;font-weight:bold;}.hljs-addition{color:#b4f1b4;background-color:#1b4721;}.hljs-deletion{color:#ffd8d3;background-color:#78191b;}</style><style data-emotion="rpcss 9vhaby">.rpcss-9vhaby{background-color:var(--gradient-red-bottom);background-image:linear-gradient(to bottom right, var(--gradient-red-top), var(--gradient-red-bottom));}</style><header class="rpcss-9vhaby" style="background-image:linear-gradient(to bottom right, hsl(265, 100%, 35%), hsl(221, 100%, 30%))"><style data-emotion="rpcss 1qqk0tr">.rpcss-1qqk0tr{padding-left:env(safe-area-inset-left);padding-right:env(safe-area-inset-right);}</style><div class="rpcss-1qqk0tr"><style data-emotion="rpcss qx7dny">.rpcss-qx7dny{width:100%;max-width:1024px;margin:0 auto;padding:0 10px;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;}</style><div class="rpcss-qx7dny"><style data-emotion="rpcss 7s9om2">.rpcss-7s9om2{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding:20px 0 50px;}</style><div class="rpcss-7s9om2"><style data-emotion="rpcss gdpa5c">.rpcss-gdpa5c{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-text-decoration:none;text-decoration:none;}</style><a class="rpcss-gdpa5c" href="/"><style data-emotion="rpcss 1lm4738">.rpcss-1lm4738{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-text-decoration:none;text-decoration:none;padding-bottom:10px;}</style><div class="rpcss-1lm4738"><style data-emotion="rpcss 13o7eu2">.rpcss-13o7eu2{display:block;}</style><svg class="rpcss-13o7eu2" height="36px" width="36px" viewBox="0 0 36 36"><defs><linearGradient id="PutainDeCodeLogoGradient" x1="50%" x2="50%" y1="0%" y2="127.223881%"><stop offset="0%" stop-color="#E41D57"></stop><stop offset="100%" stop-color="#C60000"></stop></linearGradient></defs><circle cx="18" cy="18" fill="url(#PutainDeCodeLogoGradient)" r="17" stroke="#FFFFFF" stroke-width="2"></circle><polygon fill="#FFFFFF" points="15.9033203 18.2246094 15.9033203 18.3710938 11.2304688 20.5317383 11.2304688 22.8095703 18.0566406 19.184082 18.0566406 17.4116211 11.2304688 13.7788086 11.2304688 16.0639648"></polygon><rect height="14" width="2" fill="#FFFFFF" x="22" y="11"><animate attributeName="opacity" begin="100ms" calcMode="discrete" dur="2s" repeatCount="indefinite" values="1;0"></animate></rect></svg><style data-emotion="rpcss 4cf197">.rpcss-4cf197{width:10px;height:10px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}</style><div class="rpcss-4cf197"></div><style data-emotion="rpcss u5k24">.rpcss-u5k24{font-size:22px;color:#fff;font-weight:800;}</style><div aria-level="2" class="rpcss-u5k24" role="heading">Putain de code !</div></div><style data-emotion="rpcss 1nyebg4">.rpcss-1nyebg4{font-size:14px;color:rgba(255, 255, 255, 0.8);text-align:center;}</style><div class="rpcss-1nyebg4">Blog participatif de la communauté dev</div></a></div></div></div></header><style data-emotion="rpcss a4ric9">.rpcss-a4ric9{background-color:var(--page-slightly-accented-background-color);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}</style><div class="rpcss-a4ric9"><style data-emotion="rpcss oeugsb">.rpcss-oeugsb{-webkit-animation:500ms ease-out animation-zx73cm;animation:500ms ease-out animation-zx73cm;}</style><div class="rpcss-oeugsb"><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 1qc2bam">.rpcss-1qc2bam{font-size:42px;font-weight:800;text-align:center;padding-top:40px;line-height:1.2;margin:0;}</style><h1 class="rpcss-1qc2bam">Programmation Arduino: présentation pour les débutants</h1><style data-emotion="rpcss obg2kr">.rpcss-obg2kr{font-size:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding-top:10px;padding-bottom:40px;color:var(--page-text-color);-webkit-text-decoration:none;text-decoration:none;}</style><a class="rpcss-obg2kr" href="https://github.com/toxnico"><style data-emotion="rpcss uco8i7">.rpcss-uco8i7{width:32px;height:32px;border-radius:100%;margin-right:10px;}</style><img class="rpcss-uco8i7" alt="toxnico" src="https://avatars.githubusercontent.com/toxnico?size=64"/><div>toxnico<!-- --> <!-- -->•<!-- --> <!-- -->2018/05/07</div></a><style data-emotion="rpcss 15kxmi0">.rpcss-15kxmi0{max-width:640px;width:100%;font-size:18px;margin:0 auto;line-height:1.7;}.rpcss-15kxmi0 h2,.rpcss-15kxmi0 h3,.rpcss-15kxmi0 h4,.rpcss-15kxmi0 h5,.rpcss-15kxmi0 h6{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;font-weight:800;line-height:1.2;}.rpcss-15kxmi0 img{max-width:100%;background-color:rgba(255, 255, 255, 0.75);}.rpcss-15kxmi0 code{font-size:0.9em;font-family:PragmataPro,SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;line-height:1;background-color:var(--code-background-color);margin:0 0.2em;}.rpcss-15kxmi0 pre{padding:10px;overflow-x:auto;font-size:14px;border-radius:10px;border:2px solid var(--one-percent-contrast-color);-webkit-overflow-scrolling:touch;}.rpcss-15kxmi0 pre code{font-size:14px;background-color:transparent;margin:0;}.rpcss-15kxmi0 blockquote{padding-left:20px;margin:0;font-size:16px;border-left:3px solid var(--one-percent-contrast-color);font-style:italic;}.rpcss-15kxmi0 table{width:100%;text-align:center;}.rpcss-15kxmi0 figure{padding:20px 0;}.rpcss-15kxmi0 figcaption{text-align:center;}.rpcss-15kxmi0 a{word-wrap:break-word;}.rpcss-15kxmi0 table thead th{background-color:var(--page-accented-background-color);padding:10px 0;}</style><div class="rpcss-15kxmi0"><h2>1. Mais qu'est-ce que c'est Arduino, d'abord?</h2>
<h3>1.1. Photo d'une Uno</h3>
<p>Arduino, ce sont des cartes électroniques programmables, avec un certain nombre
d'entrées/sorties. Quoi ? c'est pas précis ? OK, je recommence.</p>
<p>Une carte Arduino, ça ressemble (de manière non exhaustive, parce qu'il y a
enormément de modèles et de clones) à ceci :</p>
<p><img src="/public/images/articles/2018-05-07-programmation-arduino-presentation-pour-les-debutants/Arduino_Uno.jpg" alt="Arduino Uno" /></p>
<p>C'est une carte électronique open source, constituée essentiellement de :</p>
<ul>
<li>un microcontrôleur fabriqué par Atmel,</li>
<li>un port USB,</li>
<li>des connecteurs d'entrés/sortie (plus ou moins nombreux selon les modèles).</li>
</ul>
<p>L'open hardware, par analogie à l'open software, permet de partager les plans
pour pouvoir répliquer, améliorer, comprendre un dispositif matériel.</p>
<p>Arduino, c'est aussi un IDE (disons plutôt un éditeur de code) qui permet
d'envoyer les programmes sur la carte à travers un port USB.</p>
<p>Il est open source et <a href="https://www.arduino.cc/en/main/software">disponible ici</a>.</p>
<h3>1.2. Spécifications du matériel</h3>
<p>Le modèle Uno présenté ici dispose, accrochez-vous, de :</p>
<ul>
<li>32 ko de mémoire pour stocker les programmes,</li>
<li>2 ko de RAM, une EEPROM 1 ko pour stocker… 2 ou 3 trucs, typiquement des
paramètres. Impossible d'y stocker des logs GPS, par exemple ;</li>
<li>et tout ce petit monde est cadencé à la fréquence totalement dingo de 16 MHz !</li>
</ul>
<p>Tout ça pour la modique somme d'une vingtaine d'euros (pour les authentiques),
et une dizaine d'euros — voire moins — pour les clones.</p>
<h3>1.3. Mais à quoi ça sert?</h3>
<p>&quot;C'est quoi ces specs, c'est une blague ? Qu'est-ce qu'on peut faire d'un bidule
pareil aujourd'hui ?&quot;</p>
<p>Eh bien on peut interagir avec le monde réel, car contrairement à un PC qui
dispose de 3 ou 4 ports USB (et je ne parle même pas des Mac), une petite carte
comme celle-ci peut gérer des moteurs, des systèmes d'affichage, des capteurs
(accéléromètres, température, pression atmosphérique, luminosité, et la liste
est loin d'être exhaustive).</p>
<p>Au final, ça sert à fabriquer des machines. Elles peuvent être autonomes,
discuter entre elles ou avec un PC, et réagir à leur environnement.</p>
<p>La grosse vague des imprimantes 3D a eu lieu grâce à ces petits bidules. La
mienne tourne avec une ATMEGA 2560 comme celle-ci (on remarquera qu'il y a
beaucoup plus de pins sur celle-ci) :</p>
<p><img src="/public/images/articles/2018-05-07-programmation-arduino-presentation-pour-les-debutants/Arduino_Mega2560.jpg" alt="ATMEGA2560" /></p>
<p>Ma fraiseuse CNC dans le garage tourne avec une simple Arduino Uno, qui reçoit
les commandes depuis un PC et pilote 3 axes avec des moteurs pas à pas assez
balaises.</p>
<p>Le projet ArduPilot propose des firmwares et shields (extensions qui se
connectent directement sur la carte) destinés à gérer des drones (multicoptères,
avions, rovers) dans toutes leurs fonctions (moteurs, stabilisation, GPS,
altimètre…)</p>
<h3>1.4. Principe de fonctionnement</h3>
<p>Le principe, rapidement évoqué dans la toute première phrase, est d'utiliser les
pins (i.e. les connecteurs numérotés que l'on peut voir sur la photo) pour lire
ou écrire des informations.</p>
<p>OK, OK, les informations sont de très bas niveau, vu que c'est un signal soit de
5 V, soit de 0 V.</p>
<p>Un bit, quoi. Tout juste de quoi faire clignoter un LED (<strong>spoiler</strong> : c'est ce
que nous allons faire tout de suite).</p>
<p>Nous verrons plus tard que des protocoles de communication sont à notre
disposition pour ne pas se taper l'écriture des bits un par un sur une pin
(c'est très sexuel comme terminologie hein).</p>
<p><strong>Mais vous l'aurez compris, globalement, on va être dans de la programmation de
bas niveau.</strong></p>
<h2>2. Structure d'un programme, langages utilisés</h2>
<p>Allez, assez de teasing, nous allons écrire notre premier programme !</p>
<p>Le but ? faire clignoter une LED sur la carte. Ben oui, il faut commencer petit
pour bien saisir la structure d'un programme dans cet environnement.</p>
<p>Le programme principal consiste en deux fonctions (ce sera toujours le cas),
dont voici les signatures ultra simples :</p>
<ul>
<li>void setup()</li>
<li>void loop()</li>
</ul>
<p><code>setup()</code> est appelée une seule fois, au moment de la mise sous tension de la
carte. <code>loop()</code> est appelée, comme son nom l'indique, en boucle. Elle est lancée
après <code>setup()</code>, et tourne à fond à l'infini (tant que la carte est alimentée en
tout cas).</p>
<p>Ah j'oubliais : le langage de programmation utilisé est au choix le C, ou le
C<ins>. J'ai un faible pour le C</ins> pour sa relative simplicité par rapport au C
pur.</p>
<p>Donc pour reprendre sur notre programme de base, on a quelque chose comme ça :</p>
<pre><code class="hljs language-C"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{
    setup();

    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)
        loop();
}
</code></pre>
<p>En pratique, nous n'implémenterons que les deux fonctions <code>setup()</code> et <code>loop()</code>.
Le <code>main()</code> est généré par le compilateur.</p>
<p>Allez, assez discuté, passons à notre programme, le grand classique <strong>Blink</strong>:</p>
<pre><code class="hljs language-C"><span class="hljs-keyword">int</span> led = <span class="hljs-number">13</span>;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{
  pinMode(led, OUTPUT);      <span class="hljs-comment">// Définit la pin 13 comme pin de sortie</span>
}

<span class="hljs-comment">// the loop routine runs over and over again forever:</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{
  digitalWrite(led, HIGH);   <span class="hljs-comment">// Allume la LED</span>
  delay(<span class="hljs-number">1000</span>);               <span class="hljs-comment">// Attend une seconde</span>
  digitalWrite(led, LOW);    <span class="hljs-comment">// Eteint la LED</span>
  delay(<span class="hljs-number">1000</span>);               <span class="hljs-comment">// Attend une seconde</span>
}
</code></pre>
<p>Dans ce programme, on fait usage de 3 fonctions de la librairie standard :</p>
<ul>
<li><code>pinMode(pinNumber, mode)</code> : définit le mode de fonctionnement d'une pin. À la
louche, soit INPUT, soit OUTPUT ;</li>
<li><code>digitalWrite(pinNumber, value)</code> : si la pin est définie en OUTPUT, cette
instruction permet d'écrire 1 ou 0. Si on mesure avec un voltmètre la tension
entre la pin et la masse, on aura +5 V ou 0 V. HIGH et LOW sont des constantes
prédéfinies, mais 1 ou 0 fonctionneraient aussi ;</li>
<li>delay(ms) : cette instruction bloque l'exécution du programme (de <strong>tout</strong> le
programme) pendant une durée donnée en millisecondes.</li>
</ul>
<p>La pin 13 est très pratique, car elle est reliée à une LED intégrée à la carte.
Du coup, dès qu'on active ou désactive la 13, une petite LED orange s'allume ou
s'éteint.</p>
<h2>3. Instructions de base</h2>
<p>Nous venons de voir au paragraphe précédent 2 instructions qui permettent
d'envoyer une information en sortie (dans ce cas, faire clignoter une LED. Paye
ta gloire.)</p>
<p>On peut aussi <strong>lire</strong> une information venant de l'extérieur, avec
<code>digitalRead(pinNumber)</code>.</p>
<p>Ca va permettre par exemple de savoir si un bouton poussoir est appuyé ou pas,
si une porte est ouverte ou fermée, etc.</p>
<p>Par exemple, on pourrait écrire ceci :</p>
<pre><code class="hljs language-C"><span class="hljs-keyword">int</span> ledPin = <span class="hljs-number">13</span>;   <span class="hljs-comment">// LED sur la pin 13</span>
<span class="hljs-keyword">int</span> btnPin = <span class="hljs-number">7</span>;     <span class="hljs-comment">// bouton poussoir sur la pin 7</span>

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span>
</span>{
  pinMode(ledPin, OUTPUT);
  pinMode(btnPin, INPUT);
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">int</span> val = digitalRead(btnPin);     <span class="hljs-comment">// lit l&#x27;état du bouton</span>
  digitalWrite(ledPin, val);    <span class="hljs-comment">// allume la LED en fonction de l&#x27;état du bouton</span>
}
</code></pre>
<p>Je vous vois venir : &quot;Oui, mais tu te fous un peu de nous là, on n'a qu'à
connecter la LED directement au bouton !&quot;</p>
<p>La réponse est oui. Mais si je voulais introduire un délai entre l'appui sur le
bouton et l'allumage de la LED, ça commence à devenir intéressant.</p>
<p>Ou bien si l'allumage dépend d'autres capteurs branchés sur d'autres pins, comme
par exemple une photorésistance. On pourrait faire en sorte que la LED ne
s'allume que si la luminosité ambiante est suffisamment faible.</p>
<p>Mais comment savoir si la luminosité est suffisamment faible, alors que jusqu'à
maintenant on n'est capable de lire que HIGH ou LOW ? Grâce à
<code>analogRead(pinNumber)</code>, bien sûr !</p>
<p>Sur la carte en photo on peut voir une série de pins notées de A0 à A5, et leur
particularité, c'est qu'elles peuvent transformer un signal analogique (une
tension entre 0 et 5 V) en un entier de 0 à 1023.</p>
<p>Par exemple, si une photorésistance est branchée entre le +5 V et la pin A0, on
peut obtenir la luminosité ambiante avec :</p>
<pre><code class="hljs language-C"><span class="hljs-comment">// Pas besoin de faire un pinMode() dans le cas d&#x27;une lecture analogique.</span>
<span class="hljs-keyword">int</span> ambientBrightness = analogRead(A0);
</code></pre>
<p>Donc pour allumer la LED uniquement si le bouton est pressé <strong>ET</strong> que la
luminosité ambiante est suffisamment basse (seuil à déterminer empiriquement,
disons 600):</p>
<pre><code class="hljs language-C"><span class="hljs-keyword">int</span> ledPin = <span class="hljs-number">13</span>;   <span class="hljs-comment">// LED sur la pin 13</span>
<span class="hljs-keyword">int</span> btnPin = <span class="hljs-number">7</span>;     <span class="hljs-comment">// Bouton poussoir sur la pin 7</span>
<span class="hljs-keyword">int</span> photoResPin = A0; <span class="hljs-comment">// A0 est une constante utilisable directement</span>
<span class="hljs-keyword">int</span> threshold = <span class="hljs-number">600</span>;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span>
</span>{
  pinMode(ledPin, OUTPUT);
  pinMode(btnPin, INPUT);
  <span class="hljs-comment">// On éteint la LED à l&#x27;initialisation:</span>
  digitalWrite(ledPin, LOW);
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-comment">//lecture du bouton</span>
  <span class="hljs-keyword">int</span> val = digitalRead(btnPin);     <span class="hljs-comment">// Lit l&#x27;état du bouton</span>

  <span class="hljs-comment">//lecture de la luminosité</span>
  <span class="hljs-keyword">int</span> ambientBrightness = analogRead(A0);

  <span class="hljs-keyword">if</span>((val == HIGH &amp;&amp; ambientBrightness &lt; threshold) || val == LOW)
    digitalWrite(ledPin, val);    <span class="hljs-comment">// Allume la LED en fonction de l&#x27;état du bouton ET de la luminosité</span>
}
</code></pre>
<p>Si j'étais joueur, je permettrais à l'utilisateur de régler le seuil avec un
potentiomètre relié à une autre entrée analogique, histoire de ne pas le coder
en dur… Mais comme je suis un gros fainéant et que je vois des étoiles briller
dans vos yeux, je vais vous laisser y réfléchir. :)</p>
<h2>4. Résumé de cette première session</h2>
<p>Un petit doliprane ou ça va ?</p>
<p>Pour résumer cette session, voici ce qu'il faut retenir :</p>
<ul>
<li>Arduino est une plateforme pour programmer des cartes électroniques
(communément appelés microcontrôleurs),</li>
<li>on programme en C ou en C++,</li>
<li>nous avons des fonctions à disposition pour lire des entrées et écrire sur des
sorties (la plupart des pins sont réversibles d'ailleurs) ;</li>
<li>il y a peu de mémoire à disposition, donc l'optimisation des programmes sera
cruciale pour des projets complexes.</li>
</ul>
<p><em>Crédits images : <a href="https://commons.wikimedia.org">https://commons.wikimedia.org</a>, <a href="https://www.arduino.cc">https://www.arduino.cc</a></em></p>
</div><style data-emotion="rpcss unyj6i">.rpcss-unyj6i{max-width:640px;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin:20px auto;padding:20px;background-color:var(--page-background-color);border-radius:10px;box-shadow:0 15px 15px -5px rgba(0, 0, 0, 0.2);}@media (max-width: 540px){.rpcss-unyj6i{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><div class="rpcss-unyj6i"><style data-emotion="rpcss ty7r4z">.rpcss-ty7r4z{font-weight:800;}</style><div class="rpcss-ty7r4z">Vous avez aimé cet article?</div><style data-emotion="rpcss klacsp">.rpcss-klacsp{width:0;height:10px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}</style><div class="rpcss-klacsp"></div><style data-emotion="rpcss 1pkr03v">.rpcss-1pkr03v{background-color:#00aced;color:#fff;padding:10px 20px;-webkit-text-decoration:none;text-decoration:none;border-radius:5px;font-weight:800;}.rpcss-1pkr03v:active{opacity:0.5;}</style><a class="rpcss-1pkr03v" href="https://www.twitter.com/intent/tweet?text=Programmation%20Arduino%3A%20pr%C3%A9sentation%20pour%20les%20d%C3%A9butants%20sur%20%40PutainDeCode%20https%3A%2F%2Fputaindecode.io%2Farticles%2Fprogrammation-arduino-presentation-pour-les-debutants" target="_blank">Le partager sur Twitter</a></div><style data-emotion="rpcss x4iqxe">.rpcss-x4iqxe{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;text-align:center;padding:20px;}</style><div class="rpcss-x4iqxe"><style data-emotion="rpcss gein6x">.rpcss-gein6x{font-size:20px;-webkit-text-decoration:none;text-decoration:none;color:#1E49B5;}</style><a class="rpcss-gein6x" href="/articles">← Articles</a></div><style data-emotion="rpcss 8bodgl">.rpcss-8bodgl{max-width:640px;width:100%;margin:0 auto;padding:20px 0;}</style><div class="rpcss-8bodgl" id="disqus_thread"></div></div></div></div></div><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 1vau6rl">.rpcss-1vau6rl{margin:20px 0;background-color:var(--page-accented-background-color);border-radius:10px;padding:20px;}</style><div class="rpcss-1vau6rl"><style data-emotion="rpcss 1gz1i1h">.rpcss-1gz1i1h{font-size:32px;font-weight:800;margin-bottom:20px;text-align:center;}</style><div aria-level="2" class="rpcss-1gz1i1h" role="heading">Ne rien rater</div><style data-emotion="rpcss 1wbispj">.rpcss-1wbispj{font-size:18px;margin-bottom:10px;text-align:center;}</style><div aria-level="3" class="rpcss-1wbispj" role="heading">Sur les réseaux</div><style data-emotion="rpcss 1hyoz7m">.rpcss-1hyoz7m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;}</style><div class="rpcss-1hyoz7m"><a href="https://twitter.com/PutainDeCode"><img alt="Twitter" height="48" src="/public/images/website/twitter.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://facebook.com/putaindecode"><img alt="Facebook" height="48" src="/public/images/website/facebook.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://github.com/putaindecode"><img alt="Facebook" height="48" src="/public/images/website/github.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://itunes.apple.com/fr/podcast/putain-de-code-!/id1185311825"><img alt="Apple Podcast" height="48" src="/public/images/website/apple-podcast.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://soundcloud.com/putaindecode"><img alt="Soundcloud" height="48" src="/public/images/website/soundcloud.svg" width="48"/></a></div><div aria-level="3" class="rpcss-1wbispj" role="heading">Sur le chat</div><div class="rpcss-1hyoz7m"><a href="https://discord.gg/jtbGNNc"><img alt="Discord" height="48" src="/public/images/website/discord.svg" width="48"/></a></div></div></div></div><style data-emotion="rpcss zs8kw7">.rpcss-zs8kw7{background-color:#222;padding:20px 0;}</style><footer class="rpcss-zs8kw7"><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 79elbk">.rpcss-79elbk{position:relative;}</style><div class="rpcss-79elbk"><style data-emotion="rpcss 1hle0ni">.rpcss-1hle0ni{position:absolute;left:0;top:50%;color:#fff;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="rpcss-1hle0ni" href="/api/articles/feeds/desc/feed.xml"><style data-emotion="rpcss lvyu5j">.rpcss-lvyu5j{margin-right:10px;}</style><img class="rpcss-lvyu5j" alt="Flux RSS" height="16" src="/public/images/website/rss-feed.svg" width="16"/><style data-emotion="rpcss um3i31">@media (max-width: 400px){.rpcss-um3i31{display:none;}}</style><div class="rpcss-um3i31">Flux RSS</div></a><style data-emotion="rpcss 12cp4l7">.rpcss-12cp4l7{color:rgba(255, 255, 255, 0.5);text-align:center;font-size:14px;}</style><div class="rpcss-12cp4l7">© 2021 Putain de code !</div><style data-emotion="rpcss 1w98uy3">.rpcss-1w98uy3{position:absolute;right:0;top:50%;color:#fff;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="rpcss-1w98uy3" href="https://github.com/putaindecode/putaindecode.io">GitHub</a></div></div></div></footer></div><script id="initialData" type="text/data">{"lists":{"RE_PRIVATE_NONE":true},"items":{"k":"articles","v":{"k":"programmation-arduino-presentation-pour-les-debutants","v":{"_0":{"TAG":0,"_0":{"slug":"programmation-arduino-presentation-pour-les-debutants","filename":"2018-05-07-programmation-arduino-presentation-pour-les-debutants","title":"Programmation Arduino: présentation pour les débutants","date":"Mon, 07 May 2018 00:00:00 GMT","draft":false,"meta":{"date":"2018-05-07T00:00:00.000Z","title":"Programmation Arduino: présentation pour les débutants","author":"toxnico","oldSlug":"arduino/presentation-debutants","slug":"programmation-arduino-presentation-pour-les-debutants"},"body":"<h2>1. Mais qu'est-ce que c'est Arduino, d'abord?</h2>\n<h3>1.1. Photo d'une Uno</h3>\n<p>Arduino, ce sont des cartes électroniques programmables, avec un certain nombre\nd'entrées/sorties. Quoi ? c'est pas précis ? OK, je recommence.</p>\n<p>Une carte Arduino, ça ressemble (de manière non exhaustive, parce qu'il y a\nenormément de modèles et de clones) à ceci :</p>\n<p><img src=\"/public/images/articles/2018-05-07-programmation-arduino-presentation-pour-les-debutants/Arduino_Uno.jpg\" alt=\"Arduino Uno\" /></p>\n<p>C'est une carte électronique open source, constituée essentiellement de :</p>\n<ul>\n<li>un microcontrôleur fabriqué par Atmel,</li>\n<li>un port USB,</li>\n<li>des connecteurs d'entrés/sortie (plus ou moins nombreux selon les modèles).</li>\n</ul>\n<p>L'open hardware, par analogie à l'open software, permet de partager les plans\npour pouvoir répliquer, améliorer, comprendre un dispositif matériel.</p>\n<p>Arduino, c'est aussi un IDE (disons plutôt un éditeur de code) qui permet\nd'envoyer les programmes sur la carte à travers un port USB.</p>\n<p>Il est open source et <a href=\"https://www.arduino.cc/en/main/software\">disponible ici</a>.</p>\n<h3>1.2. Spécifications du matériel</h3>\n<p>Le modèle Uno présenté ici dispose, accrochez-vous, de :</p>\n<ul>\n<li>32 ko de mémoire pour stocker les programmes,</li>\n<li>2 ko de RAM, une EEPROM 1 ko pour stocker… 2 ou 3 trucs, typiquement des\nparamètres. Impossible d'y stocker des logs GPS, par exemple ;</li>\n<li>et tout ce petit monde est cadencé à la fréquence totalement dingo de 16 MHz !</li>\n</ul>\n<p>Tout ça pour la modique somme d'une vingtaine d'euros (pour les authentiques),\net une dizaine d'euros — voire moins — pour les clones.</p>\n<h3>1.3. Mais à quoi ça sert?</h3>\n<p>&quot;C'est quoi ces specs, c'est une blague ? Qu'est-ce qu'on peut faire d'un bidule\npareil aujourd'hui ?&quot;</p>\n<p>Eh bien on peut interagir avec le monde réel, car contrairement à un PC qui\ndispose de 3 ou 4 ports USB (et je ne parle même pas des Mac), une petite carte\ncomme celle-ci peut gérer des moteurs, des systèmes d'affichage, des capteurs\n(accéléromètres, température, pression atmosphérique, luminosité, et la liste\nest loin d'être exhaustive).</p>\n<p>Au final, ça sert à fabriquer des machines. Elles peuvent être autonomes,\ndiscuter entre elles ou avec un PC, et réagir à leur environnement.</p>\n<p>La grosse vague des imprimantes 3D a eu lieu grâce à ces petits bidules. La\nmienne tourne avec une ATMEGA 2560 comme celle-ci (on remarquera qu'il y a\nbeaucoup plus de pins sur celle-ci) :</p>\n<p><img src=\"/public/images/articles/2018-05-07-programmation-arduino-presentation-pour-les-debutants/Arduino_Mega2560.jpg\" alt=\"ATMEGA2560\" /></p>\n<p>Ma fraiseuse CNC dans le garage tourne avec une simple Arduino Uno, qui reçoit\nles commandes depuis un PC et pilote 3 axes avec des moteurs pas à pas assez\nbalaises.</p>\n<p>Le projet ArduPilot propose des firmwares et shields (extensions qui se\nconnectent directement sur la carte) destinés à gérer des drones (multicoptères,\navions, rovers) dans toutes leurs fonctions (moteurs, stabilisation, GPS,\naltimètre…)</p>\n<h3>1.4. Principe de fonctionnement</h3>\n<p>Le principe, rapidement évoqué dans la toute première phrase, est d'utiliser les\npins (i.e. les connecteurs numérotés que l'on peut voir sur la photo) pour lire\nou écrire des informations.</p>\n<p>OK, OK, les informations sont de très bas niveau, vu que c'est un signal soit de\n5 V, soit de 0 V.</p>\n<p>Un bit, quoi. Tout juste de quoi faire clignoter un LED (<strong>spoiler</strong> : c'est ce\nque nous allons faire tout de suite).</p>\n<p>Nous verrons plus tard que des protocoles de communication sont à notre\ndisposition pour ne pas se taper l'écriture des bits un par un sur une pin\n(c'est très sexuel comme terminologie hein).</p>\n<p><strong>Mais vous l'aurez compris, globalement, on va être dans de la programmation de\nbas niveau.</strong></p>\n<h2>2. Structure d'un programme, langages utilisés</h2>\n<p>Allez, assez de teasing, nous allons écrire notre premier programme !</p>\n<p>Le but ? faire clignoter une LED sur la carte. Ben oui, il faut commencer petit\npour bien saisir la structure d'un programme dans cet environnement.</p>\n<p>Le programme principal consiste en deux fonctions (ce sera toujours le cas),\ndont voici les signatures ultra simples :</p>\n<ul>\n<li>void setup()</li>\n<li>void loop()</li>\n</ul>\n<p><code>setup()</code> est appelée une seule fois, au moment de la mise sous tension de la\ncarte. <code>loop()</code> est appelée, comme son nom l'indique, en boucle. Elle est lancée\naprès <code>setup()</code>, et tourne à fond à l'infini (tant que la carte est alimentée en\ntout cas).</p>\n<p>Ah j'oubliais : le langage de programmation utilisé est au choix le C, ou le\nC<ins>. J'ai un faible pour le C</ins> pour sa relative simplicité par rapport au C\npur.</p>\n<p>Donc pour reprendre sur notre programme de base, on a quelque chose comme ça :</p>\n<pre><code class=\"hljs language-C\"><span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">main</span><span class=\"hljs-params\">()</span></span>{\n    setup();\n\n    <span class=\"hljs-keyword\">while</span>(<span class=\"hljs-literal\">true</span>)\n        loop();\n}\n</code></pre>\n<p>En pratique, nous n'implémenterons que les deux fonctions <code>setup()</code> et <code>loop()</code>.\nLe <code>main()</code> est généré par le compilateur.</p>\n<p>Allez, assez discuté, passons à notre programme, le grand classique <strong>Blink</strong>:</p>\n<pre><code class=\"hljs language-C\"><span class=\"hljs-keyword\">int</span> led = <span class=\"hljs-number\">13</span>;\n\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">setup</span><span class=\"hljs-params\">()</span> </span>{\n  pinMode(led, OUTPUT);      <span class=\"hljs-comment\">// Définit la pin 13 comme pin de sortie</span>\n}\n\n<span class=\"hljs-comment\">// the loop routine runs over and over again forever:</span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">loop</span><span class=\"hljs-params\">()</span> </span>{\n  digitalWrite(led, HIGH);   <span class=\"hljs-comment\">// Allume la LED</span>\n  delay(<span class=\"hljs-number\">1000</span>);               <span class=\"hljs-comment\">// Attend une seconde</span>\n  digitalWrite(led, LOW);    <span class=\"hljs-comment\">// Eteint la LED</span>\n  delay(<span class=\"hljs-number\">1000</span>);               <span class=\"hljs-comment\">// Attend une seconde</span>\n}\n</code></pre>\n<p>Dans ce programme, on fait usage de 3 fonctions de la librairie standard :</p>\n<ul>\n<li><code>pinMode(pinNumber, mode)</code> : définit le mode de fonctionnement d'une pin. À la\nlouche, soit INPUT, soit OUTPUT ;</li>\n<li><code>digitalWrite(pinNumber, value)</code> : si la pin est définie en OUTPUT, cette\ninstruction permet d'écrire 1 ou 0. Si on mesure avec un voltmètre la tension\nentre la pin et la masse, on aura +5 V ou 0 V. HIGH et LOW sont des constantes\nprédéfinies, mais 1 ou 0 fonctionneraient aussi ;</li>\n<li>delay(ms) : cette instruction bloque l'exécution du programme (de <strong>tout</strong> le\nprogramme) pendant une durée donnée en millisecondes.</li>\n</ul>\n<p>La pin 13 est très pratique, car elle est reliée à une LED intégrée à la carte.\nDu coup, dès qu'on active ou désactive la 13, une petite LED orange s'allume ou\ns'éteint.</p>\n<h2>3. Instructions de base</h2>\n<p>Nous venons de voir au paragraphe précédent 2 instructions qui permettent\nd'envoyer une information en sortie (dans ce cas, faire clignoter une LED. Paye\nta gloire.)</p>\n<p>On peut aussi <strong>lire</strong> une information venant de l'extérieur, avec\n<code>digitalRead(pinNumber)</code>.</p>\n<p>Ca va permettre par exemple de savoir si un bouton poussoir est appuyé ou pas,\nsi une porte est ouverte ou fermée, etc.</p>\n<p>Par exemple, on pourrait écrire ceci :</p>\n<pre><code class=\"hljs language-C\"><span class=\"hljs-keyword\">int</span> ledPin = <span class=\"hljs-number\">13</span>;   <span class=\"hljs-comment\">// LED sur la pin 13</span>\n<span class=\"hljs-keyword\">int</span> btnPin = <span class=\"hljs-number\">7</span>;     <span class=\"hljs-comment\">// bouton poussoir sur la pin 7</span>\n\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">setup</span><span class=\"hljs-params\">()</span>\n</span>{\n  pinMode(ledPin, OUTPUT);\n  pinMode(btnPin, INPUT);\n}\n\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">loop</span><span class=\"hljs-params\">()</span>\n</span>{\n  <span class=\"hljs-keyword\">int</span> val = digitalRead(btnPin);     <span class=\"hljs-comment\">// lit l&#x27;état du bouton</span>\n  digitalWrite(ledPin, val);    <span class=\"hljs-comment\">// allume la LED en fonction de l&#x27;état du bouton</span>\n}\n</code></pre>\n<p>Je vous vois venir : &quot;Oui, mais tu te fous un peu de nous là, on n'a qu'à\nconnecter la LED directement au bouton !&quot;</p>\n<p>La réponse est oui. Mais si je voulais introduire un délai entre l'appui sur le\nbouton et l'allumage de la LED, ça commence à devenir intéressant.</p>\n<p>Ou bien si l'allumage dépend d'autres capteurs branchés sur d'autres pins, comme\npar exemple une photorésistance. On pourrait faire en sorte que la LED ne\ns'allume que si la luminosité ambiante est suffisamment faible.</p>\n<p>Mais comment savoir si la luminosité est suffisamment faible, alors que jusqu'à\nmaintenant on n'est capable de lire que HIGH ou LOW ? Grâce à\n<code>analogRead(pinNumber)</code>, bien sûr !</p>\n<p>Sur la carte en photo on peut voir une série de pins notées de A0 à A5, et leur\nparticularité, c'est qu'elles peuvent transformer un signal analogique (une\ntension entre 0 et 5 V) en un entier de 0 à 1023.</p>\n<p>Par exemple, si une photorésistance est branchée entre le +5 V et la pin A0, on\npeut obtenir la luminosité ambiante avec :</p>\n<pre><code class=\"hljs language-C\"><span class=\"hljs-comment\">// Pas besoin de faire un pinMode() dans le cas d&#x27;une lecture analogique.</span>\n<span class=\"hljs-keyword\">int</span> ambientBrightness = analogRead(A0);\n</code></pre>\n<p>Donc pour allumer la LED uniquement si le bouton est pressé <strong>ET</strong> que la\nluminosité ambiante est suffisamment basse (seuil à déterminer empiriquement,\ndisons 600):</p>\n<pre><code class=\"hljs language-C\"><span class=\"hljs-keyword\">int</span> ledPin = <span class=\"hljs-number\">13</span>;   <span class=\"hljs-comment\">// LED sur la pin 13</span>\n<span class=\"hljs-keyword\">int</span> btnPin = <span class=\"hljs-number\">7</span>;     <span class=\"hljs-comment\">// Bouton poussoir sur la pin 7</span>\n<span class=\"hljs-keyword\">int</span> photoResPin = A0; <span class=\"hljs-comment\">// A0 est une constante utilisable directement</span>\n<span class=\"hljs-keyword\">int</span> threshold = <span class=\"hljs-number\">600</span>;\n\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">setup</span><span class=\"hljs-params\">()</span>\n</span>{\n  pinMode(ledPin, OUTPUT);\n  pinMode(btnPin, INPUT);\n  <span class=\"hljs-comment\">// On éteint la LED à l&#x27;initialisation:</span>\n  digitalWrite(ledPin, LOW);\n}\n\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">loop</span><span class=\"hljs-params\">()</span>\n</span>{\n  <span class=\"hljs-comment\">//lecture du bouton</span>\n  <span class=\"hljs-keyword\">int</span> val = digitalRead(btnPin);     <span class=\"hljs-comment\">// Lit l&#x27;état du bouton</span>\n\n  <span class=\"hljs-comment\">//lecture de la luminosité</span>\n  <span class=\"hljs-keyword\">int</span> ambientBrightness = analogRead(A0);\n\n  <span class=\"hljs-keyword\">if</span>((val == HIGH &amp;&amp; ambientBrightness &lt; threshold) || val == LOW)\n    digitalWrite(ledPin, val);    <span class=\"hljs-comment\">// Allume la LED en fonction de l&#x27;état du bouton ET de la luminosité</span>\n}\n</code></pre>\n<p>Si j'étais joueur, je permettrais à l'utilisateur de régler le seuil avec un\npotentiomètre relié à une autre entrée analogique, histoire de ne pas le coder\nen dur… Mais comme je suis un gros fainéant et que je vois des étoiles briller\ndans vos yeux, je vais vous laisser y réfléchir. :)</p>\n<h2>4. Résumé de cette première session</h2>\n<p>Un petit doliprane ou ça va ?</p>\n<p>Pour résumer cette session, voici ce qu'il faut retenir :</p>\n<ul>\n<li>Arduino est une plateforme pour programmer des cartes électroniques\n(communément appelés microcontrôleurs),</li>\n<li>on programme en C ou en C++,</li>\n<li>nous avons des fonctions à disposition pour lire des entrées et écrire sur des\nsorties (la plupart des pins sont réversibles d'ailleurs) ;</li>\n<li>il y a peu de mémoire à disposition, donc l'optimisation des programmes sera\ncruciale pour des projets complexes.</li>\n</ul>\n<p><em>Crédits images : <a href=\"https://commons.wikimedia.org\">https://commons.wikimedia.org</a>, <a href=\"https://www.arduino.cc\">https://www.arduino.cc</a></em></p>\n"}}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"listsRequests":{"data":{"RE_PRIVATE_NONE":true}},"itemsRequests":{"data":{"RE_PRIVATE_NONE":true}}}</script><head><script defer="defer" src="/public/main.56c69761a03eb0112696.js"></script></head></html>