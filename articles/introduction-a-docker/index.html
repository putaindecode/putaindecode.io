<!DOCTYPE html><html lang="fr"><head><title data-react-helmet="true">Introduction à Docker | Putain de code</title><meta data-react-helmet="true" charset="UTF-8"/><meta data-react-helmet="true" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover" name="viewport"/><meta data-react-helmet="true" content="summary_large_image" name="twitter:card"/><meta data-react-helmet="true" content="Putain de code !" property="og:site_name"/><meta data-react-helmet="true" content="@putaindecode" name="twitter:site"/><meta data-react-helmet="true" content="https://putaindecode.io/public/images/website/share.jpg" property="og:image"/><meta data-react-helmet="true" content="https://putaindecode.io/public/images/website/share.jpg" name="twitter:image"/><meta data-react-helmet="true" content="1500" property="og:image:width"/><meta data-react-helmet="true" content="777" property="og:image:height"/><meta data-react-helmet="true" content="Introduction à Docker | Putain de code" property="og:title"/><meta data-react-helmet="true" content="Introduction à Docker | Putain de code" name="twitter:title"/><meta data-react-helmet="true" content="Un article proposé par Uhsac" name="description"/><link data-react-helmet="true" title="RSS Feed" href="/api/articles/feeds/desc/feed.xml" rel="alternate" type="application/rss+xml"/><link data-react-helmet="true" href="/favicon.ico" rel="shortcut icon"/><link data-react-helmet="true" href="https://putaindecode.io/articles/introduction-a-docker" rel="canonical"/><script>window.PAGES_BOOT_MODE="hydrate";</script></head><div id="root"><style data-emotion="rpcss zx73cm 1lc6tyj 28v1b4">@-webkit-keyframes animation-zx73cm{from{opacity:0;-webkit-transform:translateY(20px);-moz-transform:translateY(20px);-ms-transform:translateY(20px);transform:translateY(20px);}}@keyframes animation-zx73cm{from{opacity:0;-webkit-transform:translateY(20px);-moz-transform:translateY(20px);-ms-transform:translateY(20px);transform:translateY(20px);}}:root{--page-background-color:#fff;--page-slightly-accented-background-color:#F9F6F6;--page-accented-background-color:#E4EBEE;--page-text-color:#46515B;--link-text-color:#E51D58;--gradient-red-top:#E51D58;--gradient-red-bottom:#CC0613;--code-background-color:#FAF3E1;--one-percent-contrast-color:rgba(0, 0, 0, 0.1);--half-percent-contrast-color:rgba(0, 0, 0, 0.05);}@media (prefers-color-scheme: dark){:root{--page-background-color:#222;--page-slightly-accented-background-color:#171717;--page-accented-background-color:#111;--page-text-color:#ddd;--link-text-color:#F87098;--gradient-red-top:#E51D58;--gradient-red-bottom:#CC0613;--code-background-color:#4F3804;--one-percent-contrast-color:rgba(255, 255, 255, 0.1);--half-percent-contrast-color:rgba(255, 255, 255, 0.05);}}body{padding:0;margin:0;background-color:var(--page-background-color);color:var(--page-text-color);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;overflow-x:hidden;}html{font-size:1em;line-height:1.4;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%;}a{color:var(--link-text-color);-webkit-text-decoration:underline;text-decoration:underline;}a:hover{-webkit-text-decoration:none;text-decoration:none;}#root{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}*,*:before,*:after{box-sizing:border-box;}pre,.hljs{color:#adbac7;background:#22272e;}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#f47067;}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#dcbdfb;}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-variable,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id{color:#6cb6ff;}.hljs-regexp,.hljs-string,.hljs-meta .hljs-string{color:#96d0ff;}.hljs-built_in,.hljs-symbol{color:#f69d50;}.hljs-comment,.hljs-code,.hljs-formula{color:#768390;}.hljs-name,.hljs-quote,.hljs-selector-tag,.hljs-selector-pseudo{color:#8ddb8c;}.hljs-subst{color:#adbac7;}.hljs-section{color:#316dca;font-weight:bold;}.hljs-bullet{color:#eac55f;}.hljs-emphasis{color:#adbac7;font-style:italic;}.hljs-strong{color:#adbac7;font-weight:bold;}.hljs-addition{color:#b4f1b4;background-color:#1b4721;}.hljs-deletion{color:#ffd8d3;background-color:#78191b;}</style><style data-emotion="rpcss 9vhaby">.rpcss-9vhaby{background-color:var(--gradient-red-bottom);background-image:linear-gradient(to bottom right, var(--gradient-red-top), var(--gradient-red-bottom));}</style><header class="rpcss-9vhaby" style="background-image:linear-gradient(to bottom right, hsl(176, 100%, 35%), hsl(147, 100%, 30%))"><style data-emotion="rpcss 1qqk0tr">.rpcss-1qqk0tr{padding-left:env(safe-area-inset-left);padding-right:env(safe-area-inset-right);}</style><div class="rpcss-1qqk0tr"><style data-emotion="rpcss qx7dny">.rpcss-qx7dny{width:100%;max-width:1024px;margin:0 auto;padding:0 10px;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;}</style><div class="rpcss-qx7dny"><style data-emotion="rpcss 7s9om2">.rpcss-7s9om2{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding:20px 0 50px;}</style><div class="rpcss-7s9om2"><style data-emotion="rpcss gdpa5c">.rpcss-gdpa5c{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-text-decoration:none;text-decoration:none;}</style><a class="rpcss-gdpa5c" href="/"><style data-emotion="rpcss 1lm4738">.rpcss-1lm4738{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-text-decoration:none;text-decoration:none;padding-bottom:10px;}</style><div class="rpcss-1lm4738"><style data-emotion="rpcss 13o7eu2">.rpcss-13o7eu2{display:block;}</style><svg class="rpcss-13o7eu2" height="36px" width="36px" viewBox="0 0 36 36"><defs><linearGradient id="PutainDeCodeLogoGradient" x1="50%" x2="50%" y1="0%" y2="127.223881%"><stop offset="0%" stop-color="#E41D57"></stop><stop offset="100%" stop-color="#C60000"></stop></linearGradient></defs><circle cx="18" cy="18" fill="url(#PutainDeCodeLogoGradient)" r="17" stroke="#FFFFFF" stroke-width="2"></circle><polygon fill="#FFFFFF" points="15.9033203 18.2246094 15.9033203 18.3710938 11.2304688 20.5317383 11.2304688 22.8095703 18.0566406 19.184082 18.0566406 17.4116211 11.2304688 13.7788086 11.2304688 16.0639648"></polygon><rect height="14" width="2" fill="#FFFFFF" x="22" y="11"><animate attributeName="opacity" begin="100ms" calcMode="discrete" dur="2s" repeatCount="indefinite" values="1;0"></animate></rect></svg><style data-emotion="rpcss 4cf197">.rpcss-4cf197{width:10px;height:10px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}</style><div class="rpcss-4cf197"></div><style data-emotion="rpcss u5k24">.rpcss-u5k24{font-size:22px;color:#fff;font-weight:800;}</style><div aria-level="2" class="rpcss-u5k24" role="heading">Putain de code !</div></div><style data-emotion="rpcss 1nyebg4">.rpcss-1nyebg4{font-size:14px;color:rgba(255, 255, 255, 0.8);text-align:center;}</style><div class="rpcss-1nyebg4">Blog participatif de la communauté dev</div></a></div></div></div></header><style data-emotion="rpcss a4ric9">.rpcss-a4ric9{background-color:var(--page-slightly-accented-background-color);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}</style><div class="rpcss-a4ric9"><style data-emotion="rpcss oeugsb">.rpcss-oeugsb{-webkit-animation:500ms ease-out animation-zx73cm;animation:500ms ease-out animation-zx73cm;}</style><div class="rpcss-oeugsb"><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 1qc2bam">.rpcss-1qc2bam{font-size:42px;font-weight:800;text-align:center;padding-top:40px;line-height:1.2;margin:0;}</style><h1 class="rpcss-1qc2bam">Introduction à Docker</h1><style data-emotion="rpcss obg2kr">.rpcss-obg2kr{font-size:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding-top:10px;padding-bottom:40px;color:var(--page-text-color);-webkit-text-decoration:none;text-decoration:none;}</style><a class="rpcss-obg2kr" href="https://github.com/Uhsac"><style data-emotion="rpcss uco8i7">.rpcss-uco8i7{width:32px;height:32px;border-radius:100%;margin-right:10px;}</style><img class="rpcss-uco8i7" alt="Uhsac" src="https://avatars.githubusercontent.com/Uhsac?size=64"/><div>Uhsac<!-- --> <!-- -->•<!-- --> <!-- -->2015/06/11</div></a><style data-emotion="rpcss 15kxmi0">.rpcss-15kxmi0{max-width:640px;width:100%;font-size:18px;margin:0 auto;line-height:1.7;}.rpcss-15kxmi0 h2,.rpcss-15kxmi0 h3,.rpcss-15kxmi0 h4,.rpcss-15kxmi0 h5,.rpcss-15kxmi0 h6{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;font-weight:800;line-height:1.2;}.rpcss-15kxmi0 img{max-width:100%;background-color:rgba(255, 255, 255, 0.75);}.rpcss-15kxmi0 code{font-size:0.9em;font-family:PragmataPro,SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;line-height:1;background-color:var(--code-background-color);margin:0 0.2em;}.rpcss-15kxmi0 pre{padding:10px;overflow-x:auto;font-size:14px;border-radius:10px;border:2px solid var(--one-percent-contrast-color);-webkit-overflow-scrolling:touch;}.rpcss-15kxmi0 pre code{font-size:14px;background-color:transparent;margin:0;}.rpcss-15kxmi0 blockquote{padding-left:20px;margin:0;font-size:16px;border-left:3px solid var(--one-percent-contrast-color);font-style:italic;}.rpcss-15kxmi0 table{width:100%;text-align:center;}.rpcss-15kxmi0 figure{padding:20px 0;}.rpcss-15kxmi0 figcaption{text-align:center;}.rpcss-15kxmi0 a{word-wrap:break-word;}.rpcss-15kxmi0 table thead th{background-color:var(--page-accented-background-color);padding:10px 0;}</style><div class="rpcss-15kxmi0"><p>Avant de vous parler de Docker je vais vous raconter une histoire que tout
développeur a vécu au moins une fois.</p>
<p>Il était une fois un jeune développeur qui codait tranquillement sur son
ordinateur. Il était pressé car comme tout étudiant qui se respecte il devait
présenter son travail le lendemain matin. Après des heures de travail,
l'application était là, et elle fonctionnait à merveille ! Le lendemain, notre
codeur arriva tout fier pour sa présentation, avec son projet sur une clé usb.
Il le transfère sur l'ordinateur de son pote et là, ça ne fonctionne pas !</p>
<h2>Quel est le problème ?</h2>
<p>L'application de notre jeune développeur ne fonctionne pas sur l'ordinateur de
son ami à cause d'un problème d'environnement. Entre deux systèmes, il peut y
avoir des différences de version sur les dépendances ou encore des bibliothèques
manquantes.</p>
<p>Ici, notre problème se limite à 2 systèmes, mais imaginez une équipe de 10
personnes avec des ordinateurs sous OS X, Linux ou même Windows, un serveur de
test sous Ubuntu 12.04, et un serveur de production sous CentOS 7. S'assurer que
leur application fonctionne bien sur tous ces environnements peut s'avérer être
un vrai cauchemar !</p>
<p>Mais il existe des solutions et parmi l'une d'entre elles nous avons...</p>
<h2>Docker</h2>
<h3>C'est quoi Docker ?</h3>
<p>Docker est une plateforme qui va vous permettre d'exécuter votre code à
l'intérieur d'un conteneur indépendamment de la machine sur laquelle vous êtes !
Un conteneur ressemble à une machine virtuelle sauf qu'il n'embarque pas tout un
système d'exploitation avec lui ce qui lui permet de s'exécuter en quelque
secondes et d'être beaucoup plus léger.</p>
<p>Docker peut donc résoudre notre problème d'environnement, car quelle que soit la
machine que nous utiliserons, le code s'exécutera de la même manière.</p>
<p>La plateforme Docker est composée de deux éléments :</p>
<ul>
<li>Le démon Docker qui s'exécute en arrière-plan et qui s'occupe de gérer vos
conteneurs</li>
<li>Le client Docker qui vous permet d'interagir avec le démon par l'intermédiaire
d'un outil en ligne de commande</li>
</ul>
<p>Si vous voulez plus d'informations sur le fonctionnement interne de Docker je
vous redirige vers l'article du site officiel :
<a href="https://docs.docker.com/engine/understanding-docker/">Understanding Docker</a></p>
<h3>Comment l'installer ?</h3>
<p>Le client Docker fonctionne sur tous les systèmes d'exploitation. En revanche,
le démon Docker utilise des fonctionnalités du noyau Linux afin de gérer les
conteneurs. Il ne fonctionne donc que sur Linux. Heureusement la majorité des
serveurs utilise Linux, et pour vos ordinateurs sous OS X, ou même Windows, il
existe une solution.</p>
<p>Si vous utilisez une machine avec une distribution Linux vous pourrez lancer le
démon Docker directement sur cette dernière, par contre avec Windows ou OS X
vous devrez lancer le démon dans une machine virtuelle, mais rassurez-vous,
c'est très simple !</p>
<p>Pour le guide d'installation de Docker en fonction de votre système je vous
redirige de nouveau vers le site officiel :
<a href="https://docs.docker.com/installation/#installation">Guide d'installation</a></p>
<h3>Un premier exemple</h3>
<p>Avant de commencer, vous allez devoir télécharger une image Docker qui servira
de base à vos prochains conteneurs.</p>
<p>Pour cet exemple, on va partir d'une image Ubuntu :</p>
<pre><code class="hljs language-console"><span class="hljs-meta">$</span><span class="bash"> docker pull ubuntu:trusty</span>
trusty: Pulling from ubuntu
e9e06b06e14c: Pull complete
a82efea989f9: Pull complete
37bea4ee0c81: Pull complete
07f8e8c5e660: Already exists
ubuntu:trusty: The image you are pulling has been verified. Important: image verification is a tech preview feature and should not be relied on to provide security.
Digest: sha256:014fa1d5b72b4fe0ec2b4642610fbbfdd52f502da8e14e80de07bd1dd774e4ef
Status: Downloaded newer image for ubuntu:trusty
</code></pre>
<p>Cette commande va télécharger depuis le Docker Hub l'image de la version 14.04
(trusty) d'Ubuntu. Il existe bien d'autres images que vous pourrez trouver
<a href="https://registry.hub.docker.com">sur le registry Docker</a>.</p>
<p>Pour voir les images que vous avez téléchargées, utilisez cette commande :</p>
<pre><code class="hljs language-console"><span class="hljs-meta">$</span><span class="bash"> docker images</span>
REPOSITORY    TAG       IMAGE ID        CREATED       VIRTUAL SIZE
ubuntu        trusty    07f8e8c5e660    4 weeks ago   188.3 MB
</code></pre>
<p>Sur ma machine, l'image d'Ubuntu fais 188.3 MB, je vous avais dit que c'était
léger en comparaison à une machine virtuelle !</p>
<p>Maintenant, nous allons lancer un conteneur et rentrer à l'intérieur :</p>
<pre><code class="hljs language-console"><span class="hljs-meta">$</span><span class="bash"> docker run -it ubuntu:trusty bash</span>
root@2cdceb5ff771:/#
</code></pre>
<p>Cette commande crée un conteneur à partir de l'image <code>ubuntu:trusty</code>, y lance le
programme <code>bash</code> et y attache votre shell grâce aux options <code>-it</code></p>
<p>Vous pouvez maintenant exécuter les commandes que vous voulez, elle
s'exécuteront à l'intérieur du conteneur, par exemple :</p>
<pre><code class="hljs language-console">root@2cdceb5ff771:/#
<span class="hljs-meta">$</span><span class="bash"> apt-get moo</span>
                 (__)
                 (oo)
           /------\/
          / |    ||
         *  /\---/\
            ~~   ~~
...&quot;Have you mooed today?&quot;...
</code></pre>
<p>Vous pouvez quitter le conteneur en faisant un <code>Ctrl-d</code></p>
<p>Maintenant que vous êtes retourné sur votre machine, vous pouvez afficher la
liste des conteneurs lancés avec cette commande :</p>
<pre><code class="hljs language-console"><span class="hljs-meta">$</span><span class="bash"> docker ps</span>
CONTAINER ID    IMAGE   COMMAND   CREATED   STATUS    PORTS   NAMES
</code></pre>
<p>Il n'y a rien ? C'est normal ! En quittant le conteneur ce dernier s'est arrêté
aussi. Pour l'afficher quand même, il suffit d'entrer cette commande :</p>
<pre><code class="hljs language-console"><span class="hljs-meta">$</span><span class="bash"> docker ps -a</span>
CONTAINER ID    IMAGE           COMMAND   CREATED         STATUS                    PORTS   NAMES
2cdceb5ff771    ubuntu:trusty   &quot;bash&quot;    12 minutes ago  Exited (0) 2 minutes ago          loving_newton
</code></pre>
<p>Et pour supprimer ce conteneur ?</p>
<pre><code class="hljs language-console"><span class="hljs-meta">$</span><span class="bash"> docker rm 2cdc</span>
2cdc
</code></pre>
<p>Évidemment, remplacez '2cdc' par le <code>CONTAINER ID</code> approprié.</p>
<p>Passons maintenant à un deuxième exemple plus concret avec une application web.</p>
<h2>Un deuxième exemple avec Node.js</h2>
<p>Pour commencer, vous allez récupérer l'image docker officiel de Node.js en
faisant :</p>
<pre><code class="hljs language-console"><span class="hljs-meta">$</span><span class="bash"> docker pull node:0.12.4</span>
0.12.4: Pulling from node
7711db4bb553: Pull complete
d1744e6e9471: Pull complete
9332645b03a3: Pull complete
a52a290821b3: Pull complete
3575f1347ce7: Already exists
39bb80489af7: Already exists
df2a0347c9d0: Already exists
7a3871ba15f8: Already exists
a2703ed272d7: Already exists
c9e3effdd23a: Already exists
node:0.12.4: The image you are pulling has been verified. Important: image verification is a tech preview feature and should not be relied on to provide security.
Digest: sha256:81fb0812dd5e81f768773a121c8a6daced36893210c5ed50b504c4abcb04e10c
Status: Downloaded newer image for node:0.12.4
</code></pre>
<p>Puis créez un fichier <code>server.js</code> avec le contenu suivant :</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">var</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;http&quot;</span>);

<span class="hljs-keyword">var</span> server = http.createServer(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{
  res.end(<span class="hljs-string">&quot;Coucou depuis Docker&quot;</span>);
});

server.listen(<span class="hljs-number">3000</span>);
</code></pre>
<p>Et maintenant, pour lancer notre application à l'intérieur d'un conteneur, vous
devez faire :</p>
<pre><code class="hljs language-console"><span class="hljs-meta">$</span><span class="bash"> docker run -d --name node-app -p 3000:3000 -v $(<span class="hljs-built_in">pwd</span>):/app node:0.12.4 node /app/server.js</span>
e9ca3cd8f90b8554ca99ec8ba15a039f827005bd8fecbf80d72ce7267006a6df
</code></pre>
<p>Si vous vous rendez sur <code>localhost:3000</code> (ou l'IP de la VM si êtes sur Windows
ou Mac), vous verrez : 'Coucou depuis Docker'</p>
<p>C'est beau, mais comment ça marche ? Examinons les options une par une :</p>
<ul>
<li><code>-d</code> : cette option permet de lancer le conteneur en mode démon et donc de
tourner en tâche de fond à la différence de <code>-it</code> qui lançait le conteneur au
premier plan et nous donnait un accès direct au conteneur.</li>
<li><code>--name node-app</code> : cette option permet simplement de nommer notre conteneur,
ce qui peut servir pour l'arrêter et le relancer plus simplement (et à
d'autres choses plus complexes dont je parlerai dans un prochain article).</li>
<li><code>-p 3000:3000</code> : cette option permet de partager le port de votre machine avec
le port du conteneur. Le premier nombre est le port de votre machine et le
deuxième le port dans le conteneur.</li>
<li><code>-v $(pwd):/app</code> : cette option permet de partager un dossier avec votre
conteneur, ici, nous partageons le dossier courant (où se trouve notre fichier
<code>server.js</code>) avec le dossier <code>/app</code> dans le conteneur (attention si vous êtes
sur Mac ou Windows uniquement votre 'home' est partagé).</li>
<li><code>node:0.12.4</code> : l'image Docker que vous voulez utiliser.</li>
<li><code>node /app/server.js</code> : la commande à exécuter dans le conteneur.</li>
</ul>
<p>Et maintenant ? Vous pouvez afficher le conteneur en faisant : <code>docker ps</code>,
l'arrêter avec : <code>docker stop node-app</code> et le supprimer avec
<code>docker rm node-app</code>.</p>
<hr />
<p>Dans cet article, nous avons vu comment récupérer des images Docker depuis le
Docker Hub et comment les instancier afin de créer des conteneurs. Mais pour
aller plus loin, ce serait bien si nous pouvions créer nos propres images, c'est
ce que nous apprendrons à faire à l'aide des Dockerfile dans le prochain
article.</p>
</div><style data-emotion="rpcss unyj6i">.rpcss-unyj6i{max-width:640px;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin:20px auto;padding:20px;background-color:var(--page-background-color);border-radius:10px;box-shadow:0 15px 15px -5px rgba(0, 0, 0, 0.2);}@media (max-width: 540px){.rpcss-unyj6i{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><div class="rpcss-unyj6i"><style data-emotion="rpcss ty7r4z">.rpcss-ty7r4z{font-weight:800;}</style><div class="rpcss-ty7r4z">Vous avez aimé cet article?</div><style data-emotion="rpcss klacsp">.rpcss-klacsp{width:0;height:10px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}</style><div class="rpcss-klacsp"></div><style data-emotion="rpcss 1pkr03v">.rpcss-1pkr03v{background-color:#00aced;color:#fff;padding:10px 20px;-webkit-text-decoration:none;text-decoration:none;border-radius:5px;font-weight:800;}.rpcss-1pkr03v:active{opacity:0.5;}</style><a class="rpcss-1pkr03v" href="https://www.twitter.com/intent/tweet?text=Introduction%20%C3%A0%20Docker%20sur%20%40PutainDeCode%20https%3A%2F%2Fputaindecode.io%2Farticles%2Fintroduction-a-docker" target="_blank">Le partager sur Twitter</a></div><style data-emotion="rpcss x4iqxe">.rpcss-x4iqxe{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;text-align:center;padding:20px;}</style><div class="rpcss-x4iqxe"><style data-emotion="rpcss gein6x">.rpcss-gein6x{font-size:20px;-webkit-text-decoration:none;text-decoration:none;color:#1E49B5;}</style><a class="rpcss-gein6x" href="/articles">← Articles</a></div><style data-emotion="rpcss 8bodgl">.rpcss-8bodgl{max-width:640px;width:100%;margin:0 auto;padding:20px 0;}</style><div class="rpcss-8bodgl" id="disqus_thread"></div></div></div></div></div><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 1vau6rl">.rpcss-1vau6rl{margin:20px 0;background-color:var(--page-accented-background-color);border-radius:10px;padding:20px;}</style><div class="rpcss-1vau6rl"><style data-emotion="rpcss 1gz1i1h">.rpcss-1gz1i1h{font-size:32px;font-weight:800;margin-bottom:20px;text-align:center;}</style><div aria-level="2" class="rpcss-1gz1i1h" role="heading">Ne rien rater</div><style data-emotion="rpcss 1wbispj">.rpcss-1wbispj{font-size:18px;margin-bottom:10px;text-align:center;}</style><div aria-level="3" class="rpcss-1wbispj" role="heading">Sur les réseaux</div><style data-emotion="rpcss 1hyoz7m">.rpcss-1hyoz7m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;}</style><div class="rpcss-1hyoz7m"><a href="https://twitter.com/PutainDeCode"><img alt="Twitter" height="48" src="/public/images/website/twitter.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://facebook.com/putaindecode"><img alt="Facebook" height="48" src="/public/images/website/facebook.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://github.com/putaindecode"><img alt="Facebook" height="48" src="/public/images/website/github.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://itunes.apple.com/fr/podcast/putain-de-code-!/id1185311825"><img alt="Apple Podcast" height="48" src="/public/images/website/apple-podcast.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://soundcloud.com/putaindecode"><img alt="Soundcloud" height="48" src="/public/images/website/soundcloud.svg" width="48"/></a></div><div aria-level="3" class="rpcss-1wbispj" role="heading">Sur le chat</div><div class="rpcss-1hyoz7m"><a href="https://discord.gg/jtbGNNc"><img alt="Discord" height="48" src="/public/images/website/discord.svg" width="48"/></a></div></div></div></div><style data-emotion="rpcss zs8kw7">.rpcss-zs8kw7{background-color:#222;padding:20px 0;}</style><footer class="rpcss-zs8kw7"><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 79elbk">.rpcss-79elbk{position:relative;}</style><div class="rpcss-79elbk"><style data-emotion="rpcss 1hle0ni">.rpcss-1hle0ni{position:absolute;left:0;top:50%;color:#fff;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="rpcss-1hle0ni" href="/api/articles/feeds/desc/feed.xml"><style data-emotion="rpcss lvyu5j">.rpcss-lvyu5j{margin-right:10px;}</style><img class="rpcss-lvyu5j" alt="Flux RSS" height="16" src="/public/images/website/rss-feed.svg" width="16"/><style data-emotion="rpcss um3i31">@media (max-width: 400px){.rpcss-um3i31{display:none;}}</style><div class="rpcss-um3i31">Flux RSS</div></a><style data-emotion="rpcss 12cp4l7">.rpcss-12cp4l7{color:rgba(255, 255, 255, 0.5);text-align:center;font-size:14px;}</style><div class="rpcss-12cp4l7">© 2021 Putain de code !</div><style data-emotion="rpcss 1w98uy3">.rpcss-1w98uy3{position:absolute;right:0;top:50%;color:#fff;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="rpcss-1w98uy3" href="https://github.com/putaindecode/putaindecode.io">GitHub</a></div></div></div></footer></div><script id="initialData" type="text/data">{"lists":{"RE_PRIVATE_NONE":true},"items":{"k":"articles","v":{"k":"introduction-a-docker","v":{"_0":{"TAG":0,"_0":{"slug":"introduction-a-docker","filename":"2015-06-11-introduction-a-docker","title":"Introduction à Docker","date":"Thu, 11 Jun 2015 00:00:00 GMT","draft":false,"meta":{"date":"2015-06-11T00:00:00.000Z","title":"Introduction à Docker","author":"Uhsac","oldSlug":"docker","slug":"introduction-a-docker"},"body":"<p>Avant de vous parler de Docker je vais vous raconter une histoire que tout\ndéveloppeur a vécu au moins une fois.</p>\n<p>Il était une fois un jeune développeur qui codait tranquillement sur son\nordinateur. Il était pressé car comme tout étudiant qui se respecte il devait\nprésenter son travail le lendemain matin. Après des heures de travail,\nl'application était là, et elle fonctionnait à merveille ! Le lendemain, notre\ncodeur arriva tout fier pour sa présentation, avec son projet sur une clé usb.\nIl le transfère sur l'ordinateur de son pote et là, ça ne fonctionne pas !</p>\n<h2>Quel est le problème ?</h2>\n<p>L'application de notre jeune développeur ne fonctionne pas sur l'ordinateur de\nson ami à cause d'un problème d'environnement. Entre deux systèmes, il peut y\navoir des différences de version sur les dépendances ou encore des bibliothèques\nmanquantes.</p>\n<p>Ici, notre problème se limite à 2 systèmes, mais imaginez une équipe de 10\npersonnes avec des ordinateurs sous OS X, Linux ou même Windows, un serveur de\ntest sous Ubuntu 12.04, et un serveur de production sous CentOS 7. S'assurer que\nleur application fonctionne bien sur tous ces environnements peut s'avérer être\nun vrai cauchemar !</p>\n<p>Mais il existe des solutions et parmi l'une d'entre elles nous avons...</p>\n<h2>Docker</h2>\n<h3>C'est quoi Docker ?</h3>\n<p>Docker est une plateforme qui va vous permettre d'exécuter votre code à\nl'intérieur d'un conteneur indépendamment de la machine sur laquelle vous êtes !\nUn conteneur ressemble à une machine virtuelle sauf qu'il n'embarque pas tout un\nsystème d'exploitation avec lui ce qui lui permet de s'exécuter en quelque\nsecondes et d'être beaucoup plus léger.</p>\n<p>Docker peut donc résoudre notre problème d'environnement, car quelle que soit la\nmachine que nous utiliserons, le code s'exécutera de la même manière.</p>\n<p>La plateforme Docker est composée de deux éléments :</p>\n<ul>\n<li>Le démon Docker qui s'exécute en arrière-plan et qui s'occupe de gérer vos\nconteneurs</li>\n<li>Le client Docker qui vous permet d'interagir avec le démon par l'intermédiaire\nd'un outil en ligne de commande</li>\n</ul>\n<p>Si vous voulez plus d'informations sur le fonctionnement interne de Docker je\nvous redirige vers l'article du site officiel :\n<a href=\"https://docs.docker.com/engine/understanding-docker/\">Understanding Docker</a></p>\n<h3>Comment l'installer ?</h3>\n<p>Le client Docker fonctionne sur tous les systèmes d'exploitation. En revanche,\nle démon Docker utilise des fonctionnalités du noyau Linux afin de gérer les\nconteneurs. Il ne fonctionne donc que sur Linux. Heureusement la majorité des\nserveurs utilise Linux, et pour vos ordinateurs sous OS X, ou même Windows, il\nexiste une solution.</p>\n<p>Si vous utilisez une machine avec une distribution Linux vous pourrez lancer le\ndémon Docker directement sur cette dernière, par contre avec Windows ou OS X\nvous devrez lancer le démon dans une machine virtuelle, mais rassurez-vous,\nc'est très simple !</p>\n<p>Pour le guide d'installation de Docker en fonction de votre système je vous\nredirige de nouveau vers le site officiel :\n<a href=\"https://docs.docker.com/installation/#installation\">Guide d'installation</a></p>\n<h3>Un premier exemple</h3>\n<p>Avant de commencer, vous allez devoir télécharger une image Docker qui servira\nde base à vos prochains conteneurs.</p>\n<p>Pour cet exemple, on va partir d'une image Ubuntu :</p>\n<pre><code class=\"hljs language-console\"><span class=\"hljs-meta\">$</span><span class=\"bash\"> docker pull ubuntu:trusty</span>\ntrusty: Pulling from ubuntu\ne9e06b06e14c: Pull complete\na82efea989f9: Pull complete\n37bea4ee0c81: Pull complete\n07f8e8c5e660: Already exists\nubuntu:trusty: The image you are pulling has been verified. Important: image verification is a tech preview feature and should not be relied on to provide security.\nDigest: sha256:014fa1d5b72b4fe0ec2b4642610fbbfdd52f502da8e14e80de07bd1dd774e4ef\nStatus: Downloaded newer image for ubuntu:trusty\n</code></pre>\n<p>Cette commande va télécharger depuis le Docker Hub l'image de la version 14.04\n(trusty) d'Ubuntu. Il existe bien d'autres images que vous pourrez trouver\n<a href=\"https://registry.hub.docker.com\">sur le registry Docker</a>.</p>\n<p>Pour voir les images que vous avez téléchargées, utilisez cette commande :</p>\n<pre><code class=\"hljs language-console\"><span class=\"hljs-meta\">$</span><span class=\"bash\"> docker images</span>\nREPOSITORY    TAG       IMAGE ID        CREATED       VIRTUAL SIZE\nubuntu        trusty    07f8e8c5e660    4 weeks ago   188.3 MB\n</code></pre>\n<p>Sur ma machine, l'image d'Ubuntu fais 188.3 MB, je vous avais dit que c'était\nléger en comparaison à une machine virtuelle !</p>\n<p>Maintenant, nous allons lancer un conteneur et rentrer à l'intérieur :</p>\n<pre><code class=\"hljs language-console\"><span class=\"hljs-meta\">$</span><span class=\"bash\"> docker run -it ubuntu:trusty bash</span>\nroot@2cdceb5ff771:/#\n</code></pre>\n<p>Cette commande crée un conteneur à partir de l'image <code>ubuntu:trusty</code>, y lance le\nprogramme <code>bash</code> et y attache votre shell grâce aux options <code>-it</code></p>\n<p>Vous pouvez maintenant exécuter les commandes que vous voulez, elle\ns'exécuteront à l'intérieur du conteneur, par exemple :</p>\n<pre><code class=\"hljs language-console\">root@2cdceb5ff771:/#\n<span class=\"hljs-meta\">$</span><span class=\"bash\"> apt-get moo</span>\n                 (__)\n                 (oo)\n           /------\\/\n          / |    ||\n         *  /\\---/\\\n            ~~   ~~\n...&quot;Have you mooed today?&quot;...\n</code></pre>\n<p>Vous pouvez quitter le conteneur en faisant un <code>Ctrl-d</code></p>\n<p>Maintenant que vous êtes retourné sur votre machine, vous pouvez afficher la\nliste des conteneurs lancés avec cette commande :</p>\n<pre><code class=\"hljs language-console\"><span class=\"hljs-meta\">$</span><span class=\"bash\"> docker ps</span>\nCONTAINER ID    IMAGE   COMMAND   CREATED   STATUS    PORTS   NAMES\n</code></pre>\n<p>Il n'y a rien ? C'est normal ! En quittant le conteneur ce dernier s'est arrêté\naussi. Pour l'afficher quand même, il suffit d'entrer cette commande :</p>\n<pre><code class=\"hljs language-console\"><span class=\"hljs-meta\">$</span><span class=\"bash\"> docker ps -a</span>\nCONTAINER ID    IMAGE           COMMAND   CREATED         STATUS                    PORTS   NAMES\n2cdceb5ff771    ubuntu:trusty   &quot;bash&quot;    12 minutes ago  Exited (0) 2 minutes ago          loving_newton\n</code></pre>\n<p>Et pour supprimer ce conteneur ?</p>\n<pre><code class=\"hljs language-console\"><span class=\"hljs-meta\">$</span><span class=\"bash\"> docker rm 2cdc</span>\n2cdc\n</code></pre>\n<p>Évidemment, remplacez '2cdc' par le <code>CONTAINER ID</code> approprié.</p>\n<p>Passons maintenant à un deuxième exemple plus concret avec une application web.</p>\n<h2>Un deuxième exemple avec Node.js</h2>\n<p>Pour commencer, vous allez récupérer l'image docker officiel de Node.js en\nfaisant :</p>\n<pre><code class=\"hljs language-console\"><span class=\"hljs-meta\">$</span><span class=\"bash\"> docker pull node:0.12.4</span>\n0.12.4: Pulling from node\n7711db4bb553: Pull complete\nd1744e6e9471: Pull complete\n9332645b03a3: Pull complete\na52a290821b3: Pull complete\n3575f1347ce7: Already exists\n39bb80489af7: Already exists\ndf2a0347c9d0: Already exists\n7a3871ba15f8: Already exists\na2703ed272d7: Already exists\nc9e3effdd23a: Already exists\nnode:0.12.4: The image you are pulling has been verified. Important: image verification is a tech preview feature and should not be relied on to provide security.\nDigest: sha256:81fb0812dd5e81f768773a121c8a6daced36893210c5ed50b504c4abcb04e10c\nStatus: Downloaded newer image for node:0.12.4\n</code></pre>\n<p>Puis créez un fichier <code>server.js</code> avec le contenu suivant :</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">var</span> http = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;http&quot;</span>);\n\n<span class=\"hljs-keyword\">var</span> server = http.createServer(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">req, res</span>) </span>{\n  res.end(<span class=\"hljs-string\">&quot;Coucou depuis Docker&quot;</span>);\n});\n\nserver.listen(<span class=\"hljs-number\">3000</span>);\n</code></pre>\n<p>Et maintenant, pour lancer notre application à l'intérieur d'un conteneur, vous\ndevez faire :</p>\n<pre><code class=\"hljs language-console\"><span class=\"hljs-meta\">$</span><span class=\"bash\"> docker run -d --name node-app -p 3000:3000 -v $(<span class=\"hljs-built_in\">pwd</span>):/app node:0.12.4 node /app/server.js</span>\ne9ca3cd8f90b8554ca99ec8ba15a039f827005bd8fecbf80d72ce7267006a6df\n</code></pre>\n<p>Si vous vous rendez sur <code>localhost:3000</code> (ou l'IP de la VM si êtes sur Windows\nou Mac), vous verrez : 'Coucou depuis Docker'</p>\n<p>C'est beau, mais comment ça marche ? Examinons les options une par une :</p>\n<ul>\n<li><code>-d</code> : cette option permet de lancer le conteneur en mode démon et donc de\ntourner en tâche de fond à la différence de <code>-it</code> qui lançait le conteneur au\npremier plan et nous donnait un accès direct au conteneur.</li>\n<li><code>--name node-app</code> : cette option permet simplement de nommer notre conteneur,\nce qui peut servir pour l'arrêter et le relancer plus simplement (et à\nd'autres choses plus complexes dont je parlerai dans un prochain article).</li>\n<li><code>-p 3000:3000</code> : cette option permet de partager le port de votre machine avec\nle port du conteneur. Le premier nombre est le port de votre machine et le\ndeuxième le port dans le conteneur.</li>\n<li><code>-v $(pwd):/app</code> : cette option permet de partager un dossier avec votre\nconteneur, ici, nous partageons le dossier courant (où se trouve notre fichier\n<code>server.js</code>) avec le dossier <code>/app</code> dans le conteneur (attention si vous êtes\nsur Mac ou Windows uniquement votre 'home' est partagé).</li>\n<li><code>node:0.12.4</code> : l'image Docker que vous voulez utiliser.</li>\n<li><code>node /app/server.js</code> : la commande à exécuter dans le conteneur.</li>\n</ul>\n<p>Et maintenant ? Vous pouvez afficher le conteneur en faisant : <code>docker ps</code>,\nl'arrêter avec : <code>docker stop node-app</code> et le supprimer avec\n<code>docker rm node-app</code>.</p>\n<hr />\n<p>Dans cet article, nous avons vu comment récupérer des images Docker depuis le\nDocker Hub et comment les instancier afin de créer des conteneurs. Mais pour\naller plus loin, ce serait bien si nous pouvions créer nos propres images, c'est\nce que nous apprendrons à faire à l'aide des Dockerfile dans le prochain\narticle.</p>\n"}}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"listsRequests":{"data":{"RE_PRIVATE_NONE":true}},"itemsRequests":{"data":{"RE_PRIVATE_NONE":true}}}</script><head><script defer="defer" src="/public/main.56c69761a03eb0112696.js"></script></head></html>