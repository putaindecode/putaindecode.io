<!DOCTYPE html><html lang="fr"><head><title data-react-helmet="true">Votre première app React Native | Putain de code</title><meta data-react-helmet="true" charset="UTF-8"/><meta data-react-helmet="true" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover" name="viewport"/><meta data-react-helmet="true" content="summary_large_image" name="twitter:card"/><meta data-react-helmet="true" content="Putain de code !" property="og:site_name"/><meta data-react-helmet="true" content="@putaindecode" name="twitter:site"/><meta data-react-helmet="true" content="https://putaindecode.io/public/images/website/share.jpg" property="og:image"/><meta data-react-helmet="true" content="https://putaindecode.io/public/images/website/share.jpg" name="twitter:image"/><meta data-react-helmet="true" content="1500" property="og:image:width"/><meta data-react-helmet="true" content="777" property="og:image:height"/><meta data-react-helmet="true" content="Votre première app React Native | Putain de code" property="og:title"/><meta data-react-helmet="true" content="Votre première app React Native | Putain de code" name="twitter:title"/><meta data-react-helmet="true" content="Un article proposé par zoontek" name="description"/><link data-react-helmet="true" title="RSS Feed" href="/api/articles/feeds/desc/feed.xml" rel="alternate" type="application/rss+xml"/><link data-react-helmet="true" href="/favicon.ico" rel="shortcut icon"/><link data-react-helmet="true" href="https://putaindecode.io/articles/votre-premiere-app-react-native" rel="canonical"/><script>window.PAGES_BOOT_MODE="hydrate";</script></head><div id="root"><style data-emotion="rpcss zx73cm 1lc6tyj 28v1b4">@-webkit-keyframes animation-zx73cm{from{opacity:0;-webkit-transform:translateY(20px);-moz-transform:translateY(20px);-ms-transform:translateY(20px);transform:translateY(20px);}}@keyframes animation-zx73cm{from{opacity:0;-webkit-transform:translateY(20px);-moz-transform:translateY(20px);-ms-transform:translateY(20px);transform:translateY(20px);}}:root{--page-background-color:#fff;--page-slightly-accented-background-color:#F9F6F6;--page-accented-background-color:#E4EBEE;--page-text-color:#46515B;--link-text-color:#E51D58;--gradient-red-top:#E51D58;--gradient-red-bottom:#CC0613;--code-background-color:#FAF3E1;--one-percent-contrast-color:rgba(0, 0, 0, 0.1);--half-percent-contrast-color:rgba(0, 0, 0, 0.05);}@media (prefers-color-scheme: dark){:root{--page-background-color:#222;--page-slightly-accented-background-color:#171717;--page-accented-background-color:#111;--page-text-color:#ddd;--link-text-color:#F87098;--gradient-red-top:#E51D58;--gradient-red-bottom:#CC0613;--code-background-color:#4F3804;--one-percent-contrast-color:rgba(255, 255, 255, 0.1);--half-percent-contrast-color:rgba(255, 255, 255, 0.05);}}body{padding:0;margin:0;background-color:var(--page-background-color);color:var(--page-text-color);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;overflow-x:hidden;}html{font-size:1em;line-height:1.4;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%;}a{color:var(--link-text-color);-webkit-text-decoration:underline;text-decoration:underline;}a:hover{-webkit-text-decoration:none;text-decoration:none;}#root{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}*,*:before,*:after{box-sizing:border-box;}pre,.hljs{color:#adbac7;background:#22272e;}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#f47067;}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#dcbdfb;}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-variable,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id{color:#6cb6ff;}.hljs-regexp,.hljs-string,.hljs-meta .hljs-string{color:#96d0ff;}.hljs-built_in,.hljs-symbol{color:#f69d50;}.hljs-comment,.hljs-code,.hljs-formula{color:#768390;}.hljs-name,.hljs-quote,.hljs-selector-tag,.hljs-selector-pseudo{color:#8ddb8c;}.hljs-subst{color:#adbac7;}.hljs-section{color:#316dca;font-weight:bold;}.hljs-bullet{color:#eac55f;}.hljs-emphasis{color:#adbac7;font-style:italic;}.hljs-strong{color:#adbac7;font-weight:bold;}.hljs-addition{color:#b4f1b4;background-color:#1b4721;}.hljs-deletion{color:#ffd8d3;background-color:#78191b;}</style><style data-emotion="rpcss 9vhaby">.rpcss-9vhaby{background-color:var(--gradient-red-bottom);background-image:linear-gradient(to bottom right, var(--gradient-red-top), var(--gradient-red-bottom));}</style><header class="rpcss-9vhaby" style="background-image:linear-gradient(to bottom right, hsl(101, 100%, 35%), hsl(84, 100%, 30%))"><style data-emotion="rpcss 1qqk0tr">.rpcss-1qqk0tr{padding-left:env(safe-area-inset-left);padding-right:env(safe-area-inset-right);}</style><div class="rpcss-1qqk0tr"><style data-emotion="rpcss qx7dny">.rpcss-qx7dny{width:100%;max-width:1024px;margin:0 auto;padding:0 10px;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;}</style><div class="rpcss-qx7dny"><style data-emotion="rpcss 7s9om2">.rpcss-7s9om2{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding:20px 0 50px;}</style><div class="rpcss-7s9om2"><style data-emotion="rpcss gdpa5c">.rpcss-gdpa5c{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-text-decoration:none;text-decoration:none;}</style><a class="rpcss-gdpa5c" href="/"><style data-emotion="rpcss 1lm4738">.rpcss-1lm4738{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-text-decoration:none;text-decoration:none;padding-bottom:10px;}</style><div class="rpcss-1lm4738"><style data-emotion="rpcss 13o7eu2">.rpcss-13o7eu2{display:block;}</style><svg class="rpcss-13o7eu2" height="36px" width="36px" viewBox="0 0 36 36"><defs><linearGradient id="PutainDeCodeLogoGradient" x1="50%" x2="50%" y1="0%" y2="127.223881%"><stop offset="0%" stop-color="#E41D57"></stop><stop offset="100%" stop-color="#C60000"></stop></linearGradient></defs><circle cx="18" cy="18" fill="url(#PutainDeCodeLogoGradient)" r="17" stroke="#FFFFFF" stroke-width="2"></circle><polygon fill="#FFFFFF" points="15.9033203 18.2246094 15.9033203 18.3710938 11.2304688 20.5317383 11.2304688 22.8095703 18.0566406 19.184082 18.0566406 17.4116211 11.2304688 13.7788086 11.2304688 16.0639648"></polygon><rect height="14" width="2" fill="#FFFFFF" x="22" y="11"><animate attributeName="opacity" begin="100ms" calcMode="discrete" dur="2s" repeatCount="indefinite" values="1;0"></animate></rect></svg><style data-emotion="rpcss 4cf197">.rpcss-4cf197{width:10px;height:10px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}</style><div class="rpcss-4cf197"></div><style data-emotion="rpcss u5k24">.rpcss-u5k24{font-size:22px;color:#fff;font-weight:800;}</style><div aria-level="2" class="rpcss-u5k24" role="heading">Putain de code !</div></div><style data-emotion="rpcss 1nyebg4">.rpcss-1nyebg4{font-size:14px;color:rgba(255, 255, 255, 0.8);text-align:center;}</style><div class="rpcss-1nyebg4">Blog participatif de la communauté dev</div></a></div></div></div></header><style data-emotion="rpcss a4ric9">.rpcss-a4ric9{background-color:var(--page-slightly-accented-background-color);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}</style><div class="rpcss-a4ric9"><style data-emotion="rpcss oeugsb">.rpcss-oeugsb{-webkit-animation:500ms ease-out animation-zx73cm;animation:500ms ease-out animation-zx73cm;}</style><div class="rpcss-oeugsb"><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 1qc2bam">.rpcss-1qc2bam{font-size:42px;font-weight:800;text-align:center;padding-top:40px;line-height:1.2;margin:0;}</style><h1 class="rpcss-1qc2bam">Votre première app React Native</h1><style data-emotion="rpcss obg2kr">.rpcss-obg2kr{font-size:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding-top:10px;padding-bottom:40px;color:var(--page-text-color);-webkit-text-decoration:none;text-decoration:none;}</style><a class="rpcss-obg2kr" href="https://github.com/zoontek"><style data-emotion="rpcss uco8i7">.rpcss-uco8i7{width:32px;height:32px;border-radius:100%;margin-right:10px;}</style><img class="rpcss-uco8i7" alt="zoontek" src="https://avatars.githubusercontent.com/zoontek?size=64"/><div>zoontek<!-- --> <!-- -->•<!-- --> <!-- -->2016/10/04</div></a><style data-emotion="rpcss 15kxmi0">.rpcss-15kxmi0{max-width:640px;width:100%;font-size:18px;margin:0 auto;line-height:1.7;}.rpcss-15kxmi0 h2,.rpcss-15kxmi0 h3,.rpcss-15kxmi0 h4,.rpcss-15kxmi0 h5,.rpcss-15kxmi0 h6{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;font-weight:800;line-height:1.2;}.rpcss-15kxmi0 img{max-width:100%;background-color:rgba(255, 255, 255, 0.75);}.rpcss-15kxmi0 code{font-size:0.9em;font-family:PragmataPro,SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;line-height:1;background-color:var(--code-background-color);margin:0 0.2em;}.rpcss-15kxmi0 pre{padding:10px;overflow-x:auto;font-size:14px;border-radius:10px;border:2px solid var(--one-percent-contrast-color);-webkit-overflow-scrolling:touch;}.rpcss-15kxmi0 pre code{font-size:14px;background-color:transparent;margin:0;}.rpcss-15kxmi0 blockquote{padding-left:20px;margin:0;font-size:16px;border-left:3px solid var(--one-percent-contrast-color);font-style:italic;}.rpcss-15kxmi0 table{width:100%;text-align:center;}.rpcss-15kxmi0 figure{padding:20px 0;}.rpcss-15kxmi0 figcaption{text-align:center;}.rpcss-15kxmi0 a{word-wrap:break-word;}.rpcss-15kxmi0 table thead th{background-color:var(--page-accented-background-color);padding:10px 0;}</style><div class="rpcss-15kxmi0"><p>Cela fait déjà plus d'un an que Facebook a publié la première version de React
Native. Longtemps considéré comme une expérimentation sympathique (après tout,
il est né lors d'un hackathon), un cycle de release soutenu d'une version
majeure toutes les 2 semaines a fait qu'aujourd'hui l'écosystème est
suffisamment riche et stable pour déployer une app iOS et Android en production.</p>
<h2>Quels problèmes avec les solutions hybrides ?</h2>
<p>Des solutions pour développer une application mobile multiplateforme en JS
existent déjà : je pense notamment à <a href="https://cordova.apache.org/">Cordova</a> ou à
son superset <a href="http://ionicframework.com/">Ionic</a>. Conçu autour d'une webview
système (un navigateur embedded - Safari sur iOS, Chrome sur Android) affichée
en plein écran, vous utilisez des technologies web classiques : HTML, CSS et JS.
Il est possible d'installer des plugins afin d'enrichir le moteur JavaScript
avec de nouvelles APIs en plus des APIs navigateur. Ainsi,
<code>cordova-plugin-contacts</code> permet d'accéder au carnet d'adresses du smartphone,
<code>cordova-plugin-vibration</code> permet de faire vibrer celui-ci, etc.</p>
<p>Le problème, c'est que si l'utilisation de plugins permet de faire le pont avec
le code natif (un message est envoyé de la partie JS à la partie Objective-C /
Java, qui l'exécute de son côté et renvoie le résultat au JS), l'UI de
l'application n'utilise elle pas du tout le layout natif des OS mobiles. Les
performances et le look'n'feel de celle-ci seront donc équivalente à une app
web, et non une app mobile.</p>
<p>Avec React Native, point de navigateur embedded, de HTML ou de CSS : vous devez
composer vos interfaces à l'aide de composants React qui font appel au layout
natif de la plateforme. Un exemple simple : <code>&lt;View&gt;</code> (qui est l'équivalent d'une
<code>&lt;div&gt;</code> HTML) communique via un pont JS &lt;-&gt; Objective-C / Java pour contrôler
une UIView (sur iOS) ou une android.view. Les performances de l'UI sont donc
quasi similaires aux performances natives.</p>
<h2>Découverte de l'environnement de dev</h2>
<p>Fatigués par JavaScript et son tooling un peu trop fourni ? Rassurez-vous : vous
n'avez strictement rien à configurer pour commencer à utiliser React Native.
Vous disposez out-of-the-box d'un packager Babel et d'un
<a href="https://github.com/facebook/react-native/tree/master/babel-preset">preset custom</a>
qui intègre les fonctionnalités de ES2015, mais également le support de React /
JSX (encore heureux), de <a href="https://flowtype.org/">Flow</a> et d'autres helpers
bienvenus tels que <code>async / await</code>.</p>
<p>En bons passionnés de bière, nous allons réaliser ensemble une app qui requête
la <a href="https://punkapi.com/">PunkAPI</a> (faites la demande d'une clé API via le
formulaire prévu à cet effet).</p>
<p>Je vous renvoie à la
<a href="https://facebook.github.io/react-native/docs/getting-started.html">documentation officielle</a>
pour ce qui est de l'installation des dépendances (celles-ci variant selon votre
OS et l'OS cible). Xcode / Android Studio, node et watchman étant installés,
ouvrez un terminal et initiez le projet :</p>
<pre><code>npm install -g react-native-cli
react-native init PutainDeBiere
</code></pre>
<p>Une fois le projet initialisé, le CLI vous informe de la façon dont lancer votre
application : faites-le dans la foulée. En ce qui me concerne, je développe pour
iOS.</p>
<pre><code class="hljs language-bash">react-native run-ios
</code></pre>
<p>Selon votre plateforme cible, ouvrez <code>index.ios.js</code> ou <code>index.android.js</code> dans
votre éditeur préféré. Modifiez quelque peu le texte et rafraichissez votre app
via <code>Command⌘ + R</code>, deux pressions sur la touche <code>R</code> (émulateur Android).</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">/* @flow */</span>

<span class="hljs-keyword">import</span> React, { Component } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { AppRegistry, StyleSheet, Text, View } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-native&quot;</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span> {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.container}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.welcome}</span>&gt;</span>Welcome to PutainDeBiere!<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>
    );
  }
}

<span class="hljs-keyword">const</span> styles = StyleSheet.create({
  <span class="hljs-attr">container</span>: {
    <span class="hljs-attr">flex</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">justifyContent</span>: <span class="hljs-string">&quot;center&quot;</span>,
    <span class="hljs-attr">alignItems</span>: <span class="hljs-string">&quot;center&quot;</span>,
    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">&quot;#F5FCFF&quot;</span>,
  },
  <span class="hljs-attr">welcome</span>: {
    <span class="hljs-attr">fontSize</span>: <span class="hljs-number">20</span>,
    <span class="hljs-attr">textAlign</span>: <span class="hljs-string">&quot;center&quot;</span>,
    <span class="hljs-attr">margin</span>: <span class="hljs-number">10</span>,
  },
});

AppRegistry.registerComponent(<span class="hljs-string">&quot;PutainDeBiere&quot;</span>, <span class="hljs-function">() =&gt;</span> App);
</code></pre>
<figure>
  <img src="/public/images/articles/2016-10-04-votre-premiere-app-react-native/welcome.png" alt="welcome PutainDeBiere preview" />
  <figcaption>Une bien jolie première étape</figcaption>
</figure>
<h2>Récupération des données</h2>
<p>Afin de requêter notre API, React Native nous offre plusieurs plusieurs
solutions: <code>fetch()</code> ou <code>XMLHttpRequest</code>. Tenez vous en <strong>uniquement</strong> à
l'utilisation de la première, la deuxième n'étant présente que pour assurer une
compatibilité avec des librairies tierces.</p>
<p><em>/!\ Notre clé API doit être encodée en base64. La function <code>btoa()</code> n'étant pas
disponible en React Native, il est nécessaire d'installer une dépendance.</em></p>
<pre><code class="hljs language-bash">npm install --save base-64
</code></pre>
<p>Histoire de séparer notre logique API de nos composants React, nous allons créer
un fichier nommé <code>punkapi.js</code> à la racine de notre projet.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">import</span> base64 <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;base-64&quot;</span>; <span class="hljs-comment">// importez la dépendance tout juste installée</span>

<span class="hljs-keyword">const</span> rootEndpoint = <span class="hljs-string">&quot;https://punkapi.com/api/v1&quot;</span>;
<span class="hljs-comment">// pour simplifier la compréhension de ce tuto, nous renseignons la clé API &quot;en dur&quot;</span>
<span class="hljs-comment">// ne faites jamais cela au sein de vos projets (voir http://12factor.net/fr/config)</span>
<span class="hljs-keyword">const</span> punkApiKey = <span class="hljs-string">&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span>;
<span class="hljs-keyword">const</span> password = <span class="hljs-string">&quot;&quot;</span>; <span class="hljs-comment">// la punk API n&#x27;utilise aucun mot de passe</span>
<span class="hljs-keyword">const</span> authBase64 = base64.encode(<span class="hljs-string">`<span class="hljs-subst">${punkApiKey}</span>:<span class="hljs-subst">${password}</span>`</span>);

<span class="hljs-keyword">const</span> headers = {
  <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/json&quot;</span>,
  <span class="hljs-attr">Accept</span>: <span class="hljs-string">&quot;application/json&quot;</span>,
  <span class="hljs-attr">Authorization</span>: <span class="hljs-string">`Basic <span class="hljs-subst">${authBase64}</span>`</span>, <span class="hljs-comment">// HTTP basic auth</span>
};

<span class="hljs-comment">// retourne une recette de bière au hasard</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> getRandomBrewdog = <span class="hljs-function">() =&gt;</span>
  fetch(<span class="hljs-string">`<span class="hljs-subst">${rootEndpoint}</span>/beers/random`</span>, { headers }).then(
    <span class="hljs-function">(<span class="hljs-params">{ status, json }</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (status !== <span class="hljs-number">200</span>)
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`API answered with status code <span class="hljs-subst">${status}</span>`</span>);
      <span class="hljs-comment">// gestion du status code HTTP</span>
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> json(); <span class="hljs-comment">// on parse la réponse en JSON</span>
    },
  );
</code></pre>
<p>Nous allons maintenant modifier notre composant <code>&lt;App&gt;</code> afin de faire une
requête simple d'une bière au hasard juste avant le montage de celui-ci.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">import</span> { getRandomBrewdog } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./punkapi&#x27;</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  <span class="hljs-function"><span class="hljs-title">componentWillMount</span>(<span class="hljs-params"></span>)</span> {
    getRandomBrewdog() <span class="hljs-comment">// fetch() retourne une Promise</span>
      .then(<span class="hljs-function"><span class="hljs-params">json</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(json))
      .catch(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-built_in">console</span>.error(error))
  }

  …
}
</code></pre>
<p>Vous apercevez la présence d'un appel à <code>console.log()</code>. Pour y accéder, rien de
plus simple: pressez <code>Command⌘ + D</code> au sein de l'émulateur iOS, ou appuyez sur
le bouton <code>Menu</code> de l'émulateur Android. Celui-ci contient de multiples choses
avec lesquelles je vous laisserai expérimenter par la suite; ce qui nous
intéresse ici c'est le bouton <code>Debug JS Remotely</code>, qui va ouvrir un nouvel
onglet dans Chrome où sera exécuté notre code JS.</p>
<p>Il devient donc possible d'ouvrir les Chrome Devtools (dont la console) afin de
débuguer notre app.</p>
<figure>
  <img src="/public/images/articles/2016-10-04-votre-premiere-app-react-native/devmenu.png" alt="devmenu + chrome devtools" />
  <figcaption>Jusqu'ici tout va bien</figcaption>
</figure>
<h2>Présentation des données</h2>
<p>Afin d'afficher les informations que nous venons de récupérer, nous allons avoir
besoin de plusieurs éléments (heureusement fournis), à savoir de quoi encapsuler
d'autres composants (une <code>&lt;View&gt;</code> ~= une <code>&lt;div&gt;</code> HTML), de quoi rendre du texte
(<code>&lt;Text&gt;</code> ~= <code>&lt;span&gt;</code>), un bouton (nous allons utiliser <code>&lt;TouchableOpacity&gt;</code>,
une zone dont l'opacité est modifiée lors d'un <code>onTouch</code>) et enfin d'un spinner
pour indiquer qu'une requête est en cours (<code>&lt;ActivityIndicator&gt;</code>).</p>
<p>Nous allons également rendre notre unique composant stateful afin de stocker
quelques informations retournées par l'API.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">import</span> React, { Component } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>
<span class="hljs-keyword">import</span> {
  AppRegistry,
  StyleSheet,
  ActivityIndicator, <span class="hljs-comment">// import des composants</span>
  TouchableOpacity,
  Text,
  View,
} <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-native&#x27;</span>

<span class="hljs-keyword">import</span> { getRandomBrewdog } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./punkapi&#x27;</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">props</span>)</span> {
    <span class="hljs-built_in">super</span>(props)

    <span class="hljs-comment">// la state de notre composant est utilisé pour</span>
    <span class="hljs-comment">// stocker quelques infos renvoyées par l&#x27;API</span>
    <span class="hljs-built_in">this</span>.state = {
      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// nom de la bière</span>
      <span class="hljs-attr">description</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// sa description</span>
      <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// la requête API est-elle en cours ?</span>
    }
  }

  <span class="hljs-comment">// nous externalisons cette fonction afin de</span>
  <span class="hljs-comment">// pouvoir l&#x27;appeler lorsqu&#x27;on le souhaite</span>
  _getRandomBrewdogWithFeedback = <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-built_in">this</span>.setState({ <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">true</span> })

    getRandomBrewdog()
      .then(<span class="hljs-function"><span class="hljs-params">json</span> =&gt;</span> <span class="hljs-built_in">this</span>.setState({
        <span class="hljs-attr">name</span>: json.name,
        <span class="hljs-attr">description</span>: json.description,
        <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// la requête est terminée</span>
      }))
      .catch(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-built_in">console</span>.error(error))
  }

  <span class="hljs-function"><span class="hljs-title">componentWillMount</span>(<span class="hljs-params"></span>)</span> {
    <span class="hljs-built_in">this</span>._getRandomBrewdogWithFeedback()
  }

  <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span> {
    <span class="hljs-keyword">const</span> content = <span class="hljs-built_in">this</span>.state.isLoading
      ? <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ActivityIndicator</span> /&gt;</span></span> <span class="hljs-comment">// si requête en cours, on affiche un spinner</span>
      : <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.welcome}</span>&gt;</span>
          Welcome to PutainDeBiere!
        <span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span></span>

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.container}</span>&gt;</span>
        {content}
      <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>
    )
  }
}

…
</code></pre>
<p>Votre application affiche dorénavant un spinner quelques secondes avant de
rendre le fameux &quot;Welcome to PutainDeBiere!&quot; le temps que la requête à la
punkAPI se fasse. Continuons de customiser ce render afin d'afficher les
informations retournées (et maintenant présentes dans le state de notre app).</p>
<pre><code class="hljs language-javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  …

  <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span> {
    <span class="hljs-keyword">const</span> content = <span class="hljs-built_in">this</span>.state.isLoading
      ? <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ActivityIndicator</span> /&gt;</span></span> <span class="hljs-comment">// si requête en cours, on affiche un spinner</span>
      : <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.infosContainer}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.name}</span>&gt;</span>
            {this.state.name} // sinon on affiche le nom de la bière
          <span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>

          <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.description}</span>&gt;</span>
            {this.state.description} // sa description
          <span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>

          <span class="hljs-tag">&lt;<span class="hljs-name">TouchableOpacity</span> // <span class="hljs-attr">on</span> <span class="hljs-attr">ajoute</span> <span class="hljs-attr">un</span> &quot;<span class="hljs-attr">bouton</span>&quot; <span class="hljs-attr">qui</span> <span class="hljs-attr">requ</span>ê<span class="hljs-attr">te</span> <span class="hljs-attr">une</span> <span class="hljs-attr">autre</span> <span class="hljs-attr">bi</span>è<span class="hljs-attr">re</span> <span class="hljs-attr">al</span>é<span class="hljs-attr">atoire</span>
            <span class="hljs-attr">onPress</span>=<span class="hljs-string">{this._getRandomBrewdogWithFeedback}</span>
            <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.button}</span>
          &gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Text</span>&gt;</span>Grab a new beer!<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">TouchableOpacity</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.container}</span>&gt;</span>
        {content}
      <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>
    )
  }
}

<span class="hljs-keyword">const</span> styles = StyleSheet.create({
  <span class="hljs-attr">container</span>: {
    <span class="hljs-attr">flex</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">justifyContent</span>: <span class="hljs-string">&#x27;center&#x27;</span>,
    <span class="hljs-attr">alignItems</span>: <span class="hljs-string">&#x27;center&#x27;</span>,
    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">&#x27;#F5FCFF&#x27;</span>,
  },
  <span class="hljs-comment">// ajout de styles divers</span>
  <span class="hljs-attr">infosContainer</span>: {
    <span class="hljs-attr">margin</span>: <span class="hljs-number">30</span>,
  },
  <span class="hljs-attr">name</span>: {
    <span class="hljs-attr">fontSize</span>: <span class="hljs-number">18</span>,
    <span class="hljs-attr">fontWeight</span>: <span class="hljs-string">&#x27;700&#x27;</span>,
    <span class="hljs-attr">marginBottom</span>: <span class="hljs-number">10</span>,
  },
  <span class="hljs-attr">description</span>: {
    <span class="hljs-attr">marginBottom</span>: <span class="hljs-number">10</span>,
  },
  <span class="hljs-attr">button</span>: {
    <span class="hljs-attr">borderWidth</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">borderColor</span>: <span class="hljs-string">&#x27;#000&#x27;</span>,
    <span class="hljs-attr">borderRadius</span>: <span class="hljs-number">3</span>,
    <span class="hljs-attr">padding</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attr">justifyContent</span>: <span class="hljs-string">&#x27;center&#x27;</span>,
    <span class="hljs-attr">alignItems</span>: <span class="hljs-string">&#x27;center&#x27;</span>,
  }
})
</code></pre>
<figure>
  <img src="/public/images/articles/2016-10-04-votre-premiere-app-react-native/final_result.png" alt="devmenu + chrome devtools" />
  <figcaption>Le rendu "final"</figcaption>
</figure>
<h2>Et maintenant ?</h2>
<p>Si vous connaissez déjà React, vous pouvez:</p>
<ul>
<li>améliorer le code de l'app avec l'ajout de redux (par exemple) afin de
supprimer le state de notre composant</li>
<li>créer un composant stateless &quot;&lt;Button&gt;&quot;</li>
<li>styliser davantage l'app à l'aide
d'<a href="https://facebook.github.io/react-native/docs/image.html">images</a> ou
d'<a href="https://facebook.github.io/react-native/docs/animations.html">animations</a></li>
<li>désactiver et modifier le style du bouton lors d'une requête API</li>
<li>gérer les erreurs de requêtage de façon un poil plus élégante que de balancer
une erreur à la tête de l'utilisateur</li>
</ul>
<p>Si ce n'est pas le cas, n'hésitez pas à lire ces deux articles pour vous
familiariser avec ces librairies avant de continuer sur votre lancée:</p>
<ul>
<li><a href="/fr/articles/js/react/">Introduction à React</a></li>
<li><a href="/fr/articles/js/redux/">Redux, comment ça marche ?</a></li>
</ul>
<p>Bonne découverte !</p>
</div><style data-emotion="rpcss unyj6i">.rpcss-unyj6i{max-width:640px;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin:20px auto;padding:20px;background-color:var(--page-background-color);border-radius:10px;box-shadow:0 15px 15px -5px rgba(0, 0, 0, 0.2);}@media (max-width: 540px){.rpcss-unyj6i{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><div class="rpcss-unyj6i"><style data-emotion="rpcss ty7r4z">.rpcss-ty7r4z{font-weight:800;}</style><div class="rpcss-ty7r4z">Vous avez aimé cet article?</div><style data-emotion="rpcss klacsp">.rpcss-klacsp{width:0;height:10px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}</style><div class="rpcss-klacsp"></div><style data-emotion="rpcss 1pkr03v">.rpcss-1pkr03v{background-color:#00aced;color:#fff;padding:10px 20px;-webkit-text-decoration:none;text-decoration:none;border-radius:5px;font-weight:800;}.rpcss-1pkr03v:active{opacity:0.5;}</style><a class="rpcss-1pkr03v" href="https://www.twitter.com/intent/tweet?text=Votre%20premi%C3%A8re%20app%20React%20Native%20sur%20%40PutainDeCode%20https%3A%2F%2Fputaindecode.io%2Farticles%2Fvotre-premiere-app-react-native" target="_blank">Le partager sur Twitter</a></div><style data-emotion="rpcss x4iqxe">.rpcss-x4iqxe{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;text-align:center;padding:20px;}</style><div class="rpcss-x4iqxe"><style data-emotion="rpcss gein6x">.rpcss-gein6x{font-size:20px;-webkit-text-decoration:none;text-decoration:none;color:#1E49B5;}</style><a class="rpcss-gein6x" href="/articles">← Articles</a></div><style data-emotion="rpcss 8bodgl">.rpcss-8bodgl{max-width:640px;width:100%;margin:0 auto;padding:20px 0;}</style><div class="rpcss-8bodgl" id="disqus_thread"></div></div></div></div></div><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 1vau6rl">.rpcss-1vau6rl{margin:20px 0;background-color:var(--page-accented-background-color);border-radius:10px;padding:20px;}</style><div class="rpcss-1vau6rl"><style data-emotion="rpcss 1gz1i1h">.rpcss-1gz1i1h{font-size:32px;font-weight:800;margin-bottom:20px;text-align:center;}</style><div aria-level="2" class="rpcss-1gz1i1h" role="heading">Ne rien rater</div><style data-emotion="rpcss 1wbispj">.rpcss-1wbispj{font-size:18px;margin-bottom:10px;text-align:center;}</style><div aria-level="3" class="rpcss-1wbispj" role="heading">Sur les réseaux</div><style data-emotion="rpcss 1hyoz7m">.rpcss-1hyoz7m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;}</style><div class="rpcss-1hyoz7m"><a href="https://twitter.com/PutainDeCode"><img alt="Twitter" height="48" src="/public/images/website/twitter.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://facebook.com/putaindecode"><img alt="Facebook" height="48" src="/public/images/website/facebook.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://github.com/putaindecode"><img alt="Facebook" height="48" src="/public/images/website/github.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://itunes.apple.com/fr/podcast/putain-de-code-!/id1185311825"><img alt="Apple Podcast" height="48" src="/public/images/website/apple-podcast.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://soundcloud.com/putaindecode"><img alt="Soundcloud" height="48" src="/public/images/website/soundcloud.svg" width="48"/></a></div><div aria-level="3" class="rpcss-1wbispj" role="heading">Sur le chat</div><div class="rpcss-1hyoz7m"><a href="https://discord.gg/jtbGNNc"><img alt="Discord" height="48" src="/public/images/website/discord.svg" width="48"/></a></div></div></div></div><style data-emotion="rpcss zs8kw7">.rpcss-zs8kw7{background-color:#222;padding:20px 0;}</style><footer class="rpcss-zs8kw7"><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 79elbk">.rpcss-79elbk{position:relative;}</style><div class="rpcss-79elbk"><style data-emotion="rpcss 1hle0ni">.rpcss-1hle0ni{position:absolute;left:0;top:50%;color:#fff;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="rpcss-1hle0ni" href="/api/articles/feeds/desc/feed.xml"><style data-emotion="rpcss lvyu5j">.rpcss-lvyu5j{margin-right:10px;}</style><img class="rpcss-lvyu5j" alt="Flux RSS" height="16" src="/public/images/website/rss-feed.svg" width="16"/><style data-emotion="rpcss um3i31">@media (max-width: 400px){.rpcss-um3i31{display:none;}}</style><div class="rpcss-um3i31">Flux RSS</div></a><style data-emotion="rpcss 12cp4l7">.rpcss-12cp4l7{color:rgba(255, 255, 255, 0.5);text-align:center;font-size:14px;}</style><div class="rpcss-12cp4l7">© 2021 Putain de code !</div><style data-emotion="rpcss 1w98uy3">.rpcss-1w98uy3{position:absolute;right:0;top:50%;color:#fff;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="rpcss-1w98uy3" href="https://github.com/putaindecode/putaindecode.io">GitHub</a></div></div></div></footer></div><script id="initialData" type="text/data">{"lists":{"RE_PRIVATE_NONE":true},"items":{"k":"articles","v":{"k":"votre-premiere-app-react-native","v":{"_0":{"TAG":0,"_0":{"slug":"votre-premiere-app-react-native","filename":"2016-10-04-votre-premiere-app-react-native","title":"Votre première app React Native","date":"Tue, 04 Oct 2016 00:00:00 GMT","draft":false,"meta":{"date":"2016-10-04T00:00:00.000Z","title":"Votre première app React Native","author":"zoontek","oldSlug":"js/react/native/introduction","slug":"votre-premiere-app-react-native"},"body":"<p>Cela fait déjà plus d'un an que Facebook a publié la première version de React\nNative. Longtemps considéré comme une expérimentation sympathique (après tout,\nil est né lors d'un hackathon), un cycle de release soutenu d'une version\nmajeure toutes les 2 semaines a fait qu'aujourd'hui l'écosystème est\nsuffisamment riche et stable pour déployer une app iOS et Android en production.</p>\n<h2>Quels problèmes avec les solutions hybrides ?</h2>\n<p>Des solutions pour développer une application mobile multiplateforme en JS\nexistent déjà : je pense notamment à <a href=\"https://cordova.apache.org/\">Cordova</a> ou à\nson superset <a href=\"http://ionicframework.com/\">Ionic</a>. Conçu autour d'une webview\nsystème (un navigateur embedded - Safari sur iOS, Chrome sur Android) affichée\nen plein écran, vous utilisez des technologies web classiques : HTML, CSS et JS.\nIl est possible d'installer des plugins afin d'enrichir le moteur JavaScript\navec de nouvelles APIs en plus des APIs navigateur. Ainsi,\n<code>cordova-plugin-contacts</code> permet d'accéder au carnet d'adresses du smartphone,\n<code>cordova-plugin-vibration</code> permet de faire vibrer celui-ci, etc.</p>\n<p>Le problème, c'est que si l'utilisation de plugins permet de faire le pont avec\nle code natif (un message est envoyé de la partie JS à la partie Objective-C /\nJava, qui l'exécute de son côté et renvoie le résultat au JS), l'UI de\nl'application n'utilise elle pas du tout le layout natif des OS mobiles. Les\nperformances et le look'n'feel de celle-ci seront donc équivalente à une app\nweb, et non une app mobile.</p>\n<p>Avec React Native, point de navigateur embedded, de HTML ou de CSS : vous devez\ncomposer vos interfaces à l'aide de composants React qui font appel au layout\nnatif de la plateforme. Un exemple simple : <code>&lt;View&gt;</code> (qui est l'équivalent d'une\n<code>&lt;div&gt;</code> HTML) communique via un pont JS &lt;-&gt; Objective-C / Java pour contrôler\nune UIView (sur iOS) ou une android.view. Les performances de l'UI sont donc\nquasi similaires aux performances natives.</p>\n<h2>Découverte de l'environnement de dev</h2>\n<p>Fatigués par JavaScript et son tooling un peu trop fourni ? Rassurez-vous : vous\nn'avez strictement rien à configurer pour commencer à utiliser React Native.\nVous disposez out-of-the-box d'un packager Babel et d'un\n<a href=\"https://github.com/facebook/react-native/tree/master/babel-preset\">preset custom</a>\nqui intègre les fonctionnalités de ES2015, mais également le support de React /\nJSX (encore heureux), de <a href=\"https://flowtype.org/\">Flow</a> et d'autres helpers\nbienvenus tels que <code>async / await</code>.</p>\n<p>En bons passionnés de bière, nous allons réaliser ensemble une app qui requête\nla <a href=\"https://punkapi.com/\">PunkAPI</a> (faites la demande d'une clé API via le\nformulaire prévu à cet effet).</p>\n<p>Je vous renvoie à la\n<a href=\"https://facebook.github.io/react-native/docs/getting-started.html\">documentation officielle</a>\npour ce qui est de l'installation des dépendances (celles-ci variant selon votre\nOS et l'OS cible). Xcode / Android Studio, node et watchman étant installés,\nouvrez un terminal et initiez le projet :</p>\n<pre><code>npm install -g react-native-cli\nreact-native init PutainDeBiere\n</code></pre>\n<p>Une fois le projet initialisé, le CLI vous informe de la façon dont lancer votre\napplication : faites-le dans la foulée. En ce qui me concerne, je développe pour\niOS.</p>\n<pre><code class=\"hljs language-bash\">react-native run-ios\n</code></pre>\n<p>Selon votre plateforme cible, ouvrez <code>index.ios.js</code> ou <code>index.android.js</code> dans\nvotre éditeur préféré. Modifiez quelque peu le texte et rafraichissez votre app\nvia <code>Command⌘ + R</code>, deux pressions sur la touche <code>R</code> (émulateur Android).</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-comment\">/* @flow */</span>\n\n<span class=\"hljs-keyword\">import</span> React, { Component } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;react&quot;</span>;\n<span class=\"hljs-keyword\">import</span> { AppRegistry, StyleSheet, Text, View } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;react-native&quot;</span>;\n\n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">App</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Component</span> </span>{\n  <span class=\"hljs-function\"><span class=\"hljs-title\">render</span>(<span class=\"hljs-params\"></span>)</span> {\n    <span class=\"hljs-keyword\">return</span> (\n      <span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">View</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">{styles.container}</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Text</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">{styles.welcome}</span>&gt;</span>Welcome to PutainDeBiere!<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">Text</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">View</span>&gt;</span></span>\n    );\n  }\n}\n\n<span class=\"hljs-keyword\">const</span> styles = StyleSheet.create({\n  <span class=\"hljs-attr\">container</span>: {\n    <span class=\"hljs-attr\">flex</span>: <span class=\"hljs-number\">1</span>,\n    <span class=\"hljs-attr\">justifyContent</span>: <span class=\"hljs-string\">&quot;center&quot;</span>,\n    <span class=\"hljs-attr\">alignItems</span>: <span class=\"hljs-string\">&quot;center&quot;</span>,\n    <span class=\"hljs-attr\">backgroundColor</span>: <span class=\"hljs-string\">&quot;#F5FCFF&quot;</span>,\n  },\n  <span class=\"hljs-attr\">welcome</span>: {\n    <span class=\"hljs-attr\">fontSize</span>: <span class=\"hljs-number\">20</span>,\n    <span class=\"hljs-attr\">textAlign</span>: <span class=\"hljs-string\">&quot;center&quot;</span>,\n    <span class=\"hljs-attr\">margin</span>: <span class=\"hljs-number\">10</span>,\n  },\n});\n\nAppRegistry.registerComponent(<span class=\"hljs-string\">&quot;PutainDeBiere&quot;</span>, <span class=\"hljs-function\">() =&gt;</span> App);\n</code></pre>\n<figure>\n  <img src=\"/public/images/articles/2016-10-04-votre-premiere-app-react-native/welcome.png\" alt=\"welcome PutainDeBiere preview\" />\n  <figcaption>Une bien jolie première étape</figcaption>\n</figure>\n<h2>Récupération des données</h2>\n<p>Afin de requêter notre API, React Native nous offre plusieurs plusieurs\nsolutions: <code>fetch()</code> ou <code>XMLHttpRequest</code>. Tenez vous en <strong>uniquement</strong> à\nl'utilisation de la première, la deuxième n'étant présente que pour assurer une\ncompatibilité avec des librairies tierces.</p>\n<p><em>/!\\ Notre clé API doit être encodée en base64. La function <code>btoa()</code> n'étant pas\ndisponible en React Native, il est nécessaire d'installer une dépendance.</em></p>\n<pre><code class=\"hljs language-bash\">npm install --save base-64\n</code></pre>\n<p>Histoire de séparer notre logique API de nos composants React, nous allons créer\nun fichier nommé <code>punkapi.js</code> à la racine de notre projet.</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-keyword\">import</span> base64 <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;base-64&quot;</span>; <span class=\"hljs-comment\">// importez la dépendance tout juste installée</span>\n\n<span class=\"hljs-keyword\">const</span> rootEndpoint = <span class=\"hljs-string\">&quot;https://punkapi.com/api/v1&quot;</span>;\n<span class=\"hljs-comment\">// pour simplifier la compréhension de ce tuto, nous renseignons la clé API &quot;en dur&quot;</span>\n<span class=\"hljs-comment\">// ne faites jamais cela au sein de vos projets (voir http://12factor.net/fr/config)</span>\n<span class=\"hljs-keyword\">const</span> punkApiKey = <span class=\"hljs-string\">&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span>;\n<span class=\"hljs-keyword\">const</span> password = <span class=\"hljs-string\">&quot;&quot;</span>; <span class=\"hljs-comment\">// la punk API n&#x27;utilise aucun mot de passe</span>\n<span class=\"hljs-keyword\">const</span> authBase64 = base64.encode(<span class=\"hljs-string\">`<span class=\"hljs-subst\">${punkApiKey}</span>:<span class=\"hljs-subst\">${password}</span>`</span>);\n\n<span class=\"hljs-keyword\">const</span> headers = {\n  <span class=\"hljs-string\">&quot;Content-Type&quot;</span>: <span class=\"hljs-string\">&quot;application/json&quot;</span>,\n  <span class=\"hljs-attr\">Accept</span>: <span class=\"hljs-string\">&quot;application/json&quot;</span>,\n  <span class=\"hljs-attr\">Authorization</span>: <span class=\"hljs-string\">`Basic <span class=\"hljs-subst\">${authBase64}</span>`</span>, <span class=\"hljs-comment\">// HTTP basic auth</span>\n};\n\n<span class=\"hljs-comment\">// retourne une recette de bière au hasard</span>\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> getRandomBrewdog = <span class=\"hljs-function\">() =&gt;</span>\n  fetch(<span class=\"hljs-string\">`<span class=\"hljs-subst\">${rootEndpoint}</span>/beers/random`</span>, { headers }).then(\n    <span class=\"hljs-function\">(<span class=\"hljs-params\">{ status, json }</span>) =&gt;</span> {\n      <span class=\"hljs-keyword\">if</span> (status !== <span class=\"hljs-number\">200</span>)\n        <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">Error</span>(<span class=\"hljs-string\">`API answered with status code <span class=\"hljs-subst\">${status}</span>`</span>);\n      <span class=\"hljs-comment\">// gestion du status code HTTP</span>\n      <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">return</span> json(); <span class=\"hljs-comment\">// on parse la réponse en JSON</span>\n    },\n  );\n</code></pre>\n<p>Nous allons maintenant modifier notre composant <code>&lt;App&gt;</code> afin de faire une\nrequête simple d'une bière au hasard juste avant le montage de celui-ci.</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-keyword\">import</span> { getRandomBrewdog } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;./punkapi&#x27;</span>\n\n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">App</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Component</span> </span>{\n  <span class=\"hljs-function\"><span class=\"hljs-title\">componentWillMount</span>(<span class=\"hljs-params\"></span>)</span> {\n    getRandomBrewdog() <span class=\"hljs-comment\">// fetch() retourne une Promise</span>\n      .then(<span class=\"hljs-function\"><span class=\"hljs-params\">json</span> =&gt;</span> <span class=\"hljs-built_in\">console</span>.log(json))\n      .catch(<span class=\"hljs-function\"><span class=\"hljs-params\">error</span> =&gt;</span> <span class=\"hljs-built_in\">console</span>.error(error))\n  }\n\n  …\n}\n</code></pre>\n<p>Vous apercevez la présence d'un appel à <code>console.log()</code>. Pour y accéder, rien de\nplus simple: pressez <code>Command⌘ + D</code> au sein de l'émulateur iOS, ou appuyez sur\nle bouton <code>Menu</code> de l'émulateur Android. Celui-ci contient de multiples choses\navec lesquelles je vous laisserai expérimenter par la suite; ce qui nous\nintéresse ici c'est le bouton <code>Debug JS Remotely</code>, qui va ouvrir un nouvel\nonglet dans Chrome où sera exécuté notre code JS.</p>\n<p>Il devient donc possible d'ouvrir les Chrome Devtools (dont la console) afin de\ndébuguer notre app.</p>\n<figure>\n  <img src=\"/public/images/articles/2016-10-04-votre-premiere-app-react-native/devmenu.png\" alt=\"devmenu + chrome devtools\" />\n  <figcaption>Jusqu'ici tout va bien</figcaption>\n</figure>\n<h2>Présentation des données</h2>\n<p>Afin d'afficher les informations que nous venons de récupérer, nous allons avoir\nbesoin de plusieurs éléments (heureusement fournis), à savoir de quoi encapsuler\nd'autres composants (une <code>&lt;View&gt;</code> ~= une <code>&lt;div&gt;</code> HTML), de quoi rendre du texte\n(<code>&lt;Text&gt;</code> ~= <code>&lt;span&gt;</code>), un bouton (nous allons utiliser <code>&lt;TouchableOpacity&gt;</code>,\nune zone dont l'opacité est modifiée lors d'un <code>onTouch</code>) et enfin d'un spinner\npour indiquer qu'une requête est en cours (<code>&lt;ActivityIndicator&gt;</code>).</p>\n<p>Nous allons également rendre notre unique composant stateful afin de stocker\nquelques informations retournées par l'API.</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-keyword\">import</span> React, { Component } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;react&#x27;</span>\n<span class=\"hljs-keyword\">import</span> {\n  AppRegistry,\n  StyleSheet,\n  ActivityIndicator, <span class=\"hljs-comment\">// import des composants</span>\n  TouchableOpacity,\n  Text,\n  View,\n} <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;react-native&#x27;</span>\n\n<span class=\"hljs-keyword\">import</span> { getRandomBrewdog } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;./punkapi&#x27;</span>\n\n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">App</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Component</span> </span>{\n  <span class=\"hljs-function\"><span class=\"hljs-title\">constructor</span>(<span class=\"hljs-params\">props</span>)</span> {\n    <span class=\"hljs-built_in\">super</span>(props)\n\n    <span class=\"hljs-comment\">// la state de notre composant est utilisé pour</span>\n    <span class=\"hljs-comment\">// stocker quelques infos renvoyées par l&#x27;API</span>\n    <span class=\"hljs-built_in\">this</span>.state = {\n      <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">&#x27;&#x27;</span>, <span class=\"hljs-comment\">// nom de la bière</span>\n      <span class=\"hljs-attr\">description</span>: <span class=\"hljs-string\">&#x27;&#x27;</span>, <span class=\"hljs-comment\">// sa description</span>\n      <span class=\"hljs-attr\">isLoading</span>: <span class=\"hljs-literal\">false</span> <span class=\"hljs-comment\">// la requête API est-elle en cours ?</span>\n    }\n  }\n\n  <span class=\"hljs-comment\">// nous externalisons cette fonction afin de</span>\n  <span class=\"hljs-comment\">// pouvoir l&#x27;appeler lorsqu&#x27;on le souhaite</span>\n  _getRandomBrewdogWithFeedback = <span class=\"hljs-function\">() =&gt;</span> {\n    <span class=\"hljs-built_in\">this</span>.setState({ <span class=\"hljs-attr\">isLoading</span>: <span class=\"hljs-literal\">true</span> })\n\n    getRandomBrewdog()\n      .then(<span class=\"hljs-function\"><span class=\"hljs-params\">json</span> =&gt;</span> <span class=\"hljs-built_in\">this</span>.setState({\n        <span class=\"hljs-attr\">name</span>: json.name,\n        <span class=\"hljs-attr\">description</span>: json.description,\n        <span class=\"hljs-attr\">isLoading</span>: <span class=\"hljs-literal\">false</span> <span class=\"hljs-comment\">// la requête est terminée</span>\n      }))\n      .catch(<span class=\"hljs-function\"><span class=\"hljs-params\">error</span> =&gt;</span> <span class=\"hljs-built_in\">console</span>.error(error))\n  }\n\n  <span class=\"hljs-function\"><span class=\"hljs-title\">componentWillMount</span>(<span class=\"hljs-params\"></span>)</span> {\n    <span class=\"hljs-built_in\">this</span>._getRandomBrewdogWithFeedback()\n  }\n\n  <span class=\"hljs-function\"><span class=\"hljs-title\">render</span>(<span class=\"hljs-params\"></span>)</span> {\n    <span class=\"hljs-keyword\">const</span> content = <span class=\"hljs-built_in\">this</span>.state.isLoading\n      ? <span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">ActivityIndicator</span> /&gt;</span></span> <span class=\"hljs-comment\">// si requête en cours, on affiche un spinner</span>\n      : <span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Text</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">{styles.welcome}</span>&gt;</span>\n          Welcome to PutainDeBiere!\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">Text</span>&gt;</span></span>\n\n    <span class=\"hljs-keyword\">return</span> (\n      <span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">View</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">{styles.container}</span>&gt;</span>\n        {content}\n      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">View</span>&gt;</span></span>\n    )\n  }\n}\n\n…\n</code></pre>\n<p>Votre application affiche dorénavant un spinner quelques secondes avant de\nrendre le fameux &quot;Welcome to PutainDeBiere!&quot; le temps que la requête à la\npunkAPI se fasse. Continuons de customiser ce render afin d'afficher les\ninformations retournées (et maintenant présentes dans le state de notre app).</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">App</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Component</span> </span>{\n  …\n\n  <span class=\"hljs-function\"><span class=\"hljs-title\">render</span>(<span class=\"hljs-params\"></span>)</span> {\n    <span class=\"hljs-keyword\">const</span> content = <span class=\"hljs-built_in\">this</span>.state.isLoading\n      ? <span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">ActivityIndicator</span> /&gt;</span></span> <span class=\"hljs-comment\">// si requête en cours, on affiche un spinner</span>\n      : <span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">View</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">{styles.infosContainer}</span>&gt;</span>\n          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Text</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">{styles.name}</span>&gt;</span>\n            {this.state.name} // sinon on affiche le nom de la bière\n          <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">Text</span>&gt;</span>\n\n          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Text</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">{styles.description}</span>&gt;</span>\n            {this.state.description} // sa description\n          <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">Text</span>&gt;</span>\n\n          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">TouchableOpacity</span> // <span class=\"hljs-attr\">on</span> <span class=\"hljs-attr\">ajoute</span> <span class=\"hljs-attr\">un</span> &quot;<span class=\"hljs-attr\">bouton</span>&quot; <span class=\"hljs-attr\">qui</span> <span class=\"hljs-attr\">requ</span>ê<span class=\"hljs-attr\">te</span> <span class=\"hljs-attr\">une</span> <span class=\"hljs-attr\">autre</span> <span class=\"hljs-attr\">bi</span>è<span class=\"hljs-attr\">re</span> <span class=\"hljs-attr\">al</span>é<span class=\"hljs-attr\">atoire</span>\n            <span class=\"hljs-attr\">onPress</span>=<span class=\"hljs-string\">{this._getRandomBrewdogWithFeedback}</span>\n            <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">{styles.button}</span>\n          &gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Text</span>&gt;</span>Grab a new beer!<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">Text</span>&gt;</span>\n          <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">TouchableOpacity</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">View</span>&gt;</span></span>\n\n    <span class=\"hljs-keyword\">return</span> (\n      <span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">View</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">{styles.container}</span>&gt;</span>\n        {content}\n      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">View</span>&gt;</span></span>\n    )\n  }\n}\n\n<span class=\"hljs-keyword\">const</span> styles = StyleSheet.create({\n  <span class=\"hljs-attr\">container</span>: {\n    <span class=\"hljs-attr\">flex</span>: <span class=\"hljs-number\">1</span>,\n    <span class=\"hljs-attr\">justifyContent</span>: <span class=\"hljs-string\">&#x27;center&#x27;</span>,\n    <span class=\"hljs-attr\">alignItems</span>: <span class=\"hljs-string\">&#x27;center&#x27;</span>,\n    <span class=\"hljs-attr\">backgroundColor</span>: <span class=\"hljs-string\">&#x27;#F5FCFF&#x27;</span>,\n  },\n  <span class=\"hljs-comment\">// ajout de styles divers</span>\n  <span class=\"hljs-attr\">infosContainer</span>: {\n    <span class=\"hljs-attr\">margin</span>: <span class=\"hljs-number\">30</span>,\n  },\n  <span class=\"hljs-attr\">name</span>: {\n    <span class=\"hljs-attr\">fontSize</span>: <span class=\"hljs-number\">18</span>,\n    <span class=\"hljs-attr\">fontWeight</span>: <span class=\"hljs-string\">&#x27;700&#x27;</span>,\n    <span class=\"hljs-attr\">marginBottom</span>: <span class=\"hljs-number\">10</span>,\n  },\n  <span class=\"hljs-attr\">description</span>: {\n    <span class=\"hljs-attr\">marginBottom</span>: <span class=\"hljs-number\">10</span>,\n  },\n  <span class=\"hljs-attr\">button</span>: {\n    <span class=\"hljs-attr\">borderWidth</span>: <span class=\"hljs-number\">1</span>,\n    <span class=\"hljs-attr\">borderColor</span>: <span class=\"hljs-string\">&#x27;#000&#x27;</span>,\n    <span class=\"hljs-attr\">borderRadius</span>: <span class=\"hljs-number\">3</span>,\n    <span class=\"hljs-attr\">padding</span>: <span class=\"hljs-number\">5</span>,\n    <span class=\"hljs-attr\">justifyContent</span>: <span class=\"hljs-string\">&#x27;center&#x27;</span>,\n    <span class=\"hljs-attr\">alignItems</span>: <span class=\"hljs-string\">&#x27;center&#x27;</span>,\n  }\n})\n</code></pre>\n<figure>\n  <img src=\"/public/images/articles/2016-10-04-votre-premiere-app-react-native/final_result.png\" alt=\"devmenu + chrome devtools\" />\n  <figcaption>Le rendu \"final\"</figcaption>\n</figure>\n<h2>Et maintenant ?</h2>\n<p>Si vous connaissez déjà React, vous pouvez:</p>\n<ul>\n<li>améliorer le code de l'app avec l'ajout de redux (par exemple) afin de\nsupprimer le state de notre composant</li>\n<li>créer un composant stateless &quot;&lt;Button&gt;&quot;</li>\n<li>styliser davantage l'app à l'aide\nd'<a href=\"https://facebook.github.io/react-native/docs/image.html\">images</a> ou\nd'<a href=\"https://facebook.github.io/react-native/docs/animations.html\">animations</a></li>\n<li>désactiver et modifier le style du bouton lors d'une requête API</li>\n<li>gérer les erreurs de requêtage de façon un poil plus élégante que de balancer\nune erreur à la tête de l'utilisateur</li>\n</ul>\n<p>Si ce n'est pas le cas, n'hésitez pas à lire ces deux articles pour vous\nfamiliariser avec ces librairies avant de continuer sur votre lancée:</p>\n<ul>\n<li><a href=\"/fr/articles/js/react/\">Introduction à React</a></li>\n<li><a href=\"/fr/articles/js/redux/\">Redux, comment ça marche ?</a></li>\n</ul>\n<p>Bonne découverte !</p>\n"}}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"listsRequests":{"data":{"RE_PRIVATE_NONE":true}},"itemsRequests":{"data":{"RE_PRIVATE_NONE":true}}}</script><head><script defer="defer" src="/public/main.56c69761a03eb0112696.js"></script></head></html>