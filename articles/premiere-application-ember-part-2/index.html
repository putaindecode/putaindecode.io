<!DOCTYPE html><html lang="fr"><head><title data-react-helmet="true">Première application Ember (part 2) | Putain de code</title><meta data-react-helmet="true" charset="UTF-8"/><meta data-react-helmet="true" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover" name="viewport"/><meta data-react-helmet="true" content="summary_large_image" name="twitter:card"/><meta data-react-helmet="true" content="Putain de code !" property="og:site_name"/><meta data-react-helmet="true" content="@putaindecode" name="twitter:site"/><meta data-react-helmet="true" content="https://putaindecode.io/public/images/website/share.jpg" property="og:image"/><meta data-react-helmet="true" content="https://putaindecode.io/public/images/website/share.jpg" name="twitter:image"/><meta data-react-helmet="true" content="1500" property="og:image:width"/><meta data-react-helmet="true" content="777" property="og:image:height"/><meta data-react-helmet="true" content="Première application Ember (part 2) | Putain de code" property="og:title"/><meta data-react-helmet="true" content="Première application Ember (part 2) | Putain de code" name="twitter:title"/><meta data-react-helmet="true" content="Un article proposé par bmeurant" name="description"/><link data-react-helmet="true" title="RSS Feed" href="/api/articles/feeds/desc/feed.xml" rel="alternate" type="application/rss+xml"/><link data-react-helmet="true" href="/favicon.ico" rel="shortcut icon"/><link data-react-helmet="true" href="https://putaindecode.io/articles/premiere-application-ember-part-2" rel="canonical"/><script>window.PAGES_BOOT_MODE="hydrate";</script></head><div id="root"><style data-emotion="rpcss zx73cm 1lc6tyj 28v1b4">@-webkit-keyframes animation-zx73cm{from{opacity:0;-webkit-transform:translateY(20px);-moz-transform:translateY(20px);-ms-transform:translateY(20px);transform:translateY(20px);}}@keyframes animation-zx73cm{from{opacity:0;-webkit-transform:translateY(20px);-moz-transform:translateY(20px);-ms-transform:translateY(20px);transform:translateY(20px);}}:root{--page-background-color:#fff;--page-slightly-accented-background-color:#F9F6F6;--page-accented-background-color:#E4EBEE;--page-text-color:#46515B;--link-text-color:#E51D58;--gradient-red-top:#E51D58;--gradient-red-bottom:#CC0613;--code-background-color:#FAF3E1;--one-percent-contrast-color:rgba(0, 0, 0, 0.1);--half-percent-contrast-color:rgba(0, 0, 0, 0.05);}@media (prefers-color-scheme: dark){:root{--page-background-color:#222;--page-slightly-accented-background-color:#171717;--page-accented-background-color:#111;--page-text-color:#ddd;--link-text-color:#F87098;--gradient-red-top:#E51D58;--gradient-red-bottom:#CC0613;--code-background-color:#4F3804;--one-percent-contrast-color:rgba(255, 255, 255, 0.1);--half-percent-contrast-color:rgba(255, 255, 255, 0.05);}}body{padding:0;margin:0;background-color:var(--page-background-color);color:var(--page-text-color);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;overflow-x:hidden;}html{font-size:1em;line-height:1.4;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%;}a{color:var(--link-text-color);-webkit-text-decoration:underline;text-decoration:underline;}a:hover{-webkit-text-decoration:none;text-decoration:none;}#root{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}*,*:before,*:after{box-sizing:border-box;}pre,.hljs{color:#adbac7;background:#22272e;}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#f47067;}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#dcbdfb;}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-variable,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id{color:#6cb6ff;}.hljs-regexp,.hljs-string,.hljs-meta .hljs-string{color:#96d0ff;}.hljs-built_in,.hljs-symbol{color:#f69d50;}.hljs-comment,.hljs-code,.hljs-formula{color:#768390;}.hljs-name,.hljs-quote,.hljs-selector-tag,.hljs-selector-pseudo{color:#8ddb8c;}.hljs-subst{color:#adbac7;}.hljs-section{color:#316dca;font-weight:bold;}.hljs-bullet{color:#eac55f;}.hljs-emphasis{color:#adbac7;font-style:italic;}.hljs-strong{color:#adbac7;font-weight:bold;}.hljs-addition{color:#b4f1b4;background-color:#1b4721;}.hljs-deletion{color:#ffd8d3;background-color:#78191b;}</style><style data-emotion="rpcss 9vhaby">.rpcss-9vhaby{background-color:var(--gradient-red-bottom);background-image:linear-gradient(to bottom right, var(--gradient-red-top), var(--gradient-red-bottom));}</style><header class="rpcss-9vhaby" style="background-image:linear-gradient(to bottom right, hsl(352, 100%, 35%), hsl(292, 100%, 30%))"><style data-emotion="rpcss 1qqk0tr">.rpcss-1qqk0tr{padding-left:env(safe-area-inset-left);padding-right:env(safe-area-inset-right);}</style><div class="rpcss-1qqk0tr"><style data-emotion="rpcss qx7dny">.rpcss-qx7dny{width:100%;max-width:1024px;margin:0 auto;padding:0 10px;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;}</style><div class="rpcss-qx7dny"><style data-emotion="rpcss 7s9om2">.rpcss-7s9om2{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding:20px 0 50px;}</style><div class="rpcss-7s9om2"><style data-emotion="rpcss gdpa5c">.rpcss-gdpa5c{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-text-decoration:none;text-decoration:none;}</style><a class="rpcss-gdpa5c" href="/"><style data-emotion="rpcss 1lm4738">.rpcss-1lm4738{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-text-decoration:none;text-decoration:none;padding-bottom:10px;}</style><div class="rpcss-1lm4738"><style data-emotion="rpcss 13o7eu2">.rpcss-13o7eu2{display:block;}</style><svg class="rpcss-13o7eu2" height="36px" width="36px" viewBox="0 0 36 36"><defs><linearGradient id="PutainDeCodeLogoGradient" x1="50%" x2="50%" y1="0%" y2="127.223881%"><stop offset="0%" stop-color="#E41D57"></stop><stop offset="100%" stop-color="#C60000"></stop></linearGradient></defs><circle cx="18" cy="18" fill="url(#PutainDeCodeLogoGradient)" r="17" stroke="#FFFFFF" stroke-width="2"></circle><polygon fill="#FFFFFF" points="15.9033203 18.2246094 15.9033203 18.3710938 11.2304688 20.5317383 11.2304688 22.8095703 18.0566406 19.184082 18.0566406 17.4116211 11.2304688 13.7788086 11.2304688 16.0639648"></polygon><rect height="14" width="2" fill="#FFFFFF" x="22" y="11"><animate attributeName="opacity" begin="100ms" calcMode="discrete" dur="2s" repeatCount="indefinite" values="1;0"></animate></rect></svg><style data-emotion="rpcss 4cf197">.rpcss-4cf197{width:10px;height:10px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}</style><div class="rpcss-4cf197"></div><style data-emotion="rpcss u5k24">.rpcss-u5k24{font-size:22px;color:#fff;font-weight:800;}</style><div aria-level="2" class="rpcss-u5k24" role="heading">Putain de code !</div></div><style data-emotion="rpcss 1nyebg4">.rpcss-1nyebg4{font-size:14px;color:rgba(255, 255, 255, 0.8);text-align:center;}</style><div class="rpcss-1nyebg4">Blog participatif de la communauté dev</div></a></div></div></div></header><style data-emotion="rpcss a4ric9">.rpcss-a4ric9{background-color:var(--page-slightly-accented-background-color);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}</style><div class="rpcss-a4ric9"><style data-emotion="rpcss oeugsb">.rpcss-oeugsb{-webkit-animation:500ms ease-out animation-zx73cm;animation:500ms ease-out animation-zx73cm;}</style><div class="rpcss-oeugsb"><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 1qc2bam">.rpcss-1qc2bam{font-size:42px;font-weight:800;text-align:center;padding-top:40px;line-height:1.2;margin:0;}</style><h1 class="rpcss-1qc2bam">Première application Ember (part 2)</h1><style data-emotion="rpcss obg2kr">.rpcss-obg2kr{font-size:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding-top:10px;padding-bottom:40px;color:var(--page-text-color);-webkit-text-decoration:none;text-decoration:none;}</style><a class="rpcss-obg2kr" href="https://github.com/bmeurant"><style data-emotion="rpcss uco8i7">.rpcss-uco8i7{width:32px;height:32px;border-radius:100%;margin-right:10px;}</style><img class="rpcss-uco8i7" alt="bmeurant" src="https://avatars.githubusercontent.com/bmeurant?size=64"/><div>bmeurant<!-- --> <!-- -->•<!-- --> <!-- -->2014/12/09</div></a><style data-emotion="rpcss 15kxmi0">.rpcss-15kxmi0{max-width:640px;width:100%;font-size:18px;margin:0 auto;line-height:1.7;}.rpcss-15kxmi0 h2,.rpcss-15kxmi0 h3,.rpcss-15kxmi0 h4,.rpcss-15kxmi0 h5,.rpcss-15kxmi0 h6{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;font-weight:800;line-height:1.2;}.rpcss-15kxmi0 img{max-width:100%;background-color:rgba(255, 255, 255, 0.75);}.rpcss-15kxmi0 code{font-size:0.9em;font-family:PragmataPro,SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;line-height:1;background-color:var(--code-background-color);margin:0 0.2em;}.rpcss-15kxmi0 pre{padding:10px;overflow-x:auto;font-size:14px;border-radius:10px;border:2px solid var(--one-percent-contrast-color);-webkit-overflow-scrolling:touch;}.rpcss-15kxmi0 pre code{font-size:14px;background-color:transparent;margin:0;}.rpcss-15kxmi0 blockquote{padding-left:20px;margin:0;font-size:16px;border-left:3px solid var(--one-percent-contrast-color);font-style:italic;}.rpcss-15kxmi0 table{width:100%;text-align:center;}.rpcss-15kxmi0 figure{padding:20px 0;}.rpcss-15kxmi0 figcaption{text-align:center;}.rpcss-15kxmi0 a{word-wrap:break-word;}.rpcss-15kxmi0 table thead th{background-color:var(--page-accented-background-color);padding:10px 0;}</style><div class="rpcss-15kxmi0"><p>L'<a href="/fr/articles/js/ember/premiere-app/1">article précédent</a> vous a accompagné
pour la création d'une première application <a href="http://emberjs.com">Ember</a>. Mais il faut bien
reconnaître que l'exemple était très simple et que, du coup, le mérite est
faible. Pour se rattraper, on va complexifier un peu les choses.</p>
<p>Tout comme dans l'article précédent, nous détaillerons régulièrement les
concepts mis en œuvre. Parce que vous le valez bien.</p>
<h2>Sommaire</h2>
<ul>
<li><a href="#edition-d-une-serie">Édition d'une série</a>
<ul>
<li><a href="#routes-imbriquees">Routes imbriquées</a></li>
<li><a href="#-code-outlets-code-">Outlets</a></li>
<li><a href="#liens-entre-routes">Liens entre routes</a></li>
<li><a href="#enregistrement-des-modifications">Enregistrement des modifications</a></li>
<li><a href="#actions-sur-les-transitions">Actions sur les transitions</a></li>
</ul></li>
<li><a href="#relations-avec-ember-data">Relations avec Ember Data</a></li>
<li><a href="#insertion-d-un-gabarit">Insertion d'un gabarit</a></li>
<li><a href="#creation-d-une-nouvelle-serie">Création d'une nouvelle série</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<h2>Édition d'une série</h2>
<p>On veut pouvoir basculer depuis la fiche d'une série vers son édition en mode
<em>in place</em>. C'est-à-dire en <strong>remplaçant</strong> la zone de visualisation de cette
fiche par sa zone d'édition.</p>
<p>On accède à la fiche en mode visualisation à l'URL <code>/series/{id}/</code> et en mode
édition à l'URL <code>/series/{id}/edit</code>. Évidemment, on reconstruit uniquement la
zone de la fiche et non l'application entière (et donc ni l'en-tête ni la liste
des séries).</p>
<h3>Routes imbriquées</h3>
<p>Commençons par définir une nouvelle route <code>edit</code>, sous-route de <code>seriesItem</code> :</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// /app/router.js</span>
Router.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">this</span>.resource(<span class="hljs-string">&quot;series&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">this</span>.route(<span class="hljs-string">&quot;seriesItem&quot;</span>, { <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/:seriesItem_id&quot;</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">this</span>.route(<span class="hljs-string">&quot;edit&quot;</span>);
    });
  });
});
</code></pre>
<p>Pour que notre nouvelle route affiche la fiche en mode édition, on doit -
<a href="/fr/articles/js/ember/#les-fondamentaux">rappelez-vous</a> - impérativement suivre
les
<a href="http://emberjs.com/guides/concepts/naming-conventions/">conventions de nommage</a>
et créer un gabarit <code>edit.hbs</code> dans le répertoire
<code>/app/templates/series/series-item/</code> :</p>
<pre><code class="hljs language-html"><span class="hljs-comment">&lt;!-- /app/templates/series/series-item/edit.hbs` --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;series-details&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;cancel&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cancel&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;title&quot;</span>&gt;</span>{{input id=&quot;title&quot; type=&quot;text&quot; value=title}}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">img</span>
    {{<span class="hljs-attr">bind-attr</span>
    <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;coverUrl&quot;</span>
    }}
    <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;Series&#x27;s first album cover&quot;</span>
    <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cover&quot;</span>
  /&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;description&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;scriptwriter&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;scriptwriter&quot;</span>&gt;</span>Scriptwriter<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;control&quot;</span>
        &gt;</span>{{input id=&quot;scriptwriter&quot; type=&quot;text&quot; value=scriptwriter
        required=&quot;required&quot;}}&lt;/span
      &gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;illustrator&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;illustrator&quot;</span>&gt;</span>Illustrator<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;control&quot;</span>
        &gt;</span>{{input id=&quot;illustrator&quot; type=&quot;text&quot; value=illustrator}}&lt;/span
      &gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;publisher&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;publisher&quot;</span>&gt;</span>Publisher<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;control&quot;</span>
        &gt;</span>{{input id=&quot;publisher&quot; type=&quot;text&quot; value=publisher}}&lt;/span
      &gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;summary&quot;</span>&gt;</span>{{textarea value=summary rows=&quot;10&quot;}}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
</code></pre>
<p>À ce stade, naviguer sur <code>/series/{@id}/edit</code> ne lève pas d'erreur mais n'a
aucun effet. En effet, on a défini une route imbriquée mais conservé le gabarit
<code>/app/templates/series/series-item.hbs</code> inchangé. L'activation de la route
<code>series.seriesItem</code> affiche donc toujours ce gabarit, même dans le cas d'une
sous-route telle que <code>series.seriesItem.edit</code>.</p>
<h3><code>outlets</code></h3>
<p>La solution est à aller chercher du côté du concept d'<code>{{outlet}}</code> défini dans
l'<a href="/fr/articles/js/ember/premiere-app/1/#-code-outlet-code-et-routes-imbriquees">article précédent</a>.
Un <code>{{outlet}}</code> est nécessaire <strong>à chaque fois qu'on définit un niveau
d'imbrication.</strong> Mais comme on veut quand même continuer à afficher la série à
l'URL <code>/series/{@id}/</code>, on va utiliser la <strong>route implicite</strong>
<code>series.seriesItem.index</code> (cf.
<a href="/fr/articles/js/ember/premiere-app/1/#routes-et-controleurs-implicites">article précédent</a>)
et son gabarit, dans lequel on va copier l'ancien contenu de <code>series-item.hbs</code>.</p>
<pre><code class="hljs language-html"><span class="hljs-comment">&lt;!-- /app/templates/series/series-item/index.hbs --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;series-details&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{{title}}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">img</span>
    {{<span class="hljs-attr">bind-attr</span>
    <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;coverUrl&quot;</span>
    }}
    <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;Series&#x27;s first album cover&quot;</span>
    <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cover&quot;</span>
  /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">dl</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;description&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dt</span>&gt;</span>scriptwriter<span class="hljs-tag">&lt;/<span class="hljs-name">dt</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dd</span>&gt;</span>{{scriptwriter}}<span class="hljs-tag">&lt;/<span class="hljs-name">dd</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dt</span>&gt;</span>illustrator<span class="hljs-tag">&lt;/<span class="hljs-name">dt</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dd</span>&gt;</span>{{illustrator}}<span class="hljs-tag">&lt;/<span class="hljs-name">dd</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dt</span>&gt;</span>publisher<span class="hljs-tag">&lt;/<span class="hljs-name">dt</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dd</span>&gt;</span>{{publisher}}<span class="hljs-tag">&lt;/<span class="hljs-name">dd</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">dl</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;summary&quot;</span>&gt;</span>
    {{summary}}
  <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>Le gabarit <code>series-item.hbs</code> est quant à lui modifié car il doit changer en
fonction de la sous-route activée. Et puisqu'on ne veut rien afficher de plus,
son contenu se résume à un <code>{{outlet}}</code> :</p>
<pre><code class="hljs language-html"><span class="hljs-comment">&lt;!-- /app/templates/series-item.hbs --&gt;</span>
{{outlet}}
</code></pre>
<p>Et voilà ! L'affichage de l'URL <code>/series/{@id}/</code> est inchangé alors que l'URL
<code>/series/{@id}/edit</code> affiche désormais le formulaire d'édition.</p>
<h3>Liens entre routes</h3>
<p>Pour pouvoir plus facilement basculer en mode édition, on ajoute un lien vers la
route correspondante grâce à <code>link-to</code> (cf.
<a href="http://emberjs.com/guides/templates/links/">doc officielle</a>).</p>
<pre><code class="hljs language-html"><span class="hljs-comment">&lt;!-- /app/templates/series/series-item/index.hbs --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;series-details&quot;</span>&gt;</span>
  {{#link-to &#x27;series.seriesItem.edit&#x27; id class=&quot;edit&quot;}}edit{{/link-to}}
  <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{{title}}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
  ...
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>On note que la route vers laquelle le lien pointe est préfixée par <code>series</code>
parce qu'on a défini une route et non une resource. En effet, une ressource
réinitialise l'espace de nommage et permet donc des noms de routes plus courts.
Pour pouvoir pointer vers <code>seriesItem.edit</code> on aurait donc dû remplacer
<code>this.route('seriesItem', ...</code> par <code>this.resource('seriesItem', ...</code>.</p>
<p>On peut désormais éditer notre série. On remarque au passage que la modification
du titre de la série le met également à jour en temps réel dans la liste des
séries grâce au <em>binding</em> (cf.
<a href="/fr/articles/js/ember/premiere-app/1/#-em-bindings-em-et-mise-a-jour-des-gabarits">article précédent</a>).</p>
<h3>Enregistrement des modifications</h3>
<p>Nous allons maintenant rendre opérationnels nos deux boutons d'édition <em>annuler</em>
et <em>valider</em>. Pour cela, on commence par associer des actions à nos boutons :</p>
<pre><code class="hljs language-html"><span class="hljs-comment">&lt;!-- /app/templates/series/series-item/edit.hbs` --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;series-details&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> {{<span class="hljs-attr">action</span> &quot;<span class="hljs-attr">submit</span>&quot;}} <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;reset&quot;</span> {{<span class="hljs-attr">action</span> &quot;<span class="hljs-attr">cancel</span>&quot;}} <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cancel&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
...
</code></pre>
<p>Comme il s'agit de manipulations sur le modèle et de transitions entre routes,
les actions correspondantes seront traitées par la route.</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// app/routes/series/series-item/edit.js</span>
<span class="hljs-keyword">import</span> Ember <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;ember&quot;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Ember.Route.extend({
  <span class="hljs-attr">model</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.modelFor(<span class="hljs-string">&quot;series.seriesItem&quot;</span>);
  },
  <span class="hljs-attr">actions</span>: {
    <span class="hljs-attr">submit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">this</span>.modelFor(<span class="hljs-string">&quot;series.seriesItem.edit&quot;</span>)
        .save()
        .then(
          <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-built_in">this</span>.transitionTo(<span class="hljs-string">&quot;series.seriesItem&quot;</span>);
          }.bind(<span class="hljs-built_in">this</span>),
        );
    },

    <span class="hljs-attr">cancel</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">this</span>.modelFor(<span class="hljs-string">&quot;series.seriesItem.edit&quot;</span>).rollback();
      <span class="hljs-built_in">this</span>.transitionTo(<span class="hljs-string">&quot;series.seriesItem&quot;</span>);
    },
  },
});
</code></pre>
<p>Quelques mots sur ces quelques lignes :</p>
<ul>
<li>Dans une <code>route</code>, le modèle courant est récupéré via
<code>this.modelFor('nomRoute')</code>. Ici, on récupère explicitement le modèle chargé
automatiquement (par convention) par la route mère <code>seriesItem</code>. Notez qu'on
aurait pu omettre la récupération du modèle complètement car la route mère
s'en occupe pour nous.</li>
<li>Une fois le modèle récupéré, on peut invoquer les méthodes apportées par
<a href="https://github.com/emberjs/data">Ember Data</a>.</li>
<li>Pour un <code>cancel</code>, on invoque <code>rollback()</code> : toutes les modifications
effectuées sont annulées et le modèle est réinitialisé.</li>
<li>Pour un <code>submit</code>, on invoque un <code>save()</code> qui enregistre les modifications
apportées au modèle dans le <em>magasin</em>
(<a href="http://emberjs.com/api/data/classes/DS.Store.html">Store</a>) d'<a href="https://github.com/emberjs/data">Ember
Data</a>.</li>
<li>Les opérations effectuées sur les modèles sont bien souvent asynchrones
puisque, dans le cas nominal, elles font intervenir des API REST pour
enregistrer ou mettre à jour les données depuis un serveur. Dans le cas où
l'on souhaite attendre la fin du traitement pour effectuer une action (comme
ici dans le cas du <code>save</code>), il est nécessaire d'utiliser les <em>promesses</em>
(<code>promises</code>) qu'<a href="https://github.com/emberjs/data">Ember Data</a> renvoie (<code>.then(...)</code>). Dans le cas
contraire, le code serait exécuté avant la fin du traitement et ne permettrait
pas de proposer un retour utilisateur propre (gestion des cas d'erreurs
notamment).</li>
<li>Les transitions entre routes sont possibles via
<code>this.transitionTo('nomRoute')</code>.</li>
</ul>
<h3>Actions sur les transitions</h3>
<p>Mais je voudrais encore ajouter une dernière petite cerise sur ce gâteau :
annuler automatiquement toutes les modifications effectuées sur la série dès que
l'on quitte la route. <a href="http://emberjs.com">Ember</a> prévoit en effet des mécanismes avancés
pour travailler sur les transitions entre routes (cf.
<a href="http://emberjs.com/guides/routing/preventing-and-retrying-transitions/">doc officielle</a>).
En particulier <code>willTransition</code> :</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// app/routes/series/series-item/edit.js</span>
  <span class="hljs-attr">actions</span>: {
    ...
    <span class="hljs-attr">willTransition</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">this</span>.modelFor(<span class="hljs-string">&#x27;series.seriesItem.edit&#x27;</span>).rollback();
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
  }
</code></pre>
<p>L'action est très simple ici mais on imagine facilement comment on pourrait
ajouter une confirmation et déterminer, en fonction de la réponse, si l'on doit
continuer la transition ou l'abandonner.</p>
<h2>Relations avec <a href="https://github.com/emberjs/data">Ember Data</a></h2>
<p><a href="https://github.com/emberjs/data">Ember Data</a> permet de définir des relations entre nos modèles.
Ajoutons donc des albums à nos séries :</p>
<p>On définit d'abord une nouvelle entité <code>Album</code> et ses propriétés et on indique
que cet album était associé à une série via la propriété <code>series</code> et à la
méthode <code>DS.belongsTo</code> (cf.
<a href="http://emberjs.com/api/data/#method_belongsTo">doc officielle</a>). Ce qui se
traduit plus loin, dans l'initialisation des données par <code>series: 1</code> où 1 est
l'identifiant de la série en question.</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// /app/models/album.js</span>
<span class="hljs-keyword">import</span> DS <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;ember-data&quot;</span>;

<span class="hljs-keyword">var</span> Album = DS.Model.extend({
  <span class="hljs-attr">title</span>: DS.attr(<span class="hljs-string">&quot;string&quot;</span>),
  <span class="hljs-attr">publicationDate</span>: DS.attr(<span class="hljs-string">&quot;date&quot;</span>),
  <span class="hljs-attr">number</span>: DS.attr(<span class="hljs-string">&quot;number&quot;</span>),
  <span class="hljs-attr">coverName</span>: DS.attr(<span class="hljs-string">&quot;string&quot;</span>, { <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">&quot;default.jpg&quot;</span> }),
  <span class="hljs-attr">series</span>: DS.belongsTo(<span class="hljs-string">&quot;seriesItem&quot;</span>),
  <span class="hljs-attr">coverUrl</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;/assets/images/albums/covers/&quot;</span> + <span class="hljs-built_in">this</span>.get(<span class="hljs-string">&quot;coverName&quot;</span>);
  }.property(<span class="hljs-string">&quot;coverName&quot;</span>),
});

Album.reopenClass({
  <span class="hljs-attr">FIXTURES</span>: [
    {
      <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">title</span>: <span class="hljs-string">&quot;Somewhere Within the Shadows&quot;</span>,
      <span class="hljs-attr">publicationDate</span>: <span class="hljs-string">&quot;Nov 2000&quot;</span>,
      <span class="hljs-attr">number</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">coverName</span>: <span class="hljs-string">&quot;blacksad-1.jpg&quot;</span>,
      <span class="hljs-attr">series</span>: <span class="hljs-number">1</span>,
    },
    {
      <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>,
      <span class="hljs-attr">title</span>: <span class="hljs-string">&quot;Arctic-Nation&quot;</span>,
      <span class="hljs-attr">publicationDate</span>: <span class="hljs-string">&quot;Mar 2003&quot;</span>,
      <span class="hljs-attr">number</span>: <span class="hljs-number">2</span>,
      <span class="hljs-attr">coverName</span>: <span class="hljs-string">&quot;blacksad-2.jpg&quot;</span>,
      <span class="hljs-attr">series</span>: <span class="hljs-number">1</span>,
    },
  ],
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Album;
</code></pre>
<p>On modifie ensuite le modèle <code>SeriesItem</code> pour indiquer une relation inverse
grâce à la propriété <code>albums</code> et à la méthode <code>DS.hasMany</code> (cf.
<a href="http://emberjs.com/api/data/#method_hasMany">doc officielle</a>) puis affecter la
liste des identifiants des albums à la série via <code>albums: [1, 2]</code> :</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// /app/models/series-item.js</span>
<span class="hljs-keyword">import</span> DS <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;ember-data&#x27;</span>;

<span class="hljs-keyword">var</span> SeriesItem = DS.Model.extend({
    <span class="hljs-attr">title</span>               : DS.attr(<span class="hljs-string">&#x27;string&#x27;</span>, {<span class="hljs-attr">defaultValue</span>: <span class="hljs-string">&#x27;New Series&#x27;</span>}),
    ...
    <span class="hljs-attr">albums</span>              : DS.hasMany(<span class="hljs-string">&#x27;album&#x27;</span>, {<span class="hljs-attr">async</span>: <span class="hljs-literal">true</span>})
});

SeriesItem.reopenClass({
    <span class="hljs-attr">FIXTURES</span>: [{
    <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
    ...
    <span class="hljs-attr">albums</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
    }, ...
]});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> SeriesItem;
</code></pre>
<h2>Insertion d'un gabarit</h2>
<p>Maintenant qu'on a des albums pour nos séries, on serait bien intéressé de les
voir s'afficher. Seulement voilà, on veut juste les afficher à côté de la
visualisation d'une série. On ne veut rien proposer d'autre pour ces albums que
le <em>binding</em> des propriétés et leur affichage. Pas besoin de route ou de
contrôleur. On va pour cela utiliser un outil particulier permettant simplement
d'insérer (d'afficher) un gabarit au sein d'une route existante via le <em>helper</em>
: <code>render</code> (cf.
<a href="http://emberjs.com/guides/templates/rendering-with-helpers/#toc_the-code-view-code-helper">doc officielle</a>).</p>
<p>On modifie donc le gabarit <code>/series/series-item.hbs</code> pour qu'à côté de la fiche
d'une série soit affichée la liste de ses albums :</p>
<pre><code class="hljs language-html"><span class="hljs-comment">&lt;!-- /app/templates/series/series-item.hbs --&gt;</span>

{{outlet}}

<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;series-albums&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
    {{#each album in albums}} {{render &#x27;partials/albumItem&#x27; album}} {{/each}}
  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-html"><span class="hljs-comment">&lt;!-- /app/templates/partials/album-item.hbs --&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;album&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> {{<span class="hljs-attr">bind-attr</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;coverUrl&quot;</span> }} <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;Album cover&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cover&quot;</span> /&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;description&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>{{title}}<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dl</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">dt</span>&gt;</span>volume<span class="hljs-tag">&lt;/<span class="hljs-name">dt</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">dd</span>&gt;</span>{{number}}<span class="hljs-tag">&lt;/<span class="hljs-name">dd</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">dt</span>&gt;</span>date<span class="hljs-tag">&lt;/<span class="hljs-name">dt</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">dd</span>&gt;</span>{{publicationDate}}<span class="hljs-tag">&lt;/<span class="hljs-name">dd</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dl</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
</code></pre>
<h2>Création d'une nouvelle série</h2>
<p>Histoire de terminer en beauté on va ajouter vite fait la création d'une série.</p>
<p>Comme on commence à avoir l'habitude, on fait ça en deux coups de cuillère à pot
:</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// /app/router.js</span>
Router.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">this</span>.resource(<span class="hljs-string">&quot;series&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">this</span>.route(<span class="hljs-string">&quot;seriesItem&quot;</span>, { <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/:seriesItem_id&quot;</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">this</span>.route(<span class="hljs-string">&quot;edit&quot;</span>);
    });
    <span class="hljs-built_in">this</span>.route(<span class="hljs-string">&quot;create&quot;</span>);
  });
});
</code></pre>
<pre><code class="hljs language-js"><span class="hljs-comment">// /app/routes/series/create.js</span>
<span class="hljs-keyword">import</span> Ember <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;ember&quot;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Ember.Route.extend({
  <span class="hljs-attr">model</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.store.createRecord(<span class="hljs-string">&quot;seriesItem&quot;</span>);
  },

  <span class="hljs-attr">renderTemplate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">this</span>.render(<span class="hljs-string">&quot;series.seriesItem.edit&quot;</span>);
  },

  <span class="hljs-attr">actions</span>: {
    <span class="hljs-attr">submit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">this</span>.modelFor(<span class="hljs-string">&quot;series.create&quot;</span>)
        .save()
        .then(
          <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-built_in">this</span>.transitionTo(
              <span class="hljs-string">&quot;series.seriesItem&quot;</span>,
              <span class="hljs-built_in">this</span>.modelFor(<span class="hljs-string">&quot;series.create&quot;</span>),
            );
          }.bind(<span class="hljs-built_in">this</span>),
        );
    },

    <span class="hljs-attr">cancel</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">this</span>.modelFor(<span class="hljs-string">&quot;series.create&quot;</span>).rollback();
      <span class="hljs-built_in">this</span>.transitionTo(<span class="hljs-string">&quot;series&quot;</span>);
    },

    <span class="hljs-attr">willTransition</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">this</span>.modelFor(<span class="hljs-string">&quot;series.create&quot;</span>).rollback();
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    },
  },
});
</code></pre>
<pre><code class="hljs language-html"><span class="hljs-comment">&lt;!-- /app/templates/series.hbs --&gt;</span>
    ...
      {{/each}}
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;series-item&quot;</span>&gt;</span>
          {{#link-to &#x27;series.create&#x27; class=&quot;add&quot;}}add{{/link-to}}
        <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    ...
</code></pre>
<p>Les points importants à noter :</p>
<ul>
<li>Le modèle est, cette fois-ci, créé à l'activation de la route via
<code>this.store.createRecord(...)</code>.</li>
<li>Comme on ne souhaite pas proposer de gabarit propre pour cette route, on
utilise <code>renderTemplate</code> pour indiquer à <a href="http://emberjs.com">Ember</a> quel gabarit il doit
utiliser.</li>
<li>Les actions <code>submit</code>, <code>cancel</code> et <code>willTransition</code> sont sensiblement les mêmes
que pour l'édition mais travaillent sur un modèle différent et renvoient vers
d'autres routes.</li>
<li>On note le passage du modèle lors de la transition en cas de <code>submit</code>.</li>
<li>Il serait légitime de se poser la question de réutilisation de code entre ces
deux routes, compte tenu des similarités. Ce n'est pas l'objet de l'article
mais pourrait être envisagé à l'aide d'un <code>mixin</code> partagé (cf.
<a href="http://emberjs.com/api/classes/Ember.Mixin.html">doc officielle</a>).</li>
</ul>
<h2>Conclusion</h2>
<p>Au travers de cet article et des précédents, j'espère vous avoir donné un aperçu
du modèle de développement que propose <a href="http://emberjs.com">Ember</a>. Vous avez compris,
j'espère, qu'<a href="http://emberjs.com">Ember</a> est un véritable framework avec des opinions fortes
et qu'il doit être pris comme tel ou laissé de côté pour une solution plus
légère selon vos besoins.</p>
<p>Mais j'ai également essayé d'aller plus en profondeur sur certains aspects et de
montrer des cas d'utilisation concrets. Ce dernier article montre qu'il est
également possible de fournir à <a href="http://emberjs.com">Ember</a> des configurations explicites
afin d'aller plus loin que les conventions par défaut.</p>
<p>Maintenant, vous n'avez plus d'excuses... Vous ne pourrez pas dire que vous ne
connaissiez pas.</p>
<p><em>Note: les sources de l'application exemple sont
<a href="https://github.com/bmeurant/ember-articles/tree/premiere-app-ember-suite">disponibles sur github</a>.</em></p>
</div><style data-emotion="rpcss unyj6i">.rpcss-unyj6i{max-width:640px;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin:20px auto;padding:20px;background-color:var(--page-background-color);border-radius:10px;box-shadow:0 15px 15px -5px rgba(0, 0, 0, 0.2);}@media (max-width: 540px){.rpcss-unyj6i{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><div class="rpcss-unyj6i"><style data-emotion="rpcss ty7r4z">.rpcss-ty7r4z{font-weight:800;}</style><div class="rpcss-ty7r4z">Vous avez aimé cet article?</div><style data-emotion="rpcss klacsp">.rpcss-klacsp{width:0;height:10px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}</style><div class="rpcss-klacsp"></div><style data-emotion="rpcss 1pkr03v">.rpcss-1pkr03v{background-color:#00aced;color:#fff;padding:10px 20px;-webkit-text-decoration:none;text-decoration:none;border-radius:5px;font-weight:800;}.rpcss-1pkr03v:active{opacity:0.5;}</style><a class="rpcss-1pkr03v" href="https://www.twitter.com/intent/tweet?text=Premi%C3%A8re%20application%20Ember%20(part%202)%20sur%20%40PutainDeCode%20https%3A%2F%2Fputaindecode.io%2Farticles%2Fpremiere-application-ember-part-2" target="_blank">Le partager sur Twitter</a></div><style data-emotion="rpcss x4iqxe">.rpcss-x4iqxe{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;text-align:center;padding:20px;}</style><div class="rpcss-x4iqxe"><style data-emotion="rpcss gein6x">.rpcss-gein6x{font-size:20px;-webkit-text-decoration:none;text-decoration:none;color:#1E49B5;}</style><a class="rpcss-gein6x" href="/articles">← Articles</a></div><style data-emotion="rpcss 8bodgl">.rpcss-8bodgl{max-width:640px;width:100%;margin:0 auto;padding:20px 0;}</style><div class="rpcss-8bodgl" id="disqus_thread"></div></div></div></div></div><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 1vau6rl">.rpcss-1vau6rl{margin:20px 0;background-color:var(--page-accented-background-color);border-radius:10px;padding:20px;}</style><div class="rpcss-1vau6rl"><style data-emotion="rpcss 1gz1i1h">.rpcss-1gz1i1h{font-size:32px;font-weight:800;margin-bottom:20px;text-align:center;}</style><div aria-level="2" class="rpcss-1gz1i1h" role="heading">Ne rien rater</div><style data-emotion="rpcss 1wbispj">.rpcss-1wbispj{font-size:18px;margin-bottom:10px;text-align:center;}</style><div aria-level="3" class="rpcss-1wbispj" role="heading">Sur les réseaux</div><style data-emotion="rpcss 1hyoz7m">.rpcss-1hyoz7m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;}</style><div class="rpcss-1hyoz7m"><a href="https://twitter.com/PutainDeCode"><img alt="Twitter" height="48" src="/public/images/website/twitter.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://facebook.com/putaindecode"><img alt="Facebook" height="48" src="/public/images/website/facebook.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://github.com/putaindecode"><img alt="Facebook" height="48" src="/public/images/website/github.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://itunes.apple.com/fr/podcast/putain-de-code-!/id1185311825"><img alt="Apple Podcast" height="48" src="/public/images/website/apple-podcast.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://soundcloud.com/putaindecode"><img alt="Soundcloud" height="48" src="/public/images/website/soundcloud.svg" width="48"/></a></div><div aria-level="3" class="rpcss-1wbispj" role="heading">Sur le chat</div><div class="rpcss-1hyoz7m"><a href="https://discord.gg/jtbGNNc"><img alt="Discord" height="48" src="/public/images/website/discord.svg" width="48"/></a></div></div></div></div><style data-emotion="rpcss zs8kw7">.rpcss-zs8kw7{background-color:#222;padding:20px 0;}</style><footer class="rpcss-zs8kw7"><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 79elbk">.rpcss-79elbk{position:relative;}</style><div class="rpcss-79elbk"><style data-emotion="rpcss 1hle0ni">.rpcss-1hle0ni{position:absolute;left:0;top:50%;color:#fff;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="rpcss-1hle0ni" href="/api/articles/feeds/desc/feed.xml"><style data-emotion="rpcss lvyu5j">.rpcss-lvyu5j{margin-right:10px;}</style><img class="rpcss-lvyu5j" alt="Flux RSS" height="16" src="/public/images/website/rss-feed.svg" width="16"/><style data-emotion="rpcss um3i31">@media (max-width: 400px){.rpcss-um3i31{display:none;}}</style><div class="rpcss-um3i31">Flux RSS</div></a><style data-emotion="rpcss 12cp4l7">.rpcss-12cp4l7{color:rgba(255, 255, 255, 0.5);text-align:center;font-size:14px;}</style><div class="rpcss-12cp4l7">© 2021 Putain de code !</div><style data-emotion="rpcss 1w98uy3">.rpcss-1w98uy3{position:absolute;right:0;top:50%;color:#fff;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="rpcss-1w98uy3" href="https://github.com/putaindecode/putaindecode.io">GitHub</a></div></div></div></footer></div><script id="initialData" type="text/data">{"lists":{"RE_PRIVATE_NONE":true},"items":{"k":"articles","v":{"k":"premiere-application-ember-part-2","v":{"_0":{"TAG":0,"_0":{"slug":"premiere-application-ember-part-2","filename":"2014-12-09-premiere-application-ember-part-2","title":"Première application Ember (part 2)","date":"Tue, 09 Dec 2014 00:00:00 GMT","draft":false,"meta":{"date":"2014-12-09T00:00:00.000Z","title":"Première application Ember (part 2)","author":"bmeurant","oldSlug":"js/ember/premiere-app/2","slug":"premiere-application-ember-part-2"},"body":"<p>L'<a href=\"/fr/articles/js/ember/premiere-app/1\">article précédent</a> vous a accompagné\npour la création d'une première application <a href=\"http://emberjs.com\">Ember</a>. Mais il faut bien\nreconnaître que l'exemple était très simple et que, du coup, le mérite est\nfaible. Pour se rattraper, on va complexifier un peu les choses.</p>\n<p>Tout comme dans l'article précédent, nous détaillerons régulièrement les\nconcepts mis en œuvre. Parce que vous le valez bien.</p>\n<h2>Sommaire</h2>\n<ul>\n<li><a href=\"#edition-d-une-serie\">Édition d'une série</a>\n<ul>\n<li><a href=\"#routes-imbriquees\">Routes imbriquées</a></li>\n<li><a href=\"#-code-outlets-code-\">Outlets</a></li>\n<li><a href=\"#liens-entre-routes\">Liens entre routes</a></li>\n<li><a href=\"#enregistrement-des-modifications\">Enregistrement des modifications</a></li>\n<li><a href=\"#actions-sur-les-transitions\">Actions sur les transitions</a></li>\n</ul></li>\n<li><a href=\"#relations-avec-ember-data\">Relations avec Ember Data</a></li>\n<li><a href=\"#insertion-d-un-gabarit\">Insertion d'un gabarit</a></li>\n<li><a href=\"#creation-d-une-nouvelle-serie\">Création d'une nouvelle série</a></li>\n<li><a href=\"#conclusion\">Conclusion</a></li>\n</ul>\n<h2>Édition d'une série</h2>\n<p>On veut pouvoir basculer depuis la fiche d'une série vers son édition en mode\n<em>in place</em>. C'est-à-dire en <strong>remplaçant</strong> la zone de visualisation de cette\nfiche par sa zone d'édition.</p>\n<p>On accède à la fiche en mode visualisation à l'URL <code>/series/{id}/</code> et en mode\nédition à l'URL <code>/series/{id}/edit</code>. Évidemment, on reconstruit uniquement la\nzone de la fiche et non l'application entière (et donc ni l'en-tête ni la liste\ndes séries).</p>\n<h3>Routes imbriquées</h3>\n<p>Commençons par définir une nouvelle route <code>edit</code>, sous-route de <code>seriesItem</code> :</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-comment\">// /app/router.js</span>\nRouter.map(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n  <span class=\"hljs-built_in\">this</span>.resource(<span class=\"hljs-string\">&quot;series&quot;</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n    <span class=\"hljs-built_in\">this</span>.route(<span class=\"hljs-string\">&quot;seriesItem&quot;</span>, { <span class=\"hljs-attr\">path</span>: <span class=\"hljs-string\">&quot;/:seriesItem_id&quot;</span> }, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n      <span class=\"hljs-built_in\">this</span>.route(<span class=\"hljs-string\">&quot;edit&quot;</span>);\n    });\n  });\n});\n</code></pre>\n<p>Pour que notre nouvelle route affiche la fiche en mode édition, on doit -\n<a href=\"/fr/articles/js/ember/#les-fondamentaux\">rappelez-vous</a> - impérativement suivre\nles\n<a href=\"http://emberjs.com/guides/concepts/naming-conventions/\">conventions de nommage</a>\net créer un gabarit <code>edit.hbs</code> dans le répertoire\n<code>/app/templates/series/series-item/</code> :</p>\n<pre><code class=\"hljs language-html\"><span class=\"hljs-comment\">&lt;!-- /app/templates/series/series-item/edit.hbs` --&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">form</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;series-details&quot;</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;submit&quot;</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;submit&quot;</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;cancel&quot;</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;cancel&quot;</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;title&quot;</span>&gt;</span>{{input id=&quot;title&quot; type=&quot;text&quot; value=title}}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">img</span>\n    {{<span class=\"hljs-attr\">bind-attr</span>\n    <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">&quot;coverUrl&quot;</span>\n    }}\n    <span class=\"hljs-attr\">alt</span>=<span class=\"hljs-string\">&quot;Series&#x27;s first album cover&quot;</span>\n    <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;cover&quot;</span>\n  /&gt;</span>\n\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;description&quot;</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;scriptwriter&quot;</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">label</span> <span class=\"hljs-attr\">for</span>=<span class=\"hljs-string\">&quot;scriptwriter&quot;</span>&gt;</span>Scriptwriter<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">label</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;control&quot;</span>\n        &gt;</span>{{input id=&quot;scriptwriter&quot; type=&quot;text&quot; value=scriptwriter\n        required=&quot;required&quot;}}&lt;/span\n      &gt;\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;illustrator&quot;</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">label</span> <span class=\"hljs-attr\">for</span>=<span class=\"hljs-string\">&quot;illustrator&quot;</span>&gt;</span>Illustrator<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">label</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;control&quot;</span>\n        &gt;</span>{{input id=&quot;illustrator&quot; type=&quot;text&quot; value=illustrator}}&lt;/span\n      &gt;\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;publisher&quot;</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">label</span> <span class=\"hljs-attr\">for</span>=<span class=\"hljs-string\">&quot;publisher&quot;</span>&gt;</span>Publisher<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">label</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;control&quot;</span>\n        &gt;</span>{{input id=&quot;publisher&quot; type=&quot;text&quot; value=publisher}}&lt;/span\n      &gt;\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;summary&quot;</span>&gt;</span>{{textarea value=summary rows=&quot;10&quot;}}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">form</span>&gt;</span>\n</code></pre>\n<p>À ce stade, naviguer sur <code>/series/{@id}/edit</code> ne lève pas d'erreur mais n'a\naucun effet. En effet, on a défini une route imbriquée mais conservé le gabarit\n<code>/app/templates/series/series-item.hbs</code> inchangé. L'activation de la route\n<code>series.seriesItem</code> affiche donc toujours ce gabarit, même dans le cas d'une\nsous-route telle que <code>series.seriesItem.edit</code>.</p>\n<h3><code>outlets</code></h3>\n<p>La solution est à aller chercher du côté du concept d'<code>{{outlet}}</code> défini dans\nl'<a href=\"/fr/articles/js/ember/premiere-app/1/#-code-outlet-code-et-routes-imbriquees\">article précédent</a>.\nUn <code>{{outlet}}</code> est nécessaire <strong>à chaque fois qu'on définit un niveau\nd'imbrication.</strong> Mais comme on veut quand même continuer à afficher la série à\nl'URL <code>/series/{@id}/</code>, on va utiliser la <strong>route implicite</strong>\n<code>series.seriesItem.index</code> (cf.\n<a href=\"/fr/articles/js/ember/premiere-app/1/#routes-et-controleurs-implicites\">article précédent</a>)\net son gabarit, dans lequel on va copier l'ancien contenu de <code>series-item.hbs</code>.</p>\n<pre><code class=\"hljs language-html\"><span class=\"hljs-comment\">&lt;!-- /app/templates/series/series-item/index.hbs --&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;series-details&quot;</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">h3</span>&gt;</span>{{title}}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">h3</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">img</span>\n    {{<span class=\"hljs-attr\">bind-attr</span>\n    <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">&quot;coverUrl&quot;</span>\n    }}\n    <span class=\"hljs-attr\">alt</span>=<span class=\"hljs-string\">&quot;Series&#x27;s first album cover&quot;</span>\n    <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;cover&quot;</span>\n  /&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dl</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;description&quot;</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dt</span>&gt;</span>scriptwriter<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dt</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dd</span>&gt;</span>{{scriptwriter}}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dd</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dt</span>&gt;</span>illustrator<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dt</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dd</span>&gt;</span>{{illustrator}}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dd</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dt</span>&gt;</span>publisher<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dt</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dd</span>&gt;</span>{{publisher}}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dd</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dl</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">p</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;summary&quot;</span>&gt;</span>\n    {{summary}}\n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">p</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n</code></pre>\n<p>Le gabarit <code>series-item.hbs</code> est quant à lui modifié car il doit changer en\nfonction de la sous-route activée. Et puisqu'on ne veut rien afficher de plus,\nson contenu se résume à un <code>{{outlet}}</code> :</p>\n<pre><code class=\"hljs language-html\"><span class=\"hljs-comment\">&lt;!-- /app/templates/series-item.hbs --&gt;</span>\n{{outlet}}\n</code></pre>\n<p>Et voilà ! L'affichage de l'URL <code>/series/{@id}/</code> est inchangé alors que l'URL\n<code>/series/{@id}/edit</code> affiche désormais le formulaire d'édition.</p>\n<h3>Liens entre routes</h3>\n<p>Pour pouvoir plus facilement basculer en mode édition, on ajoute un lien vers la\nroute correspondante grâce à <code>link-to</code> (cf.\n<a href=\"http://emberjs.com/guides/templates/links/\">doc officielle</a>).</p>\n<pre><code class=\"hljs language-html\"><span class=\"hljs-comment\">&lt;!-- /app/templates/series/series-item/index.hbs --&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;series-details&quot;</span>&gt;</span>\n  {{#link-to &#x27;series.seriesItem.edit&#x27; id class=&quot;edit&quot;}}edit{{/link-to}}\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">h3</span>&gt;</span>{{title}}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">h3</span>&gt;</span>\n  ...\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n</code></pre>\n<p>On note que la route vers laquelle le lien pointe est préfixée par <code>series</code>\nparce qu'on a défini une route et non une resource. En effet, une ressource\nréinitialise l'espace de nommage et permet donc des noms de routes plus courts.\nPour pouvoir pointer vers <code>seriesItem.edit</code> on aurait donc dû remplacer\n<code>this.route('seriesItem', ...</code> par <code>this.resource('seriesItem', ...</code>.</p>\n<p>On peut désormais éditer notre série. On remarque au passage que la modification\ndu titre de la série le met également à jour en temps réel dans la liste des\nséries grâce au <em>binding</em> (cf.\n<a href=\"/fr/articles/js/ember/premiere-app/1/#-em-bindings-em-et-mise-a-jour-des-gabarits\">article précédent</a>).</p>\n<h3>Enregistrement des modifications</h3>\n<p>Nous allons maintenant rendre opérationnels nos deux boutons d'édition <em>annuler</em>\net <em>valider</em>. Pour cela, on commence par associer des actions à nos boutons :</p>\n<pre><code class=\"hljs language-html\"><span class=\"hljs-comment\">&lt;!-- /app/templates/series/series-item/edit.hbs` --&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">form</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;series-details&quot;</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;submit&quot;</span> {{<span class=\"hljs-attr\">action</span> &quot;<span class=\"hljs-attr\">submit</span>&quot;}} <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;submit&quot;</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;reset&quot;</span> {{<span class=\"hljs-attr\">action</span> &quot;<span class=\"hljs-attr\">cancel</span>&quot;}} <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;cancel&quot;</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n...\n</code></pre>\n<p>Comme il s'agit de manipulations sur le modèle et de transitions entre routes,\nles actions correspondantes seront traitées par la route.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-comment\">// app/routes/series/series-item/edit.js</span>\n<span class=\"hljs-keyword\">import</span> Ember <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;ember&quot;</span>;\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> Ember.Route.extend({\n  <span class=\"hljs-attr\">model</span>: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">this</span>.modelFor(<span class=\"hljs-string\">&quot;series.seriesItem&quot;</span>);\n  },\n  <span class=\"hljs-attr\">actions</span>: {\n    <span class=\"hljs-attr\">submit</span>: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n      <span class=\"hljs-built_in\">this</span>.modelFor(<span class=\"hljs-string\">&quot;series.seriesItem.edit&quot;</span>)\n        .save()\n        .then(\n          <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n            <span class=\"hljs-built_in\">this</span>.transitionTo(<span class=\"hljs-string\">&quot;series.seriesItem&quot;</span>);\n          }.bind(<span class=\"hljs-built_in\">this</span>),\n        );\n    },\n\n    <span class=\"hljs-attr\">cancel</span>: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n      <span class=\"hljs-built_in\">this</span>.modelFor(<span class=\"hljs-string\">&quot;series.seriesItem.edit&quot;</span>).rollback();\n      <span class=\"hljs-built_in\">this</span>.transitionTo(<span class=\"hljs-string\">&quot;series.seriesItem&quot;</span>);\n    },\n  },\n});\n</code></pre>\n<p>Quelques mots sur ces quelques lignes :</p>\n<ul>\n<li>Dans une <code>route</code>, le modèle courant est récupéré via\n<code>this.modelFor('nomRoute')</code>. Ici, on récupère explicitement le modèle chargé\nautomatiquement (par convention) par la route mère <code>seriesItem</code>. Notez qu'on\naurait pu omettre la récupération du modèle complètement car la route mère\ns'en occupe pour nous.</li>\n<li>Une fois le modèle récupéré, on peut invoquer les méthodes apportées par\n<a href=\"https://github.com/emberjs/data\">Ember Data</a>.</li>\n<li>Pour un <code>cancel</code>, on invoque <code>rollback()</code> : toutes les modifications\neffectuées sont annulées et le modèle est réinitialisé.</li>\n<li>Pour un <code>submit</code>, on invoque un <code>save()</code> qui enregistre les modifications\napportées au modèle dans le <em>magasin</em>\n(<a href=\"http://emberjs.com/api/data/classes/DS.Store.html\">Store</a>) d'<a href=\"https://github.com/emberjs/data\">Ember\nData</a>.</li>\n<li>Les opérations effectuées sur les modèles sont bien souvent asynchrones\npuisque, dans le cas nominal, elles font intervenir des API REST pour\nenregistrer ou mettre à jour les données depuis un serveur. Dans le cas où\nl'on souhaite attendre la fin du traitement pour effectuer une action (comme\nici dans le cas du <code>save</code>), il est nécessaire d'utiliser les <em>promesses</em>\n(<code>promises</code>) qu'<a href=\"https://github.com/emberjs/data\">Ember Data</a> renvoie (<code>.then(...)</code>). Dans le cas\ncontraire, le code serait exécuté avant la fin du traitement et ne permettrait\npas de proposer un retour utilisateur propre (gestion des cas d'erreurs\nnotamment).</li>\n<li>Les transitions entre routes sont possibles via\n<code>this.transitionTo('nomRoute')</code>.</li>\n</ul>\n<h3>Actions sur les transitions</h3>\n<p>Mais je voudrais encore ajouter une dernière petite cerise sur ce gâteau :\nannuler automatiquement toutes les modifications effectuées sur la série dès que\nl'on quitte la route. <a href=\"http://emberjs.com\">Ember</a> prévoit en effet des mécanismes avancés\npour travailler sur les transitions entre routes (cf.\n<a href=\"http://emberjs.com/guides/routing/preventing-and-retrying-transitions/\">doc officielle</a>).\nEn particulier <code>willTransition</code> :</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-comment\">// app/routes/series/series-item/edit.js</span>\n  <span class=\"hljs-attr\">actions</span>: {\n    ...\n    <span class=\"hljs-attr\">willTransition</span>: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\"></span>) </span>{\n      <span class=\"hljs-built_in\">this</span>.modelFor(<span class=\"hljs-string\">&#x27;series.seriesItem.edit&#x27;</span>).rollback();\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">true</span>;\n    }\n  }\n</code></pre>\n<p>L'action est très simple ici mais on imagine facilement comment on pourrait\najouter une confirmation et déterminer, en fonction de la réponse, si l'on doit\ncontinuer la transition ou l'abandonner.</p>\n<h2>Relations avec <a href=\"https://github.com/emberjs/data\">Ember Data</a></h2>\n<p><a href=\"https://github.com/emberjs/data\">Ember Data</a> permet de définir des relations entre nos modèles.\nAjoutons donc des albums à nos séries :</p>\n<p>On définit d'abord une nouvelle entité <code>Album</code> et ses propriétés et on indique\nque cet album était associé à une série via la propriété <code>series</code> et à la\nméthode <code>DS.belongsTo</code> (cf.\n<a href=\"http://emberjs.com/api/data/#method_belongsTo\">doc officielle</a>). Ce qui se\ntraduit plus loin, dans l'initialisation des données par <code>series: 1</code> où 1 est\nl'identifiant de la série en question.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-comment\">// /app/models/album.js</span>\n<span class=\"hljs-keyword\">import</span> DS <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;ember-data&quot;</span>;\n\n<span class=\"hljs-keyword\">var</span> Album = DS.Model.extend({\n  <span class=\"hljs-attr\">title</span>: DS.attr(<span class=\"hljs-string\">&quot;string&quot;</span>),\n  <span class=\"hljs-attr\">publicationDate</span>: DS.attr(<span class=\"hljs-string\">&quot;date&quot;</span>),\n  <span class=\"hljs-attr\">number</span>: DS.attr(<span class=\"hljs-string\">&quot;number&quot;</span>),\n  <span class=\"hljs-attr\">coverName</span>: DS.attr(<span class=\"hljs-string\">&quot;string&quot;</span>, { <span class=\"hljs-attr\">defaultValue</span>: <span class=\"hljs-string\">&quot;default.jpg&quot;</span> }),\n  <span class=\"hljs-attr\">series</span>: DS.belongsTo(<span class=\"hljs-string\">&quot;seriesItem&quot;</span>),\n  <span class=\"hljs-attr\">coverUrl</span>: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">&quot;/assets/images/albums/covers/&quot;</span> + <span class=\"hljs-built_in\">this</span>.get(<span class=\"hljs-string\">&quot;coverName&quot;</span>);\n  }.property(<span class=\"hljs-string\">&quot;coverName&quot;</span>),\n});\n\nAlbum.reopenClass({\n  <span class=\"hljs-attr\">FIXTURES</span>: [\n    {\n      <span class=\"hljs-attr\">id</span>: <span class=\"hljs-number\">1</span>,\n      <span class=\"hljs-attr\">title</span>: <span class=\"hljs-string\">&quot;Somewhere Within the Shadows&quot;</span>,\n      <span class=\"hljs-attr\">publicationDate</span>: <span class=\"hljs-string\">&quot;Nov 2000&quot;</span>,\n      <span class=\"hljs-attr\">number</span>: <span class=\"hljs-number\">1</span>,\n      <span class=\"hljs-attr\">coverName</span>: <span class=\"hljs-string\">&quot;blacksad-1.jpg&quot;</span>,\n      <span class=\"hljs-attr\">series</span>: <span class=\"hljs-number\">1</span>,\n    },\n    {\n      <span class=\"hljs-attr\">id</span>: <span class=\"hljs-number\">2</span>,\n      <span class=\"hljs-attr\">title</span>: <span class=\"hljs-string\">&quot;Arctic-Nation&quot;</span>,\n      <span class=\"hljs-attr\">publicationDate</span>: <span class=\"hljs-string\">&quot;Mar 2003&quot;</span>,\n      <span class=\"hljs-attr\">number</span>: <span class=\"hljs-number\">2</span>,\n      <span class=\"hljs-attr\">coverName</span>: <span class=\"hljs-string\">&quot;blacksad-2.jpg&quot;</span>,\n      <span class=\"hljs-attr\">series</span>: <span class=\"hljs-number\">1</span>,\n    },\n  ],\n});\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> Album;\n</code></pre>\n<p>On modifie ensuite le modèle <code>SeriesItem</code> pour indiquer une relation inverse\ngrâce à la propriété <code>albums</code> et à la méthode <code>DS.hasMany</code> (cf.\n<a href=\"http://emberjs.com/api/data/#method_hasMany\">doc officielle</a>) puis affecter la\nliste des identifiants des albums à la série via <code>albums: [1, 2]</code> :</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-comment\">// /app/models/series-item.js</span>\n<span class=\"hljs-keyword\">import</span> DS <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;ember-data&#x27;</span>;\n\n<span class=\"hljs-keyword\">var</span> SeriesItem = DS.Model.extend({\n    <span class=\"hljs-attr\">title</span>               : DS.attr(<span class=\"hljs-string\">&#x27;string&#x27;</span>, {<span class=\"hljs-attr\">defaultValue</span>: <span class=\"hljs-string\">&#x27;New Series&#x27;</span>}),\n    ...\n    <span class=\"hljs-attr\">albums</span>              : DS.hasMany(<span class=\"hljs-string\">&#x27;album&#x27;</span>, {<span class=\"hljs-attr\">async</span>: <span class=\"hljs-literal\">true</span>})\n});\n\nSeriesItem.reopenClass({\n    <span class=\"hljs-attr\">FIXTURES</span>: [{\n    <span class=\"hljs-attr\">id</span>: <span class=\"hljs-number\">1</span>,\n    ...\n    <span class=\"hljs-attr\">albums</span>: [<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>]\n    }, ...\n]});\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> SeriesItem;\n</code></pre>\n<h2>Insertion d'un gabarit</h2>\n<p>Maintenant qu'on a des albums pour nos séries, on serait bien intéressé de les\nvoir s'afficher. Seulement voilà, on veut juste les afficher à côté de la\nvisualisation d'une série. On ne veut rien proposer d'autre pour ces albums que\nle <em>binding</em> des propriétés et leur affichage. Pas besoin de route ou de\ncontrôleur. On va pour cela utiliser un outil particulier permettant simplement\nd'insérer (d'afficher) un gabarit au sein d'une route existante via le <em>helper</em>\n: <code>render</code> (cf.\n<a href=\"http://emberjs.com/guides/templates/rendering-with-helpers/#toc_the-code-view-code-helper\">doc officielle</a>).</p>\n<p>On modifie donc le gabarit <code>/series/series-item.hbs</code> pour qu'à côté de la fiche\nd'une série soit affichée la liste de ses albums :</p>\n<pre><code class=\"hljs language-html\"><span class=\"hljs-comment\">&lt;!-- /app/templates/series/series-item.hbs --&gt;</span>\n\n{{outlet}}\n\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;series-albums&quot;</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">ul</span>&gt;</span>\n    {{#each album in albums}} {{render &#x27;partials/albumItem&#x27; album}} {{/each}}\n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">ul</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n</code></pre>\n<pre><code class=\"hljs language-html\"><span class=\"hljs-comment\">&lt;!-- /app/templates/partials/album-item.hbs --&gt;</span>\n\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">li</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;album&quot;</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">img</span> {{<span class=\"hljs-attr\">bind-attr</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">&quot;coverUrl&quot;</span> }} <span class=\"hljs-attr\">alt</span>=<span class=\"hljs-string\">&quot;Album cover&quot;</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;cover&quot;</span> /&gt;</span>\n\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;description&quot;</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">h4</span>&gt;</span>{{title}}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">h4</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dl</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dt</span>&gt;</span>volume<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dt</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dd</span>&gt;</span>{{number}}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dd</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dt</span>&gt;</span>date<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dt</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dd</span>&gt;</span>{{publicationDate}}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dd</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dl</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">li</span>&gt;</span>\n</code></pre>\n<h2>Création d'une nouvelle série</h2>\n<p>Histoire de terminer en beauté on va ajouter vite fait la création d'une série.</p>\n<p>Comme on commence à avoir l'habitude, on fait ça en deux coups de cuillère à pot\n:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-comment\">// /app/router.js</span>\nRouter.map(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n  <span class=\"hljs-built_in\">this</span>.resource(<span class=\"hljs-string\">&quot;series&quot;</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n    <span class=\"hljs-built_in\">this</span>.route(<span class=\"hljs-string\">&quot;seriesItem&quot;</span>, { <span class=\"hljs-attr\">path</span>: <span class=\"hljs-string\">&quot;/:seriesItem_id&quot;</span> }, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n      <span class=\"hljs-built_in\">this</span>.route(<span class=\"hljs-string\">&quot;edit&quot;</span>);\n    });\n    <span class=\"hljs-built_in\">this</span>.route(<span class=\"hljs-string\">&quot;create&quot;</span>);\n  });\n});\n</code></pre>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-comment\">// /app/routes/series/create.js</span>\n<span class=\"hljs-keyword\">import</span> Ember <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;ember&quot;</span>;\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> Ember.Route.extend({\n  <span class=\"hljs-attr\">model</span>: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">this</span>.store.createRecord(<span class=\"hljs-string\">&quot;seriesItem&quot;</span>);\n  },\n\n  <span class=\"hljs-attr\">renderTemplate</span>: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n    <span class=\"hljs-built_in\">this</span>.render(<span class=\"hljs-string\">&quot;series.seriesItem.edit&quot;</span>);\n  },\n\n  <span class=\"hljs-attr\">actions</span>: {\n    <span class=\"hljs-attr\">submit</span>: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n      <span class=\"hljs-built_in\">this</span>.modelFor(<span class=\"hljs-string\">&quot;series.create&quot;</span>)\n        .save()\n        .then(\n          <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n            <span class=\"hljs-built_in\">this</span>.transitionTo(\n              <span class=\"hljs-string\">&quot;series.seriesItem&quot;</span>,\n              <span class=\"hljs-built_in\">this</span>.modelFor(<span class=\"hljs-string\">&quot;series.create&quot;</span>),\n            );\n          }.bind(<span class=\"hljs-built_in\">this</span>),\n        );\n    },\n\n    <span class=\"hljs-attr\">cancel</span>: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n      <span class=\"hljs-built_in\">this</span>.modelFor(<span class=\"hljs-string\">&quot;series.create&quot;</span>).rollback();\n      <span class=\"hljs-built_in\">this</span>.transitionTo(<span class=\"hljs-string\">&quot;series&quot;</span>);\n    },\n\n    <span class=\"hljs-attr\">willTransition</span>: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n      <span class=\"hljs-built_in\">this</span>.modelFor(<span class=\"hljs-string\">&quot;series.create&quot;</span>).rollback();\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">true</span>;\n    },\n  },\n});\n</code></pre>\n<pre><code class=\"hljs language-html\"><span class=\"hljs-comment\">&lt;!-- /app/templates/series.hbs --&gt;</span>\n    ...\n      {{/each}}\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">li</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;series-item&quot;</span>&gt;</span>\n          {{#link-to &#x27;series.create&#x27; class=&quot;add&quot;}}add{{/link-to}}\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">li</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">ul</span>&gt;</span>\n    ...\n</code></pre>\n<p>Les points importants à noter :</p>\n<ul>\n<li>Le modèle est, cette fois-ci, créé à l'activation de la route via\n<code>this.store.createRecord(...)</code>.</li>\n<li>Comme on ne souhaite pas proposer de gabarit propre pour cette route, on\nutilise <code>renderTemplate</code> pour indiquer à <a href=\"http://emberjs.com\">Ember</a> quel gabarit il doit\nutiliser.</li>\n<li>Les actions <code>submit</code>, <code>cancel</code> et <code>willTransition</code> sont sensiblement les mêmes\nque pour l'édition mais travaillent sur un modèle différent et renvoient vers\nd'autres routes.</li>\n<li>On note le passage du modèle lors de la transition en cas de <code>submit</code>.</li>\n<li>Il serait légitime de se poser la question de réutilisation de code entre ces\ndeux routes, compte tenu des similarités. Ce n'est pas l'objet de l'article\nmais pourrait être envisagé à l'aide d'un <code>mixin</code> partagé (cf.\n<a href=\"http://emberjs.com/api/classes/Ember.Mixin.html\">doc officielle</a>).</li>\n</ul>\n<h2>Conclusion</h2>\n<p>Au travers de cet article et des précédents, j'espère vous avoir donné un aperçu\ndu modèle de développement que propose <a href=\"http://emberjs.com\">Ember</a>. Vous avez compris,\nj'espère, qu'<a href=\"http://emberjs.com\">Ember</a> est un véritable framework avec des opinions fortes\net qu'il doit être pris comme tel ou laissé de côté pour une solution plus\nlégère selon vos besoins.</p>\n<p>Mais j'ai également essayé d'aller plus en profondeur sur certains aspects et de\nmontrer des cas d'utilisation concrets. Ce dernier article montre qu'il est\négalement possible de fournir à <a href=\"http://emberjs.com\">Ember</a> des configurations explicites\nafin d'aller plus loin que les conventions par défaut.</p>\n<p>Maintenant, vous n'avez plus d'excuses... Vous ne pourrez pas dire que vous ne\nconnaissiez pas.</p>\n<p><em>Note: les sources de l'application exemple sont\n<a href=\"https://github.com/bmeurant/ember-articles/tree/premiere-app-ember-suite\">disponibles sur github</a>.</em></p>\n"}}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"listsRequests":{"data":{"RE_PRIVATE_NONE":true}},"itemsRequests":{"data":{"RE_PRIVATE_NONE":true}}}</script><head><script defer="defer" src="/public/main.56c69761a03eb0112696.js"></script></head></html>