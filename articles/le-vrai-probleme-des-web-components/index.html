<!DOCTYPE html><html lang="fr"><head><title data-react-helmet="true">Le vrai problème des Web Components | Putain de code</title><meta data-react-helmet="true" charset="UTF-8"/><meta data-react-helmet="true" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover" name="viewport"/><meta data-react-helmet="true" content="summary_large_image" name="twitter:card"/><meta data-react-helmet="true" content="Putain de code !" property="og:site_name"/><meta data-react-helmet="true" content="@putaindecode" name="twitter:site"/><meta data-react-helmet="true" content="https://putaindecode.io/public/images/website/share.jpg" property="og:image"/><meta data-react-helmet="true" content="https://putaindecode.io/public/images/website/share.jpg" name="twitter:image"/><meta data-react-helmet="true" content="1500" property="og:image:width"/><meta data-react-helmet="true" content="777" property="og:image:height"/><meta data-react-helmet="true" content="Le vrai problème des Web Components | Putain de code" property="og:title"/><meta data-react-helmet="true" content="Le vrai problème des Web Components | Putain de code" name="twitter:title"/><meta data-react-helmet="true" content="Un article proposé par bloodyowl" name="description"/><link data-react-helmet="true" title="RSS Feed" href="/api/articles/feeds/desc/feed.xml" rel="alternate" type="application/rss+xml"/><link data-react-helmet="true" href="/favicon.ico" rel="shortcut icon"/><link data-react-helmet="true" href="https://putaindecode.io/articles/le-vrai-probleme-des-web-components" rel="canonical"/><script>window.PAGES_BOOT_MODE="hydrate";</script></head><div id="root"><style data-emotion="rpcss zx73cm 1lc6tyj 28v1b4">@-webkit-keyframes animation-zx73cm{from{opacity:0;-webkit-transform:translateY(20px);-moz-transform:translateY(20px);-ms-transform:translateY(20px);transform:translateY(20px);}}@keyframes animation-zx73cm{from{opacity:0;-webkit-transform:translateY(20px);-moz-transform:translateY(20px);-ms-transform:translateY(20px);transform:translateY(20px);}}:root{--page-background-color:#fff;--page-slightly-accented-background-color:#F9F6F6;--page-accented-background-color:#E4EBEE;--page-text-color:#46515B;--link-text-color:#E51D58;--gradient-red-top:#E51D58;--gradient-red-bottom:#CC0613;--code-background-color:#FAF3E1;--one-percent-contrast-color:rgba(0, 0, 0, 0.1);--half-percent-contrast-color:rgba(0, 0, 0, 0.05);}@media (prefers-color-scheme: dark){:root{--page-background-color:#222;--page-slightly-accented-background-color:#171717;--page-accented-background-color:#111;--page-text-color:#ddd;--link-text-color:#F87098;--gradient-red-top:#E51D58;--gradient-red-bottom:#CC0613;--code-background-color:#4F3804;--one-percent-contrast-color:rgba(255, 255, 255, 0.1);--half-percent-contrast-color:rgba(255, 255, 255, 0.05);}}body{padding:0;margin:0;background-color:var(--page-background-color);color:var(--page-text-color);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;overflow-x:hidden;}html{font-size:1em;line-height:1.4;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%;}a{color:var(--link-text-color);-webkit-text-decoration:underline;text-decoration:underline;}a:hover{-webkit-text-decoration:none;text-decoration:none;}#root{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}*,*:before,*:after{box-sizing:border-box;}pre,.hljs{color:#adbac7;background:#22272e;}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#f47067;}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#dcbdfb;}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-variable,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id{color:#6cb6ff;}.hljs-regexp,.hljs-string,.hljs-meta .hljs-string{color:#96d0ff;}.hljs-built_in,.hljs-symbol{color:#f69d50;}.hljs-comment,.hljs-code,.hljs-formula{color:#768390;}.hljs-name,.hljs-quote,.hljs-selector-tag,.hljs-selector-pseudo{color:#8ddb8c;}.hljs-subst{color:#adbac7;}.hljs-section{color:#316dca;font-weight:bold;}.hljs-bullet{color:#eac55f;}.hljs-emphasis{color:#adbac7;font-style:italic;}.hljs-strong{color:#adbac7;font-weight:bold;}.hljs-addition{color:#b4f1b4;background-color:#1b4721;}.hljs-deletion{color:#ffd8d3;background-color:#78191b;}</style><style data-emotion="rpcss 9vhaby">.rpcss-9vhaby{background-color:var(--gradient-red-bottom);background-image:linear-gradient(to bottom right, var(--gradient-red-top), var(--gradient-red-bottom));}</style><header class="rpcss-9vhaby" style="background-image:linear-gradient(to bottom right, hsl(316, 100%, 35%), hsl(263, 100%, 30%))"><style data-emotion="rpcss 1qqk0tr">.rpcss-1qqk0tr{padding-left:env(safe-area-inset-left);padding-right:env(safe-area-inset-right);}</style><div class="rpcss-1qqk0tr"><style data-emotion="rpcss qx7dny">.rpcss-qx7dny{width:100%;max-width:1024px;margin:0 auto;padding:0 10px;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;}</style><div class="rpcss-qx7dny"><style data-emotion="rpcss 7s9om2">.rpcss-7s9om2{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding:20px 0 50px;}</style><div class="rpcss-7s9om2"><style data-emotion="rpcss gdpa5c">.rpcss-gdpa5c{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-text-decoration:none;text-decoration:none;}</style><a class="rpcss-gdpa5c" href="/"><style data-emotion="rpcss 1lm4738">.rpcss-1lm4738{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-text-decoration:none;text-decoration:none;padding-bottom:10px;}</style><div class="rpcss-1lm4738"><style data-emotion="rpcss 13o7eu2">.rpcss-13o7eu2{display:block;}</style><svg class="rpcss-13o7eu2" height="36px" width="36px" viewBox="0 0 36 36"><defs><linearGradient id="PutainDeCodeLogoGradient" x1="50%" x2="50%" y1="0%" y2="127.223881%"><stop offset="0%" stop-color="#E41D57"></stop><stop offset="100%" stop-color="#C60000"></stop></linearGradient></defs><circle cx="18" cy="18" fill="url(#PutainDeCodeLogoGradient)" r="17" stroke="#FFFFFF" stroke-width="2"></circle><polygon fill="#FFFFFF" points="15.9033203 18.2246094 15.9033203 18.3710938 11.2304688 20.5317383 11.2304688 22.8095703 18.0566406 19.184082 18.0566406 17.4116211 11.2304688 13.7788086 11.2304688 16.0639648"></polygon><rect height="14" width="2" fill="#FFFFFF" x="22" y="11"><animate attributeName="opacity" begin="100ms" calcMode="discrete" dur="2s" repeatCount="indefinite" values="1;0"></animate></rect></svg><style data-emotion="rpcss 4cf197">.rpcss-4cf197{width:10px;height:10px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}</style><div class="rpcss-4cf197"></div><style data-emotion="rpcss u5k24">.rpcss-u5k24{font-size:22px;color:#fff;font-weight:800;}</style><div aria-level="2" class="rpcss-u5k24" role="heading">Putain de code !</div></div><style data-emotion="rpcss 1nyebg4">.rpcss-1nyebg4{font-size:14px;color:rgba(255, 255, 255, 0.8);text-align:center;}</style><div class="rpcss-1nyebg4">Blog participatif de la communauté dev</div></a></div></div></div></header><style data-emotion="rpcss a4ric9">.rpcss-a4ric9{background-color:var(--page-slightly-accented-background-color);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}</style><div class="rpcss-a4ric9"><style data-emotion="rpcss oeugsb">.rpcss-oeugsb{-webkit-animation:500ms ease-out animation-zx73cm;animation:500ms ease-out animation-zx73cm;}</style><div class="rpcss-oeugsb"><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 1qc2bam">.rpcss-1qc2bam{font-size:42px;font-weight:800;text-align:center;padding-top:40px;line-height:1.2;margin:0;}</style><h1 class="rpcss-1qc2bam">Le vrai problème des Web Components</h1><style data-emotion="rpcss obg2kr">.rpcss-obg2kr{font-size:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding-top:10px;padding-bottom:40px;color:var(--page-text-color);-webkit-text-decoration:none;text-decoration:none;}</style><a class="rpcss-obg2kr" href="https://github.com/bloodyowl"><style data-emotion="rpcss uco8i7">.rpcss-uco8i7{width:32px;height:32px;border-radius:100%;margin-right:10px;}</style><img class="rpcss-uco8i7" alt="bloodyowl" src="https://avatars.githubusercontent.com/bloodyowl?size=64"/><div>bloodyowl<!-- --> <!-- -->•<!-- --> <!-- -->2021/02/15</div></a><style data-emotion="rpcss 15kxmi0">.rpcss-15kxmi0{max-width:640px;width:100%;font-size:18px;margin:0 auto;line-height:1.7;}.rpcss-15kxmi0 h2,.rpcss-15kxmi0 h3,.rpcss-15kxmi0 h4,.rpcss-15kxmi0 h5,.rpcss-15kxmi0 h6{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;font-weight:800;line-height:1.2;}.rpcss-15kxmi0 img{max-width:100%;background-color:rgba(255, 255, 255, 0.75);}.rpcss-15kxmi0 code{font-size:0.9em;font-family:PragmataPro,SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;line-height:1;background-color:var(--code-background-color);margin:0 0.2em;}.rpcss-15kxmi0 pre{padding:10px;overflow-x:auto;font-size:14px;border-radius:10px;border:2px solid var(--one-percent-contrast-color);-webkit-overflow-scrolling:touch;}.rpcss-15kxmi0 pre code{font-size:14px;background-color:transparent;margin:0;}.rpcss-15kxmi0 blockquote{padding-left:20px;margin:0;font-size:16px;border-left:3px solid var(--one-percent-contrast-color);font-style:italic;}.rpcss-15kxmi0 table{width:100%;text-align:center;}.rpcss-15kxmi0 figure{padding:20px 0;}.rpcss-15kxmi0 figcaption{text-align:center;}.rpcss-15kxmi0 a{word-wrap:break-word;}.rpcss-15kxmi0 table thead th{background-color:var(--page-accented-background-color);padding:10px 0;}</style><div class="rpcss-15kxmi0"><p>Les Web Components sont souvent vendus comme <strong>l'alternative</strong> des standards
face aux <strong>frameworks</strong> qui ont envahi le dévelopemment front-end depuis
plusieurs années. C'est un discours commercial (ou un discours d'<em>advocate</em>
comme on appelle ça dans le développement), mais qu'en est-il vraiment ? Les Web
Components sont-ils une <strong>alternative viable</strong> à React, Vue, Angular et consorts
? Tiennent-ils la promesse d'unifier tout le monde derrière une même bannière ?
À quoi servent-ils ?</p>
<h2>Un peu d'histoire</h2>
<p>L'histoire des Web Components débute par une énorme tentative de forçage. Google
(<a href="https://pastebin.com/NUMTTrKj">qui n'en est décidément pas à son coup d'essai pour emmerder le monde avec ses idées de technos</a>)
débarque, défonce la porte du W3C à grands coups de pieds, jette un brouillon de
spécification sur le bureau, crie &quot;ET C'EST DÉJÀ DANS CHROME&quot; et s'en va comme
il est venu. Dans le jargon on appelle ça une <strong>belette sauvage</strong>.</p>
<p>Mais que contient cette spécification ? Elle s'articule autour de quatre
concepts :</p>
<ul>
<li>des <strong>templates</strong>: du HTML inerte et clonable</li>
<li>des <strong>decorators</strong>: un moyen d'appliquer du HTML depuis CSS (?)</li>
<li>des <strong>custom elements</strong>: qui permettent de créer ses propres éléments
utilisables dans un document HTML, avec leur comportement propre</li>
<li>le <strong>shadow DOM</strong>: un système de sous-arbre DOM</li>
</ul>
<p>Certains de ses aspects font rêver, comme <strong>les styles scopés</strong>, mais la
solution a du mal à prendre en dehors de Google. L'immense majorité de la
communauté est complètement paumée devant ce concept de shadow DOM et ne
comprend pas bien comment sont censés s'articuler les différents concepts de la
spécification.</p>
<p>Passent quelques années. Le W3C finit par faire évoluer le brouillon de
spécification en quelque chose de plus viable, mais ça met du temps. Il hérite
de questions balayées par le document et doit les résoudre, avec le soin
de ne rien casser. La tâche est d'autant plus ardue que Chrome fait déjà tourner
la version brouillon.</p>
<p>Pendant ce temps, Google a eu le temps de promouvoir sa specification à fond les
ballons, avec des frameworks construits autour et une forte communication de
leurs <em>advocates</em>.</p>
<p>Aujourd'hui, les Web Components retrouvent un peu de succès grâce à des
<a href="https://lit-html.polymer-project.org">bibliothèques</a> et
<a href="https://stenciljs.com">frameworks</a> qui permettent de simplifier la gestion de
l'état et du DOM à l'intérieur du <em>custom-element</em>.</p>
<h2>Le problème fondamental des Web Components</h2>
<p>Je pense que les Web Components ont un problème fondamental : en tentant de
réconcilier la généricité d'un Web partagé par tous avec le fait de se créer son
propre &quot;standard local&quot;, <strong>ils finissent par ne répondre à aucun besoin
critique</strong>.</p>
<h3>Le partage des custom elements</h3>
<p>Partager et réutiliser, c'est la priorité <strong>numéro 1</strong> d'un système de
composants. C'est pourtant quasiment impossible à atteindre quand on rajoute
l'orchestration depuis HTML dans la balance.</p>
<p>La manière d'enregistrer un <em>custom element</em> est de passer une <code>class</code> héritant
de <code>HTMLElement</code> à une petite API:</p>
<pre><code class="hljs language-javascript"><span class="hljs-built_in">window</span>.customElements.define(<span class="hljs-string">&quot;my-tag-name&quot;</span>, MyTagClass);
</code></pre>
<p>Comme la forme que prend cette API le suggère, <code>my-tag-name</code> sera ajouté
<strong>globalement</strong> à la page, ce qui est logique, puisque le tag doit être
utilisable dans du code HTML.</p>
<p>En général, pour rester pratique à l'usage, un module JavaScript dans lequel on
déclare un <em>custom-element</em> va l'auto-enregistrer, et on trouvera l'appel à
<code>window.customElements.define</code> à la fin du fichier. Dès lors, pour utiliser
notre nouveau tag, il faudra simplement s'assurer qu'il a été déclaré dans la
page :</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// adds `my-tag-name` to our global scope if not already</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./MyTag.js&quot;</span>;
</code></pre>
<p>Le problème ici : entre la déclaration et l'utilisation, on trouve un <strong>lien
faible</strong>, et un oubli est vite arrivé. Il peut être difficile pour des outils de
détecter qu'un tag n'est pas déclaré ou au contraire déclaré sans être utilisé,
puisque l'appel à <code>window.customElements.define</code> n'est pas <strong>pur</strong> au sens du
programme : déclarer un nouvel élément <strong>peut avoir des effets de bord</strong>.</p>
<p>L'API nous laisse en plus <strong>responsables du <em>namespacing</em></strong> : il faudra toujours
préfixer vos noms de tags par une chaîne de caractères propre à votre
organisation, et pas de chance si des éléments tiers que vous comptez utiliser
sont tombés sur le même préfixe.</p>
<p>Le versionning semble également absent des considérations de la spécification.
Si différentes parties de votre application évoluent à des vitesses différentes
et que vous devez vous retrouver avec deux versions du même élément, l'une des
deux parties de votre application devra faire un sacrifice sur le nommage, avec
un <code>color-picker-legacy</code> ou un <code>color-picker-v2</code>.</p>
<h3>L'orchestration des composants</h3>
<p>À moins d'être disposé à faire un retour de 10 ans en arrière quant à la gestion
de l'état et du DOM, il me semble peu souhaitable de les gérer soi-même. On va
donc avoir tendance à utiliser des bibliothèques et frameworks <strong>dans ses
<em>custom-elements</em></strong>. Sans ces outils, on se retrouve dans les écueils de
maintenabilité qui limitent ce qu'on est capable de produire sereinement.</p>
<p>Pour apporter une valeur qui dépasse le simple styling et une gestion d'états
très basique, les Web Components dépendent eux aussi de solutions tierces. <strong>À
&quot;praticité&quot; égale, ils n'unifient pas les frameworks, ils en contiennent</strong>.</p>
<p>L'intérêt de pouvoir orchestrer ses Web Components via différents frameworks au
sein d'une même entreprise perd alors un peu de sa superbe, puisqu'on duplique
de la fonctionnalité entre la logique macro (orchestration) et micro
(comportement des éléments eux-même).</p>
<h3>Nos besoin pratiques ne sont pas ceux de HTML</h3>
<p>Les <em>custom-elements</em> étant des éléments HTML, ils héritent de leur manière
d'échanger de l'information : les <strong>attributs</strong>, les <strong>propriétés</strong> et les
<strong>évènements</strong>. Pour être utilisables depuis du code HTML, les attributs doivent
être <strong>sérialisables</strong>, et le reste devra passer par des propriétés et des
évènements.</p>
<p>Pour passer de l'information complexe, vous devrez donc impérativement passer
par du code JS:</p>
<pre><code class="hljs language-javascript">myCustomElement.value = <span class="hljs-number">1</span>;
myCustomElement.addEventListener(<span class="hljs-string">&quot;change&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
  <span class="hljs-comment">// do something with event.target.value</span>
});
</code></pre>
<p>Et si vous faites l'effort d'accepter des attributs sérialisés, votre code n'en
sera que plus complexe.</p>
<p>Hors frameworks, cette mécanique va par ailleurs compliquer votre capacité à
exiger des propriétés ou callbacks. Pour prendre un exemple simple, dans ma
codebase j'ai un composant <code>TouchableOpacity</code> (un bouton qui devient
semi-transparent lorsque la souris est appuyée dessus). Ce composant <strong>impose</strong>
via le compiler qu'on lui passe un callback <code>onPress</code>, faute de quoi ça signifie
que je n'utilise pas le composant adapté, ou que j'ai oublié de lui en passer
un. Cette mécanique me permet de créer sereinement des composants avec des
contraintes d'utilisation, et m'évite d'avoir à <strong>supporter des cas non
souhaités</strong>. Les custom-elements, si je les utilisais bas-niveau, m'imposeraient
à leur échelle de prévoir ce genre de cas.</p>
<p>Il est théoriquement possible d'avoir des outils capables de détecter et
d'alerter sur ce genre de comportements. En pratique, à moins d'imposer un outil
d'orchestration des Web Components (aka un nouveau framework), ça semble
fortement compromis.</p>
<h3>L'interopérabilité avec les outils génériques</h3>
<p>Si je dois <em>crawler</em> une page et interpréter son contenu, recevoir des
<em>custom-elements</em> rique de me rendre la tâche difficile : chaque site peut
donner <strong>un sens différent au même tag HTML</strong>.</p>
<p>Prenons un exemple repris de la documentation de <a href="https://amp.dev">Google AMP</a>,
qui utilise les Web Components :</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">amp-list</span>
  <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;auto&quot;</span>
  <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;100&quot;</span>
  <span class="hljs-attr">layout</span>=<span class="hljs-string">&quot;fixed-height&quot;</span>
  <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/static/inline-examples/data/amp-list-urls.json&quot;</span>
&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;amp-mustache&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;url-entry&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;{{url}}&quot;</span>&gt;</span>{{title}}<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">amp-list</span>&gt;</span>
</code></pre>
<p>AMP ajoutant les roles <code>aria</code> qui vont bien au <em>runtime</em>, le serveur me renvoie
le code vu plus haut. Qu'est-ce que je suis censé en faire ?</p>
<p>Est-ce que je dois:</p>
<ul>
<li>m'amuser à lister et interpréter manuellement tous les éléments custom de tous
les sites ?</li>
<li>forcer les gens à ajouter les rôles d'accessibilité à l'appel de leurs
<em>custom-elements</em>, ce qui fait perdre un énorme intérêt à l'abstraction par
composant</li>
</ul>
<p>Il est possible de bidouiller des solutions pour faire du Server-Side Rendering,
mais c'est en réécrivant le contenu de chaque <em>custom-element</em> lorsque le
JavaScript prend le relai, ce qui n'est pas idéal à l'étape où le navigateur
travaille le plus.</p>
<h2>Un rêve irréconciliable avec la réalité</h2>
<p>La plupart des problèmes que j'ai listé ici me paraissent cruciaux lorsqu'on
développe une application Web avec des attentes modernes. C'est à mon avis la
raison du succès des frameworks front-end : <strong>ils les ont réglé avec de
l'outillage</strong>.</p>
<p>Les <strong>Web Components</strong>, qui cherchent à résoudre une partie des problèmes
auxquels s'adressent les frameworks, ont quant à eux la tâche beaucoup plus
ingrate : faire la même chose avec les impératifs de <strong>standardisation</strong> et de
<strong>rétro-compatibilité</strong>, sans pour autant empêcher les <strong>évolutions futures</strong>.</p>
<p>Ajouter la nécessité de pouvoir sérialiser en HTML ses composants dont le
comportement est déclaré dans du code JavaScript, en imposant un lien faible
entre les deux (mon navigateur n'affiche aucune erreur si j'utilise un tag non
enregistré), c'est se tirer une balle dans le pied. La <strong>separation of
concerns</strong> n'a de sens que si nos <strong>concerns</strong> sont indépendants, et ce n'est
définitivement pas le cas des Web Components.</p>
<p>Ils ne <strong>parviennent pas à réconcilier</strong> les contraintes inhérentes aux
standards avec la fonctionnalité qu'ils doivent apporter, et <strong>c'est tout à fait
normal</strong> : Google a essayé de faire rentrer un rond dans un carré, empilant les
concepts jusqu'à perdre la substance même du besoin original : faire un standard
de composants réutilisables sur le Web.</p>
<p>En se foutant royalement du consensus (qui aurait eu de fortes chances de
déboucher sur « venez on le fait pas »), Google a foncé tête baissée pour créer
une fonctionnalité pas finie, déjà limitée dans ses évolutions futures par son
adoption que l'entreprise s'est efforcée de lancer à grands coups de
communication et d'<em>advocacy</em>.</p>
<p>C'est dommage.</p>
</div><style data-emotion="rpcss unyj6i">.rpcss-unyj6i{max-width:640px;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin:20px auto;padding:20px;background-color:var(--page-background-color);border-radius:10px;box-shadow:0 15px 15px -5px rgba(0, 0, 0, 0.2);}@media (max-width: 540px){.rpcss-unyj6i{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><div class="rpcss-unyj6i"><style data-emotion="rpcss ty7r4z">.rpcss-ty7r4z{font-weight:800;}</style><div class="rpcss-ty7r4z">Vous avez aimé cet article?</div><style data-emotion="rpcss klacsp">.rpcss-klacsp{width:0;height:10px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}</style><div class="rpcss-klacsp"></div><style data-emotion="rpcss 1pkr03v">.rpcss-1pkr03v{background-color:#00aced;color:#fff;padding:10px 20px;-webkit-text-decoration:none;text-decoration:none;border-radius:5px;font-weight:800;}.rpcss-1pkr03v:active{opacity:0.5;}</style><a class="rpcss-1pkr03v" href="https://www.twitter.com/intent/tweet?text=Le%20vrai%20probl%C3%A8me%20des%20Web%20Components%20sur%20%40PutainDeCode%20https%3A%2F%2Fputaindecode.io%2Farticles%2Fle-vrai-probleme-des-web-components" target="_blank">Le partager sur Twitter</a></div><style data-emotion="rpcss x4iqxe">.rpcss-x4iqxe{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;text-align:center;padding:20px;}</style><div class="rpcss-x4iqxe"><style data-emotion="rpcss gein6x">.rpcss-gein6x{font-size:20px;-webkit-text-decoration:none;text-decoration:none;color:#1E49B5;}</style><a class="rpcss-gein6x" href="/articles">← Articles</a></div></div></div></div></div><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 1vau6rl">.rpcss-1vau6rl{margin:20px 0;background-color:var(--page-accented-background-color);border-radius:10px;padding:20px;}</style><div class="rpcss-1vau6rl"><style data-emotion="rpcss 1gz1i1h">.rpcss-1gz1i1h{font-size:32px;font-weight:800;margin-bottom:20px;text-align:center;}</style><div aria-level="2" class="rpcss-1gz1i1h" role="heading">Ne rien rater</div><style data-emotion="rpcss 1wbispj">.rpcss-1wbispj{font-size:18px;margin-bottom:10px;text-align:center;}</style><div aria-level="3" class="rpcss-1wbispj" role="heading">Sur les réseaux</div><style data-emotion="rpcss 1hyoz7m">.rpcss-1hyoz7m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;}</style><div class="rpcss-1hyoz7m"><a href="https://twitter.com/PutainDeCode"><img alt="Twitter" height="48" src="/public/images/website/twitter.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://facebook.com/putaindecode"><img alt="Facebook" height="48" src="/public/images/website/facebook.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://github.com/putaindecode"><img alt="Facebook" height="48" src="/public/images/website/github.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://itunes.apple.com/fr/podcast/putain-de-code-!/id1185311825"><img alt="Apple Podcast" height="48" src="/public/images/website/apple-podcast.svg" width="48"/></a><div class="rpcss-4cf197"></div><a href="https://soundcloud.com/putaindecode"><img alt="Soundcloud" height="48" src="/public/images/website/soundcloud.svg" width="48"/></a></div><div aria-level="3" class="rpcss-1wbispj" role="heading">Sur le chat</div><div class="rpcss-1hyoz7m"><a href="https://discord.gg/jtbGNNc"><img alt="Discord" height="48" src="/public/images/website/discord.svg" width="48"/></a></div></div></div></div><style data-emotion="rpcss zs8kw7">.rpcss-zs8kw7{background-color:#222;padding:20px 0;}</style><footer class="rpcss-zs8kw7"><div class="rpcss-1qqk0tr"><div class="rpcss-qx7dny"><style data-emotion="rpcss 79elbk">.rpcss-79elbk{position:relative;}</style><div class="rpcss-79elbk"><style data-emotion="rpcss 1hle0ni">.rpcss-1hle0ni{position:absolute;left:0;top:50%;color:#fff;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="rpcss-1hle0ni" href="/api/articles/feeds/desc/feed.xml"><style data-emotion="rpcss lvyu5j">.rpcss-lvyu5j{margin-right:10px;}</style><img class="rpcss-lvyu5j" alt="Flux RSS" height="16" src="/public/images/website/rss-feed.svg" width="16"/><style data-emotion="rpcss um3i31">@media (max-width: 400px){.rpcss-um3i31{display:none;}}</style><div class="rpcss-um3i31">Flux RSS</div></a><style data-emotion="rpcss 12cp4l7">.rpcss-12cp4l7{color:rgba(255, 255, 255, 0.5);text-align:center;font-size:14px;}</style><div class="rpcss-12cp4l7">© 2021 Putain de code !</div><style data-emotion="rpcss 1w98uy3">.rpcss-1w98uy3{position:absolute;right:0;top:50%;color:#fff;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="rpcss-1w98uy3" href="https://github.com/putaindecode/putaindecode.io">GitHub</a></div></div></div></footer></div><script id="initialData" type="text/data">{"lists":{"RE_PRIVATE_NONE":true},"items":{"k":"articles","v":{"k":"le-vrai-probleme-des-web-components","v":{"_0":{"TAG":0,"_0":{"slug":"le-vrai-probleme-des-web-components","filename":"2021-02-15-le-vrai-probleme-des-web-components","title":"Le vrai problème des Web Components","date":"Mon, 15 Feb 2021 00:00:00 GMT","draft":false,"meta":{"title":"Le vrai problème des Web Components","date":"2021-02-15T00:00:00.000Z","author":"bloodyowl","slug":"le-vrai-probleme-des-web-components"},"body":"<p>Les Web Components sont souvent vendus comme <strong>l'alternative</strong> des standards\nface aux <strong>frameworks</strong> qui ont envahi le dévelopemment front-end depuis\nplusieurs années. C'est un discours commercial (ou un discours d'<em>advocate</em>\ncomme on appelle ça dans le développement), mais qu'en est-il vraiment ? Les Web\nComponents sont-ils une <strong>alternative viable</strong> à React, Vue, Angular et consorts\n? Tiennent-ils la promesse d'unifier tout le monde derrière une même bannière ?\nÀ quoi servent-ils ?</p>\n<h2>Un peu d'histoire</h2>\n<p>L'histoire des Web Components débute par une énorme tentative de forçage. Google\n(<a href=\"https://pastebin.com/NUMTTrKj\">qui n'en est décidément pas à son coup d'essai pour emmerder le monde avec ses idées de technos</a>)\ndébarque, défonce la porte du W3C à grands coups de pieds, jette un brouillon de\nspécification sur le bureau, crie &quot;ET C'EST DÉJÀ DANS CHROME&quot; et s'en va comme\nil est venu. Dans le jargon on appelle ça une <strong>belette sauvage</strong>.</p>\n<p>Mais que contient cette spécification ? Elle s'articule autour de quatre\nconcepts :</p>\n<ul>\n<li>des <strong>templates</strong>: du HTML inerte et clonable</li>\n<li>des <strong>decorators</strong>: un moyen d'appliquer du HTML depuis CSS (?)</li>\n<li>des <strong>custom elements</strong>: qui permettent de créer ses propres éléments\nutilisables dans un document HTML, avec leur comportement propre</li>\n<li>le <strong>shadow DOM</strong>: un système de sous-arbre DOM</li>\n</ul>\n<p>Certains de ses aspects font rêver, comme <strong>les styles scopés</strong>, mais la\nsolution a du mal à prendre en dehors de Google. L'immense majorité de la\ncommunauté est complètement paumée devant ce concept de shadow DOM et ne\ncomprend pas bien comment sont censés s'articuler les différents concepts de la\nspécification.</p>\n<p>Passent quelques années. Le W3C finit par faire évoluer le brouillon de\nspécification en quelque chose de plus viable, mais ça met du temps. Il hérite\nde questions balayées par le document et doit les résoudre, avec le soin\nde ne rien casser. La tâche est d'autant plus ardue que Chrome fait déjà tourner\nla version brouillon.</p>\n<p>Pendant ce temps, Google a eu le temps de promouvoir sa specification à fond les\nballons, avec des frameworks construits autour et une forte communication de\nleurs <em>advocates</em>.</p>\n<p>Aujourd'hui, les Web Components retrouvent un peu de succès grâce à des\n<a href=\"https://lit-html.polymer-project.org\">bibliothèques</a> et\n<a href=\"https://stenciljs.com\">frameworks</a> qui permettent de simplifier la gestion de\nl'état et du DOM à l'intérieur du <em>custom-element</em>.</p>\n<h2>Le problème fondamental des Web Components</h2>\n<p>Je pense que les Web Components ont un problème fondamental : en tentant de\nréconcilier la généricité d'un Web partagé par tous avec le fait de se créer son\npropre &quot;standard local&quot;, <strong>ils finissent par ne répondre à aucun besoin\ncritique</strong>.</p>\n<h3>Le partage des custom elements</h3>\n<p>Partager et réutiliser, c'est la priorité <strong>numéro 1</strong> d'un système de\ncomposants. C'est pourtant quasiment impossible à atteindre quand on rajoute\nl'orchestration depuis HTML dans la balance.</p>\n<p>La manière d'enregistrer un <em>custom element</em> est de passer une <code>class</code> héritant\nde <code>HTMLElement</code> à une petite API:</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-built_in\">window</span>.customElements.define(<span class=\"hljs-string\">&quot;my-tag-name&quot;</span>, MyTagClass);\n</code></pre>\n<p>Comme la forme que prend cette API le suggère, <code>my-tag-name</code> sera ajouté\n<strong>globalement</strong> à la page, ce qui est logique, puisque le tag doit être\nutilisable dans du code HTML.</p>\n<p>En général, pour rester pratique à l'usage, un module JavaScript dans lequel on\ndéclare un <em>custom-element</em> va l'auto-enregistrer, et on trouvera l'appel à\n<code>window.customElements.define</code> à la fin du fichier. Dès lors, pour utiliser\nnotre nouveau tag, il faudra simplement s'assurer qu'il a été déclaré dans la\npage :</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-comment\">// adds `my-tag-name` to our global scope if not already</span>\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-string\">&quot;./MyTag.js&quot;</span>;\n</code></pre>\n<p>Le problème ici : entre la déclaration et l'utilisation, on trouve un <strong>lien\nfaible</strong>, et un oubli est vite arrivé. Il peut être difficile pour des outils de\ndétecter qu'un tag n'est pas déclaré ou au contraire déclaré sans être utilisé,\npuisque l'appel à <code>window.customElements.define</code> n'est pas <strong>pur</strong> au sens du\nprogramme : déclarer un nouvel élément <strong>peut avoir des effets de bord</strong>.</p>\n<p>L'API nous laisse en plus <strong>responsables du <em>namespacing</em></strong> : il faudra toujours\npréfixer vos noms de tags par une chaîne de caractères propre à votre\norganisation, et pas de chance si des éléments tiers que vous comptez utiliser\nsont tombés sur le même préfixe.</p>\n<p>Le versionning semble également absent des considérations de la spécification.\nSi différentes parties de votre application évoluent à des vitesses différentes\net que vous devez vous retrouver avec deux versions du même élément, l'une des\ndeux parties de votre application devra faire un sacrifice sur le nommage, avec\nun <code>color-picker-legacy</code> ou un <code>color-picker-v2</code>.</p>\n<h3>L'orchestration des composants</h3>\n<p>À moins d'être disposé à faire un retour de 10 ans en arrière quant à la gestion\nde l'état et du DOM, il me semble peu souhaitable de les gérer soi-même. On va\ndonc avoir tendance à utiliser des bibliothèques et frameworks <strong>dans ses\n<em>custom-elements</em></strong>. Sans ces outils, on se retrouve dans les écueils de\nmaintenabilité qui limitent ce qu'on est capable de produire sereinement.</p>\n<p>Pour apporter une valeur qui dépasse le simple styling et une gestion d'états\ntrès basique, les Web Components dépendent eux aussi de solutions tierces. <strong>À\n&quot;praticité&quot; égale, ils n'unifient pas les frameworks, ils en contiennent</strong>.</p>\n<p>L'intérêt de pouvoir orchestrer ses Web Components via différents frameworks au\nsein d'une même entreprise perd alors un peu de sa superbe, puisqu'on duplique\nde la fonctionnalité entre la logique macro (orchestration) et micro\n(comportement des éléments eux-même).</p>\n<h3>Nos besoin pratiques ne sont pas ceux de HTML</h3>\n<p>Les <em>custom-elements</em> étant des éléments HTML, ils héritent de leur manière\nd'échanger de l'information : les <strong>attributs</strong>, les <strong>propriétés</strong> et les\n<strong>évènements</strong>. Pour être utilisables depuis du code HTML, les attributs doivent\nêtre <strong>sérialisables</strong>, et le reste devra passer par des propriétés et des\névènements.</p>\n<p>Pour passer de l'information complexe, vous devrez donc impérativement passer\npar du code JS:</p>\n<pre><code class=\"hljs language-javascript\">myCustomElement.value = <span class=\"hljs-number\">1</span>;\nmyCustomElement.addEventListener(<span class=\"hljs-string\">&quot;change&quot;</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">event</span>) </span>{\n  <span class=\"hljs-comment\">// do something with event.target.value</span>\n});\n</code></pre>\n<p>Et si vous faites l'effort d'accepter des attributs sérialisés, votre code n'en\nsera que plus complexe.</p>\n<p>Hors frameworks, cette mécanique va par ailleurs compliquer votre capacité à\nexiger des propriétés ou callbacks. Pour prendre un exemple simple, dans ma\ncodebase j'ai un composant <code>TouchableOpacity</code> (un bouton qui devient\nsemi-transparent lorsque la souris est appuyée dessus). Ce composant <strong>impose</strong>\nvia le compiler qu'on lui passe un callback <code>onPress</code>, faute de quoi ça signifie\nque je n'utilise pas le composant adapté, ou que j'ai oublié de lui en passer\nun. Cette mécanique me permet de créer sereinement des composants avec des\ncontraintes d'utilisation, et m'évite d'avoir à <strong>supporter des cas non\nsouhaités</strong>. Les custom-elements, si je les utilisais bas-niveau, m'imposeraient\nà leur échelle de prévoir ce genre de cas.</p>\n<p>Il est théoriquement possible d'avoir des outils capables de détecter et\nd'alerter sur ce genre de comportements. En pratique, à moins d'imposer un outil\nd'orchestration des Web Components (aka un nouveau framework), ça semble\nfortement compromis.</p>\n<h3>L'interopérabilité avec les outils génériques</h3>\n<p>Si je dois <em>crawler</em> une page et interpréter son contenu, recevoir des\n<em>custom-elements</em> rique de me rendre la tâche difficile : chaque site peut\ndonner <strong>un sens différent au même tag HTML</strong>.</p>\n<p>Prenons un exemple repris de la documentation de <a href=\"https://amp.dev\">Google AMP</a>,\nqui utilise les Web Components :</p>\n<pre><code class=\"hljs language-html\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">amp-list</span>\n  <span class=\"hljs-attr\">width</span>=<span class=\"hljs-string\">&quot;auto&quot;</span>\n  <span class=\"hljs-attr\">height</span>=<span class=\"hljs-string\">&quot;100&quot;</span>\n  <span class=\"hljs-attr\">layout</span>=<span class=\"hljs-string\">&quot;fixed-height&quot;</span>\n  <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">&quot;/static/inline-examples/data/amp-list-urls.json&quot;</span>\n&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">template</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;amp-mustache&quot;</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">&quot;url-entry&quot;</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">a</span> <span class=\"hljs-attr\">href</span>=<span class=\"hljs-string\">&quot;{{url}}&quot;</span>&gt;</span>{{title}}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">a</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">template</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">amp-list</span>&gt;</span>\n</code></pre>\n<p>AMP ajoutant les roles <code>aria</code> qui vont bien au <em>runtime</em>, le serveur me renvoie\nle code vu plus haut. Qu'est-ce que je suis censé en faire ?</p>\n<p>Est-ce que je dois:</p>\n<ul>\n<li>m'amuser à lister et interpréter manuellement tous les éléments custom de tous\nles sites ?</li>\n<li>forcer les gens à ajouter les rôles d'accessibilité à l'appel de leurs\n<em>custom-elements</em>, ce qui fait perdre un énorme intérêt à l'abstraction par\ncomposant</li>\n</ul>\n<p>Il est possible de bidouiller des solutions pour faire du Server-Side Rendering,\nmais c'est en réécrivant le contenu de chaque <em>custom-element</em> lorsque le\nJavaScript prend le relai, ce qui n'est pas idéal à l'étape où le navigateur\ntravaille le plus.</p>\n<h2>Un rêve irréconciliable avec la réalité</h2>\n<p>La plupart des problèmes que j'ai listé ici me paraissent cruciaux lorsqu'on\ndéveloppe une application Web avec des attentes modernes. C'est à mon avis la\nraison du succès des frameworks front-end : <strong>ils les ont réglé avec de\nl'outillage</strong>.</p>\n<p>Les <strong>Web Components</strong>, qui cherchent à résoudre une partie des problèmes\nauxquels s'adressent les frameworks, ont quant à eux la tâche beaucoup plus\ningrate : faire la même chose avec les impératifs de <strong>standardisation</strong> et de\n<strong>rétro-compatibilité</strong>, sans pour autant empêcher les <strong>évolutions futures</strong>.</p>\n<p>Ajouter la nécessité de pouvoir sérialiser en HTML ses composants dont le\ncomportement est déclaré dans du code JavaScript, en imposant un lien faible\nentre les deux (mon navigateur n'affiche aucune erreur si j'utilise un tag non\nenregistré), c'est se tirer une balle dans le pied. La <strong>separation of\nconcerns</strong> n'a de sens que si nos <strong>concerns</strong> sont indépendants, et ce n'est\ndéfinitivement pas le cas des Web Components.</p>\n<p>Ils ne <strong>parviennent pas à réconcilier</strong> les contraintes inhérentes aux\nstandards avec la fonctionnalité qu'ils doivent apporter, et <strong>c'est tout à fait\nnormal</strong> : Google a essayé de faire rentrer un rond dans un carré, empilant les\nconcepts jusqu'à perdre la substance même du besoin original : faire un standard\nde composants réutilisables sur le Web.</p>\n<p>En se foutant royalement du consensus (qui aurait eu de fortes chances de\ndéboucher sur « venez on le fait pas »), Google a foncé tête baissée pour créer\nune fonctionnalité pas finie, déjà limitée dans ses évolutions futures par son\nadoption que l'entreprise s'est efforcée de lancer à grands coups de\ncommunication et d'<em>advocacy</em>.</p>\n<p>C'est dommage.</p>\n"}}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"listsRequests":{"data":{"RE_PRIVATE_NONE":true}},"itemsRequests":{"data":{"RE_PRIVATE_NONE":true}}}</script><head><script defer="defer" src="/public/main.56c69761a03eb0112696.js"></script></head></html>